2002-10-14  Akim Demaille  <akim@epita.fr>

	Version 1.75.

2002-10-14  Akim Demaille  <akim@epita.fr>

	* tests/Makefile.am (maintainer-check-posix): New.

2002-10-14  Akim Demaille  <akim@epita.fr>

	* data/glr.c [YYDEBUG] (YYLEFTMOST_STATE): Initialize the yyloc
	member.

2002-10-14  Akim Demaille  <akim@epita.fr>

	* src/tables.c (table_ninf_remap): base -> tab.
	Reported by Matt Rosing.

2002-10-14  Paul Eggert  <eggert@twinsun.com>

	* tests/action.at, tests/calc.at, tests/conflicts.at,
	tests/cxx-type.at, tests/headers.at, tests/input.at,
	tests/regression.at, tests/synclines.at, tests/torture.at:
	Say "bison -o foo.c foo.y", not "bison foo.y -o foo.c",
	so that the tests still work even if POSIXLY_CORRECT is set.
	* doc/bison.texinfo (Rpcalc Compile, Invocation): Likewise.

	* data/c.m4 (b4_int_type): Use yysigned_char instead of signed char,
	for portability to K&R hosts.  Fix typo: signed char is guaranteed
	only to 127, not to 128.
	* data/glr.c (yysigned_char): New type.
	* data/yacc.c (yysigned_char): Likewise.
	* tests/regression.at (Web2c Actions): signed char -> yysigned_char.

2002-10-13  Paul Eggert  <eggert@twinsun.com>

	* data/yacc.c (yyparse): Rewrite to avoid "comparison is always
	true due to limited range of data type" warning from GCC.

	* data/c.m4 (b4_token_defines): Protect against double-inclusion
	by wrapping enum yytokentype's definition inside #ifndef
	YYTOKENTYPE.  This undoes a bug I introduced on 2002-10-12.

2002-10-13  Akim Demaille  <akim@epita.fr>

	* data/glr.c (yyglrShiftDefer, yyaddDeferredAction, yydoAction):
	Un yy- yyrhs to avoid the name clash with the global YYRHS.

2002-10-13  Akim Demaille  <akim@epita.fr>

	* Makefile.maint: Update from Autoconf 2.54.
	* m4/strerror_r.m4 (AC_FUNC_STRERROR_R): Remove, shipped with 2.54.

2002-10-13  Akim Demaille  <akim@epita.fr>

	* src/print.c (print_state): Separate the list of solved conflicts
	from the other items.
	* tests/conflicts.at (Resolved SR Conflicts): Adjust.

2002-10-13  Akim Demaille  <akim@epita.fr>

	Let nondeterministic skeletons be usable with deterministic
	tables.

	With the patch, GAWK compiled by GCC without -O2 passes its test
	suite using a GLR parser driven by LALR tables.  It fails with -O2
	because `struct stat' gives two different answers on my machine:
	88 (definition of an auto var) and later 96 (memset on this var).
	Hence the stack is badly corrumpted.  The headers inclusion is to
	blame: if I move the awk.h inclusion before GLR's system header
	inclusion, the two struct stat have the same size.

	* src/tables.c (pack_table): Always create conflict_table.
	(token_actions): Always create conflict_list.
	* data/glr.c (YYFLAG): Remove, unused.

2002-10-13  Akim Demaille  <akim@epita.fr>

	* configure.ac (AC_GNU_SOURCE): Use it instead of hand written code.
	(O0FLAGS): New.
	(VALGRIND, GXX): New.
	* tests/atlocal.in (CFLAGS): Use O0FLAGS.
	* tests/bison.in: Run $PREBISON a pre-command.
	* tests/Makefile.am (maintainer-check, maintainer-check-valgrind)
	(maintainer-check-g++): New.
	* Makefile.am (maintainer-check): New.

2002-10-13  Akim Demaille  <akim@epita.fr>

	* data/glr.c: Formatting changes.
	Tweak some trace messages to match yacc.c's.

2002-10-13  Akim Demaille  <akim@epita.fr>

	GLR parsers sometimes raise parse errors instead of performing the
	default reduction.
	Reported by Charles-Henry de Boysson.

	* tests/calc.at (_AT_CHECK_CALC, _AT_CHECK_CALC_ERROR): Don't
	check the length of the	traces when %glr.
	(_AT_CHECK_CALC_ERROR): Also skip `^Stack' lines, coming from
	GLR's traces.
	(AT_CHECK_CALC_LALR, AT_CHECK_CALC_GLR): New.
	Test GLR parsers.
	* data/glr.c (YYLEFTMOST_STATE): Fix its value.
	(yyltype): Remove the yy prefix from the member names.
	(yytable): Complete its comment.
	(yygetLRActions): Map error action number from YYTABLE from
	YYTABLE_NINF to 0.
	(yyisErrorAction): No longer compare YYACTION to YYPACT_NINF
	(which was a bug: it should have been YYTABEL_NINF, and yet it was
	not satisfying as we could compare an YYACTION computed from
	YYDEFACT to YYTABLE_NINF although they are unrelated): 0 is the
	only value for error actions.
	(yyreportParseError): In verbose parse error messages, don't issue
	`error' in the list of expected tokens.
	* data/yacc.c (yyparse) <yybackup>: Rewrite the decoding of the
	next action to perform to match glr.c's decoding.
	(yytable): Complete its comment.

2002-10-13  Paul Eggert  <eggert@twinsun.com>

	Fix problem reported by Henrik Grubbstroem in
	<http://mail.gnu.org/pipermail/bug-bison/2002-October/001670.html>:
	"nonterm: { $$ = 123; } { $$ = $1; };" was wrongly rejected,
	because the Bison parser reads the second action before reducing
	the first one.
	* src/scan-gram.l (rule_length): New static var.
	Use it to keep track of the rule length in the scanner, since
	we can't expect the parser to be in lock-step sync with the scanner.
	(handle_action_dollar, handle_action_at): Use this var.
	* tests/actions.at (Exotic Dollars): Test for the problem.

2002-10-12  Paul Eggert  <eggert@twinsun.com>

	* lib/timevar.c [! IN_GCC && HAVE_SYS_TIME_H]: Include <sys/time.h>.
	* m4/timevar.m4 (BISON_PREREQ_TIMEVAR): Check for <sys/time.h>.
	Include <sys/time.h> when checking for clock_t and struct tms.
	Use same include order as source.
	This is for the SunOS 4.1.4 porting bug reported by Peter Klein in
	<http://mail.gnu.org/pipermail/bug-bison/2002-October/001674.html>.

	* lib/timevar.c: Update copyright date and clarify comments.
	(get_time) [IN_GCC]: Keep the GCC version for reference.

	* lib/timevar.c, lib/timevar.h, lib/timevar.def: Import
	GCC version as of today, then merge Bison's changes.
	Change "GCC" to "Bison" in copyright notice.  timevar.def's
	author is Akim, so change that too.

	* src/reader.c (grammar_current_rule_check):
	Don't worry about the default action if $$ is untyped.
	Prevents bogus warnings reported by Jim Gifford in
	<http://mail.gnu.org/pipermail/bug-bison/2002-October/001673.html>.

	* data/c.m4 (b4_token_enum): Do not define YYTOKENTYPE.
	* data/glr.c, data/lalr1.cc, data/yacc.c:
	Output token definitions before the first part of user declarations.
	Fixes compatibility problem reported by Jim Gifford for kbd in
	<http://mail.gnu.org/pipermail/bug-bison/2002-October/001672.html>.

2002-10-11  Paul Eggert  <eggert@twinsun.com>

	* data/yacc.c (yyreport_parse_error): Remove, putting its body into...
	(yyparse): here.  This undoes some of the 2002-07-25 change.
	Compatibility problem reported by Ralf S. Engelschall with
	OSSP cfg <http://www.ossp.org/pkg/lib/cfg/>.

2002-10-11  Akim Demaille  <akim@epita.fr>

	* tests/regression.at Characters Escapes): New.
	* src/scan-gram.l (SC_ESCAPED_CHARACTER): Accept \' in strings and
	characters.
	Reported by Jan Nieuwenhuizen.

2002-10-11  Akim Demaille  <akim@epita.fr>

	* po/id.po: New.

2002-10-10  Paul Eggert  <eggert@twinsun.com>

	Portability fixes for bitsets; this also avoids several GCC
	warnings.

	* lib/abitset.c: Include <stddef.h>, for offsetof.
	* lib/lbitset.c: Likewise.

	* lib/abitset.c (abitset_bytes): Return a size that is aligned
	properly for vectors of objects.  Do not assume that adding a
	header size to a multiple of a word size yields a value that is
	properly aligned for the whole union.
	* lib/bitsetv.c (bitsetv_alloc): Likewise.

	* lib/bitset_stats.c (bitset_stats_bytes): Adjust to new,
	unique names for structures.
	* lib/ebitset.c (ebitset_bytes): Likewise.
	* lib/lbitset.c (lbitset_bytes): Likewise.

	* lib/abitset.c (abitset_ones, abitset_zero, abitset_empty_p,
	abitset_copy1, abitset_not, abitset_equal_p, abitset_subset_p,
	abitset_disjoint_p, abitset_and, abitset_and_cmp, abitset_andn,
	abitset_andn_cmp, abitset_or, abitset_or_cmp, abitset_xor,
	abitset_xor_cmp, abitset_and_or, abitset_and_or_cmp,
	abitset_andn_or, abitset_andn_or_cmp, abitset_or_and,
	abitset_or_and_cmp, abitset_copy): Supply prototype decls,
	to improve the type-checking that GCC can do.
	* lib/bitset.c (bitset_op4_cmp): Likewise.
	* lib/bitset_stats.c (bitset_stats_count,
	bitset_stats_empty_p, bitset_stats_ones, bitset_stats_zero,
	bitset_stats_copy, bitset_stats_disjoint_p,
	bitset_stats_equal_p, bitset_stats_not, bitset_stats_subset_p,
	bitset_stats_and, bitset_stats_and_cmp, bitset_stats_andn,
	bitset_stats_andn_cmp, bitset_stats_or, bitset_stats_or_cmp,
	bitset_stats_xor, bitset_stats_xor_cmp, bitset_stats_and_or,
	bitset_stats_and_or_cmp, bitset_stats_andn_or,
	bitset_stats_andn_or_cmp, bitset_stats_or_and,
	bitset_stats_or_and_cmp): Likewise.
	* lib/lbitset.c (lbitset_and, lbitset_and_cmp, lbitset_andn,
	lbitset_andn_cmp, lbitset_or, lbitset_or_cmp, lbitset_xor,
	lbitset_xor_cmp, lbitset_empty_p, lbitset_ones, lbitset_not,
	lbitset_subset_p, lbitset_disjoint_p, debug_lbitset): Likewise.

	* lib/abitset.h: Include bitset.h, not bbitset.h.
	* lib/ebitset.h: Likewise.
	* lib/lbitset.h: Likewise.

	* lib/bbitset.h: (enum_bitset_ops, enum_bitset_type): New types.
	All instances of parameters of type enum bitset_opts are now of
	type enum_bitset_opts, to conform to the C Standard, and similarly
	for enum_bitset_type.
	* lib/ebitset.c (enum_ebitset_find_mode): Likewise.
	* lib/lbitset.c (enum_lbitset_find_mode): Likewise.

	Do not use "struct bitset_struct" to mean different things in
	different modules.  Not only is this confusing, it violates
	the C Standard, which requires that structure types in different
	modules must be compatible if one is to be passed to the other.
	* lib/bbitset.h (bitset): Now points to a union, not to a struct.
	All instances of "struct bitset_struct *" replaced with "bitset".
	* lib/bitset.h (struct bitset_struct): Remove, replacing with....
	(union bitset_union, struct abitset_struct, struct ebitset_struct,
	struct lbitset_struct, struct bitset_stats_struct): New types.
	All uses of struct bitset_struct changed to union bitset_union,
	etc.
	* lib/abitset.c	(struct abitset_struct, abitset,
	struct bitset_struct): Remove.
	* lib/bitset_stats.c (struct bitset_stats_struct, bitset_stats,
	struct bitset_struct): Remove.
	* lib/ebitset.c (struct ebitset_struct, ebitset, struct
	bitset_struct): Remove.
	* lib/lbitset.c (struct lbitset_struct, lbitset, bitset_struct):
	Likewise.

	Do not call a function of type T using a call that assumes the
	function is of a different type U.  Standard C requires that a
	function must be called with a type that is compatible with its
	definition.
	* lib/bbitset.h (bitset_and_or_, bitset_andn_or_, bitset_or_and_):
	New decls.
	* lib/bitset.c (bitset_and_or_, bitset_andn_or_, bitset_or_and_):
	New functions.
	* lib/ebitset.c (PFV): Remove.
	* lib/lbitset.c (PFV): Likewise.
	* lib/ebitset.c (ebitset_and, ebitset_andn, ebitset_or,
	ebitset_xor, ebitset_copy, ebitset_ones, ebitset_empty_p): New
	decls.
	(ebitset_and, ebitset_andn, ebitset_or, ebitset_xor): New functions.
	(ebitset_vtable): Use them.
	* lib/lbitset.c (lbitset_and, lbitset_andn, lbitset_or,
	lbitset_xor): New functions.
	(lbitset_vtable): Use them.

	* lib/bitset.h (bitset_next, bitset_prev, bitset_only_set_p):
	Declare.

	* lib/bitsetv.c (bitsetv_alloc): Add a cast to (void *) to avoid a
	GCC warning.
	* lib/lbitset.c (LBITSET_CURRENT1): Likewise.
	Use offsetof, for simplicity.

2002-10-06  Paul Eggert  <eggert@twinsun.com>

	* lib/bitset.h (bitset_reset): Do not assume that bitset_word is
	the same width as int.  This reapplies a hunk of the 2002-08-12 patch
	<http://mail.gnu.org/pipermail/bison-patches/2002-August/001111.html>,
	which was inadvertently undone by the 2002-09-30 patch.
	* lib/lbitset.c (debug_lbitset): Do not assume that bitset_word is
	the same width as int.

2002-10-04  Paul Eggert  <eggert@twinsun.com>

	Version 1.50.

	* configure.ac (AC_INIT), NEWS: Increment version number.

	* doc/bison.texinfo: Minor spelling, grammar, and white space
	fixes.
	(Symbols): Mention that any negative value returned from yylex
	signifies end-of-input.  Warn about negative chars.  Mention
	the portable Standard C character set.

	The GNU coding standard says CFLAGS and YFLAGS are reserved
	for the installer to set.
	* lib/Makefile.am (AM_CFLAGS): Renamed from CFLAGS.
	* src/Makefile.am (AM_CFLAGS): Likewise.
	(AM_YFLAGS): Renamed from YFLAGS.

	Fix some MAX and MIN problems.
	* src/gram.h (ITEM_NUMBER_MIN): MIN_MAX -> INT_MIN.
	* src/lalr.h (GOTO_NUMBER_MAX): INT_MAX -> SHRT_MAX.
	* src/symtab.h (SYMBOL_NUMBER_MAX): New macro.
	* src/reader.c (reader): Use it.

	* tests/regression.at (Braces parsing): Use grep, not fgrep, as
	POSIX 1003.1-2001 has removed fgrep.

2002-10-04  Michael Hayes  <m.hayes@elec.canterbury.ac.nz>

	* lib/bbitset.h (BITSET_WINDEX_MAX): Redefine so that it cannot be
	interpreted as signed.
	* lib/ebitset.c (ebitset_list): Fix bug.

2002-10-01  Paul Eggert  <eggert@twinsun.com>

	More fixes for 64-bit hosts and large bitsets.

	* lib/abitset.c (struct abitset_struct.n_bits, abitset_small_list,
	abitset_size, abitset_list, abitset_list_reverse, abitset_list):
	Use bitset_bindex, not int or unsigned int or size_t, to count bits.
	* lib/bbitset.h (struct bitset_vtable.size, struct bitset_vtable.count,
	struct bitset_vtable.list, struct bitset_vtable.list_reverse,
	bitset_count_, bitset_next, bitset_prev, bitset_first, bitset_last,
	bitset_count_): Likewise.
	* lib/bitset.h (bitset_iterator.num, bitset_iterator.i,
	bitset_first, bitset_last): Likewise.
	* lib/bitset_stats.c (bitset_stats_size, bitset_stats_list,
	bitset_stats_list_reverse, bitset_stats_size,
	bitset_stats_count, bitset_stats_list, bitset_stat_list_reverse):
	Likewise.
	* lib/bitsetv-print.c (bitsetv_matrix_dump): Likewise.
	* lib/bitsetv.c (bitsetv_alloc, bitsetv_create, bitsetv_free,
	bitsetv_zero, bitsetv_ones, bitsetv_transitive_closure,
	bitsetv_reflexive_transitive_closure): Likewise.
	* lib/bitsetv.h (bitsetv_alloc, bitsetv_create): Likewise.
	* lib/ebitset.c (ebitset_size, ebitset_list, ebitset_list_reverse):
	Likewise.
	* lib/lbitset.c (lbitset_size, lbitset_list, lbitset_list_merge):
	Likewise.

	* lib/abitset.c (abitset_ones, abitset_zero, abitset_bytes):
	Use size_t, not unsigned int, to count bytes.
	* lib/abitset.h (abitset_bytes): Likewise.
	* lib/bitset.c (bitset_bytes, bitset_alloc, bitset_obstack_alloc):
	Likewise.
	* lib/bitset.h (bitset_bytes): Likewise.
	* lib/bitset_stats.c (bitset_stats_bytes, bitset_stats_init): Likewise.
	* lib/bitset_stats.h (bitset_stats_bytes): Likewise.
	* lib/bitsetv.c (bitsetv_alloc): Likewise.
	* lib/ebitset.c (ebitset_bytes): Likewise.
	* lib/ebitset.h (ebitset_bytes): Likewise.
	* lib/lbitset.c (lbitset_bytes): Likewise.
	* lib/lbitset.h (lbitset_bytes): Likewise.

	* lib/abitset.c (abitset_empty_p, abitset_not, abitset_equal_p,
	abitset_subset_p, abitset_disjoint_p, abitset_and,
	abitset_and_cmp, abitset_andn, abitset_andn_cmp, abitset_or,
	abitset_or_cmp, abitset_xor, abitset_xor_cmp, abitset_and_or,
	abitset_and_or_cmp, abitset_andn_or, abitset_andn_or_cmp,
	abitset_or_and, abitset_or_and_cmp):
	Use bitset_windex instead of unsigned int.
	* lib/bitsetv.c (bitsetv_dump, debug_bitsetv): Likewise.
	* lib/ebitset.c (struct ebitset_struct.size, ebitset_elts_grow,
	ebitset_elt_add, ebitset_elt_remove, ebitset_weed,
	ebitset_elt_find, ebitset_list_reverse, ebitset_list, ebitset_init):
	Likewise.
	* lib/lbitset.c (lbitset_ones, lbitset_not): Likewise.

	* lib/bitset.c (bitset_print):
	Use proper printf formats for widths of integer types.
	* lib/bitset_stats.c (bitset_percent_histogram_print,
	bitset_log_histogram_print, bitset_stats_print_1): Likewise.
	* lib/bitsetv-print.c (bitsetv_matrix_dump): Likewise.
	* lib/bitsetv.c (bitsetv_dump, debug_bitsetv): Likewise.
	* lib/lbitset.c (lbitset_bytes): Likewise.

	* lib/bbitset.h (BITSET_BINDEX_MAX, BITSET_WINDEX_MAX,
	BITSET_SIZE_MAX): New macros.
	(BITSET_INDEX_MAX): Remove.  It wasn't right, since it assumed that
	sizeof (bitset_word) == sizeof (bitset_windex).  All uses changed
	to BITSET_WINDEX_MAX.

	* lib/bitset.c (bitset_next, bitset_prev, bitset_first,
	bitset_last): Return BITSET_BINDEX_MAX (not -1) for no value,
	since we now return the bitset_bindex type (not int).

	* lib/bitsetv.c (bitsetv_alloc): Check for arithmetic overflow
	when computing sizes.
	* lib/ebitset.c (ebitset_elts_grow): Likewise.

	* lib/lbitset.c (lbitset_elt_find): Simplify windex calculation
	and avoid cast to unsigned.

2002-09-30  Akim Demaille  <akim@epita.fr>

	* lib/abitset.c, lib/bbitset.h, lib/bitset.c, lib/bitset.h,
	* lib/bitset_stats.c, lib/bitsetv.c, lib/ebitset.c, lib/lbitset.c:
	Updates from Michael Hayes.

2002-09-30  Art Haas  <ahaas@neosoft.com>

	* configure.ac: Update AC_OUTPUT and AM_CONFIG_HEADER
	invocations.
	* tests/cxx-type.at (declarator): Don't rely on NDEBUG being not
	defined.

2002-09-27  Akim Demaille  <akim@epita.fr>

	Version 1.49c.

2002-09-27  Akim Demaille  <akim@epita.fr>

	* configure.ac (AM_INIT_AUTOMAKE): We _need_ 1.7.
	(Because of AC_LIBSOURCE).

2002-09-27  Akim Demaille  <akim@epita.fr>

	Playing with Autoscan.

	* configure.ac: Remove the old LIBOBJ tweaks.
	(AC_REPLACE_FUNCS): Add strrchr and strtol.
	* lib/strrchr.c: New.
	* lib/strtol.c: New, from the Coreutils 4.5.1.

2002-09-27  Akim Demaille  <akim@epita.fr>

	Playing with Autoscan.

	* m4/prereq.m4 (jm_PREREQ_ARGMATCH, jm_FUNC_ARGMATCH): New.
	* lib/Makefile.am (libbison_a_SOURCES): No longer include
	argmatch.c and argmatch.h, since they are AC_LIBSOURCE'd.
	* lib/strcasecmp.c, lib/strncasecmp.c, lib/memcmp.c: New, from the
	Coreutils 4.5.1.

2002-09-24  Akim Demaille  <akim@epita.fr>

	* doc/bison.texinfo (Stack Overflow): xref to Recursion.
	(Frequently Asked Questions, Parser Stack Overflow): New.

2002-09-13  Akim Demaille  <akim@epita.fr>

	Playing with autoscan.

	* src/reader.c (get_merge_function): Use xstrdup, not strdup.
	* src/files.c (skeleton_find): Remove, unused.
	* m4/memcmp.m4: New, from the Coreutils 4.5.1.
	* m4/prereq.m4 (jm_PREREQ_QUOTEARG): Run jm_FUNC_MEMCMP.

2002-09-13  Akim Demaille  <akim@epita.fr>

	* configure.ac (AM_INIT_AUTOMAKE): Require Automake 1.6.3.
	* Makefile.am (AUTOMAKE_OPTIONS): Don't.

2002-09-13  Akim Demaille  <akim@epita.fr>

	* configure.ac: Require 2.54.
	s/jm_FUNC_MALLOC/AC_FUNC_MALLOC/.
	s/jm_FUNC_REALLOC/AC_FUNC_REALLOC/.
	* m4/c-bs-a.m4, m4/malloc.m4, m4/mbstate_t.m4, m4/realloc.m4:
	Remove, provided by Autoconf macros.

2002-09-12  Akim Demaille  <akim@epita.fr>

	* m4/prereq.m4: Update, from Coreutils 4.5.1.

2002-09-12  Akim Demaille  <akim@epita.fr>

	* m4/prereq.m4: Update, from Fileutils 4.1.5.
	* configure.ac (jm_PREREQ_TEMPNAME): Invoke it.
	Reported by Martin Mokrejs.

2002-09-10  Akim Demaille  <akim@epita.fr>

	* src/parse-gram.y: Associate a human readable string to each
	token type.
	* tests/regression.at (Invalid inputs): Adjust.

2002-09-10  Gary V. Vaughan  <gary@gnu.org>

	* tests/Makefile.am ($(srcdir)/package.m4): Bison now ships
	with an Autoconf-2.5x style configure.ac.

2002-09-06  Paul Eggert  <eggert@twinsun.com>

	* doc/bison.texinfo (Conditions): Make explicit that the GPL
	exception applies only to yacc.c.  This is a modification of a
	patch originally suggested by Akim Demaille.

2002-09-06  Akim Demaille  <akim@epita.fr>

	* data/c.m4 (b4_copyright): Move the GPL exception comment from
	here to...
	* data/yacc.c: here.

	* data/lalr1.cc (struct yyltype): Don't define it, since we use
	LocationType.
	(b4_ltype): Default to yy::Location from location.hh.

2002-09-04  Jim Meyering  <jim@meyering.net>

	* data/yacc.c: Guard the declaration of yytoknum also with
	`#ifdef YYPRINT', so it is declared only when used.

2002-09-04  Akim Demaille  <akim@epita.fr>

	* configure.in: Rename as...
	* configure.ac: this.
	Bump to 1.49c.

2002-09-04  Akim Demaille  <akim@epita.fr>

	* src/assoc.c, src/closure.c, src/gram.c, src/injections.c,
	* src/lalr.c, src/LR0.c, src/relation.c, src/tables.c: Don't
	translate maintainer only messages.

2002-08-12  Paul Eggert  <eggert@twinsun.com>

	Version 1.49b.

	* Makefile.am (SUBDIRS): Remove intl.
	(DISTCLEANFILES): Remove.
	* NEWS: Mention that GNU M4 is now required.  Clarify what is
	meant by "larger grammars".  Mention the pt_BR translation.
	* configure.in (AC_CHECK_DECLS): Add getenv, getopt.
	(AM_GNU_GETTEXT_VERSION): New macro, replacing GETTEXT_VERSION var.
	Bump version from 0.11.2 to 0.11.5.
	(BISON_PREREQ_STAGE): Remove.
	(AM_GNU_GETTEXT): Use external gettext.
	(AC_OUTPUT): Remove intl/Makefile.

	* config/depcomp, config/install-sh: Sync with Automake 1.6.3.

	* data/glr.c: Include string.h, for strlen.
	(yyreportParseError): Use size_t for yysize.
	(yy_yypstack): No longer nested inside yypstates, as nested
	functions are not portable.  Do not assume size_t is the
	same width as int.
	(yypstates): Do not assume that ptrdiff_t is the same width
	as int, and similarly for yyposn and YYINDEX.

	* data/yacc.c: Fix comment about `$$ = $1': it can copy garbage.

	* lib/Makefile.am (INCLUDES): Do not include from the intl
	directory, which has been removed.
	* src/Makefile.am (INCLUDES): Likewise.

	* lib/Makefile.am (libbison_a_SOURCES): Add unlocked-io.h.
	(bitsets_sources, additional_bitsets_sources, timevars_sources):
	New vars.

	* lib/Makefile.am (libbison_a_SOURCES): Avoid +=, a GNU make extension.
	* tests/Makefile.am (EXTRA_DIST): Likewise.

	* lib/abitset.c (abitset_reverse_list, ebitset_reverse_list):
	Do not assume that bitset_windex is the same width as unsigned.

	* lib/abitset.c (abitset_unused_clear): Do not assume that
	bitset_word is the same width as int.
	* lib/bbitset.h (BITSET_INDEX_MAX, BITSET_MSB): Likewise.
	* lib/bitset.h (bitset_set, bitset_reset): Likewise.
	* lib/bitset_stats.c (bitset_stats_set, bitset_stats_reset): Likewise.
	* lib/ebitset.c (ebitset_set, ebitset_reset): Likewise.
	* lib/lbitset.c (lbitset_set, lbitset_reset): Likewise.

	* lib/abitset.c (abitset_op1): Use -1, not ~0, as memset arg (for
	portability to one's complement hosts!).
	* lib/ebitset.c (ebitset_op1): Likewise.
	* lib/lbitset.c (lbitset_op1): Likewise.

	* lib/argmatch.c, lib/quotearg.c, quotearg.h: Sync with GNU tar.
	* lib/argmatch.h, lib/basename.c, lib/dirname.c, lib/dirname.h,
	lib/hash.c, lib/hash.h, lib/strnlen.c, lib/xmalloc.c:
	Sync with fileutils.
	* lib/error.c, lib/getopt.c, lib/getopt.h, lib/getopt1.c,
	lib/gettext.h: Sync with diffutils.

	* lib/memrchr.c, lib/mkstemp.c, lib/strchr.c, lib/strnlen.c,
	lib/strspn.c, lib/tempname.c: Use GPL, not LGPL.

	* lib/obstack.c, lib/obstack.h: Sync with fileutils, except use
	PROTOTYPES to check for prototypes, and "defined __STDC__" to
	check for void *.

	* lib/bbitset.h (BITSET_WORD_BITS): Now of type unsigned, not
	size_t; the old version tried to do this but casted improperly.
	(bitset_bindex, bitset_windex): Now size_t, not unsigned long.
	(bitset_test): Now returns int, not unsigned long.

	* lib/bitset_stats.c: Include "gettext.h".
	(_): New macro.
	(bitset_stats_set, bitset_stats_reset, bitset_stats_test): Don't
	name locals "index", as it generates unnecessary warnings on some
	hosts that have an "index" function.

	* lib/bitset_stats.c (bitset_stats_print_1, bitset_stats_print,
	bitset_stats_read, bitset_stats_write): Wrap strings in _() if
	they need translation.
	* src/LR0.c (state_list_append, new_itemsets, get_state,
	append_states, generate_states): Likewise.
	* src/assoc.c (assoc_to_string): Likewise.
	* src/closure.c (print_closure, set_firsts, closure): Likewise.
	* src/gram.c (grammar_dump): Likewise.
	* src/injections.c (injections_compute): Likewise.
	* src/lalr.c (lookaheads_print): Likewise.
	* src/relation.c (relation_transpose): Likewise.
	* src/scan-gram.l: Likewise.
	* src/tables.c (table_grow, pack_vector): Likewise.

	* m4/Makefile.am (EXTRA_DIST): Remove codeset.m4,
	glibc21.m4, isc-posix.m4 lcmessage.m4, stage.m4.
	* m4/malloc.m4, m4/realloc.m4: Sync with diffutils.
	* m4/mbstate_t.m4: Sync with fileutils.
	* m4/prereq.m4 (jm_PREREQ_QUOTEARG): AC_MBSTATE_T -> AC_TYPE_MBSTATE_T.

	* po/LINGUAS: Add pt_BR.
	* po/POTFILES.in: Add src/assoc.c, src/closure.c, src/gram.c,
	src/main.c, src/relation.c, src/state.c, lib/bitset_stats.c,
	lib/timevar.c.
	Use src/parse-gram.y instead of src/parse-gram.c, as the gettext
	manual recommends.
	Similarly, use src/scan-gram.l instead of src/scan-gram.c.

	* src/complain.c (strerror_r): Remove decl; not needed.
	(strerror): Use same pattern as ../lib/error.c.

	* src/files.c, src/files.h (compute_header_macro): Remove; unused.

	* src/gram.c (grammar_dump): Do not assume ptrdiff_t fits in int.

	* src/main.c (main): Cast result of bindtextdomain and textdomain
	to void, to avoid a GCC warning when --disable-nls is in effect.

	* src/scan-gram.l: Use strings rather than escapes when possible,
	to minimize the number of warnings from xgettext.
	(handle_action_dollar, handle_action_at): Don't use isdigit,
	as it mishandles negative chars and it may not work as expected
	outside the C locale.

	* src/symtab.c (symbol_get): Don't cast LHS of an assignment;
	this is a GCC extension and is not portable to other compilers.

	* src/system.h (alloca): Use same pattern as ../lib/error.c.
	Do not include <ctype.h>; no longer needed.
	Do not include <malloc.h>; no longer needed (and generates
	warnings on OpenBSD 3.0).

	* tests/cxx-type.at (yylex): Do not pass signed char to isupper;
	it's not portable.

	* tests/regression.at: Do not use 'cc -c input.c -o input';
	Sun C rejects this.  Instead, use 'cc -c input.c -o input.o'.

	* tests/synclines.at (AC_SYNCLINES_COMPILE): Accept any nonzero
	exit status as failure, not just exit status 1.  Sun C exits
	with status 2 sometimes.

	* tests/torture.at (AT_INCREASE_DATA_SIZE): New macro.
	Use it for the two large tests.

2002-08-02  Akim Demaille  <akim@epita.fr>

	* src/conflicts.c (conflicts_output): Don't output rules never
	reduced here, since anyway that computation doesn't work.
	* src/gram.h, src/gram.h (rule_filter_t, rule_useful_p)
	(rule_useless_p, rule_never_reduced_p): New.
	(grammar_rules_partial_print): Use a filter instead of a range.
	Display the title only if needed.
	(grammar_rules_print): Adjust.
	(grammar_rules_never_reduced_report): New.
	* src/tables.c (action_row): Move the computation of rules never
	reduced to...
	(token_actions): here.
	* src/main.c (main): Make the parser before making the report, so
	that rules never reduced are computed.
	Call grammar_rules_never_reduced_report.
	* src/print.c (print_results): Report rules never reduced.
	* tests/conflicts.at, tests/reduce.at: Adjust.

2002-08-01  Akim Demaille  <akim@epita.fr>

	Instead of attaching lookaheads and duplicating the rules being
	reduced by a state, attach the lookaheads to the reductions.

	* src/state.h (state_t): Remove the `lookaheads',
	`lookaheads_rule' member.
	(reductions_t): Add a `lookaheads' member.
	Use a regular array for the `rules'.
	* src/state.c (reductions_new): Initialize the lookaheads member
	to 0.
	(state_rule_lookaheads_print): Adjust.
	* src/state.h, src/state.c (state_reductions_find): New.
	* src/conflicts.c (resolve_sr_conflict, set_conflicts)
	(count_rr_conflicts): Adjust.
	* src/lalr.c (LArule): Remove.
	(add_lookback_edge): Adjust.
	(state_lookaheads_count): New.
	(states_lookaheads_initialize): Merge into...
	(initialize_LA): this.
	(lalr_free): Adjust.
	* src/main.c (main): Don't free nullable and derives too early: it
	is used by --verbose.
	* src/print.c, src/print_graph.c, src/tables.c: Adjust.

2002-08-01  Akim Demaille  <akim@epita.fr>

	* src/derives.h, src/derives.c (derives): A `rule_t***' instead of
	`rule_number_t**'.
	(set_derives, free_derives): Rename as...
	(derives_compute, derives_free): this.
	Adjust all dependencies.
	* src/nullable.c (set_nullable, free_nullable): Rename as...
	(nullable_compute, nullable_free): these.
	(rule_list_t): Store rule_t *, not rule_number_t.
	* src/state.c (state_rule_lookaheads_print): Directly compare rule
	pointers, instead of their numbers.
	* src/main.c (main): Call nullable_free, and derives_free earlier,
	as they were lo longer used.

2002-08-01  Akim Demaille  <akim@epita.fr>

	* lib/timevar.c (get_time): Include children time.
	* src/lalr.h (LA, LArule): Don't export them: used with the
	state_t.
	* src/lalr.c (LA, LArule): Static.
	* src/lalr.h, src/lalr.c (lalr_free): New.
	* src/main.c (main): Call it.
	* src/tables.c (pack_vector): Check whether loc is >= to the
	table_size, not >.
	(pack_tables): Don't free froms, tos, conflict_tos, and pos...
	(tables_generate): do it, since that's also it which allocates
	them.
	Don't free LA and LArule, main does.

2002-07-31  Akim Demaille  <akim@epita.fr>

	Separate parser tables computation and output.

	* src/output.c (nvectors, base_t, base, base_ninf, conflict_table)
	(conflict_list, conflict_list_cnt, table, check, table_ninf)
	(yydefgoto, yydefact, high): Move to...
	* src/tables.h, src/tables.c: here.
	* src/output.c (vector_number_t, VECTOR_NUMBER_MAX)
	(VECTOR_NUMBER_MIN, state_number_to_vector_number)
	(symbol_number_to_vector_number, nvectors, BASE_MAX, BASE_MIN)
	(froms, tos, conflict_tos, tally, width, action_t, ACTION_MAX)
	(ACTION_MIN, actrow, order, nentries, pos, conflrow)
	(conflict_list_free, table_size, lowzero, table_grow, conflict_row)
	(action_row, save_row, token_actions, save_column, default_goto)
	(goto_actions, sort_actions, matching_state, pack_vector)
	(table_ninf_remap, pack_table, prepare_actions): Move to...
	* src/tables.c: here.
	* src/tables.h, src/tables.c(tables_generate, tables_free): New.
	* src/output.c (token_actions, output_base, output_conflicts)
	(output_check): Merge into...
	(prepare_actions): this.
	(actions_output): Rename as...
	(user_actions_output): this.
	* src/main.c (main): Call tables_generate and tables_free.

2002-07-31  Akim Demaille  <akim@epita.fr>

	Steal GCC's --time-report support.

	* lib/timevar.c, lib/timevar.h, lib/timevar.def: New,
	stolen/adjusted from GCC.
	* m4/stage.m4: Remove time related checks.
	* m4/timevar.m4: New.
	* configure.in: Adjust.
	* src/system.h: Adjust to using timevar.h.
	* src/getargs.h, src/getargs.c: Support trace_time for
	--trace=time.
	* src/main.c (stage): Remove.
	(main): Replace `stage' invocations with timevar calls.
	* src/output.c: Insert pertinent timevar calls.

2002-07-31  Akim Demaille  <akim@epita.fr>

	Let --trace have arguments.

	* src/getargs.h (enum trace_e): New.
	* src/getargs.c (trace_args, trace_types, trace_argmatch): New.
	(long_options, short_options): --trace/-T takes an optional
	argument.
	Change all the uses of trace_flag to reflect the new flags.
	* tests/sets.at (Firsts, Nullable, Broken Closure): Use --trace=sets.

	Strengthen `stage' portability.

	* m4/stage.m4 (BISON_PREREQ_STAGE): New.
	* configure.in: Use it.
	Don't check for malloc.h and sys/times.h.
	* src/system.h: Include them when appropriate.
	* src/main.c (stage): Compile only when mallinfo, struct mallinfo,
	times and struct tms are available.

2002-07-30  Akim Demaille  <akim@epita.fr>

	In verbose parse error message, don't report `error' as an
	expected token.
	* tests/actions.at (Printers and Destructors): Adjust.
	* tests/calc.at (Calculator $1): Adjust.
	* data/yacc.c, data/glr.c, data/lalr1.c: When making the verbose
	error message, do not report the parser accepts the error token in
	that state.

2002-07-30  Akim Demaille  <akim@epita.fr>

	Normalize conflict related messages.

	* src/complain.h, src/complain.c (warn, complain): New.
	* src/conflicts.c (conflicts_print): Use them.
	(conflict_report_yacc): New, extracted from...
	(conflicts_print): here.
	* tests/conflicts.at, tests/existing.at: Adjust.

2002-07-30  Akim Demaille  <akim@epita.fr>

	Report rules which are never reduced by the parser: those hidden
	by conflicts.

	* src/LR0.c (save_reductions): Don't make the final state too
	different: save its reduction (accept) instead of having a state
	without any action (no shift or goto, no reduce).
	Note: the final state is now a ``regular'' state, i.e., the
	parsers now contain `reduce 0' as default reduction.
	Nevertheless, since they decide to `accept' when yystate =
	final_state, they still will not reduce rule 0.
	* src/print.c (print_actions, print_reduction): Adjust.
	* src/output.c (action_row): Track reduced rules.
	(token_actions): Report rules never reduced.
	* tests/conflicts.at, tests/regression.at: Adjust.

2002-07-30  Akim Demaille  <akim@epita.fr>

	`stage' was accidently included in a previous patch.
	Initiate its autoconfiscation.

	* configure.in: Look for malloc.h and sys/times.h.
	* src/main.c (stage): Adjust.
	Report only when trace_flag.

2002-07-29  Akim Demaille  <akim@epita.fr>

	* src/state.h, src/state.c (transitions_t): Holds state_t*'s, not
	state_number_t.
	(errs_t): symbol_t*, not symbol_number_t.
	(reductions_t): rule_t*, not rule_number_t.
	(FOR_EACH_SHIFT): New.
	* src/LR0.c, src/conflicts.c, src/lalr.c, src/output.c
	* src/print.c, src/print_graph.c: Adjust.

2002-07-29  Akim Demaille  <akim@epita.fr>

	Use $accept and $end, as BYacc and BTYacc do, instead of $axiom and $.

	* src/symtab.h, src/symtab.c (eoftoken, axiom): Rename as...
	(endtoken, accept): these.
	* src/reader.c (reader): Set endtoken's default tag to "$end".
	Set undeftoken's tag to "$undefined" instead of "$undefined.".
	* doc/bison.texinfo (Table of Symbols): Mention $accept and $end.
	Adjust.

2002-07-29  Akim Demaille  <akim@epita.fr>

	* src/reduce.c (reduce_grammar): When the language is empty,
	complain about the start symbol, not the axiom.
	Use its location.
	* tests/reduce.at (Empty Language): New.

2002-07-26  Akim Demaille  <akim@epita.fr>

	* src/reader.h, src/reader.c (gram_error): ... can't get
	yycontrol without making too strong assumptions on the parser
	itself.
	* src/output.c (prepare_tokens): Use the real 0th value of
	token_translations instead of `0'.
	* src/parse-gram.y (yyerror): Don't rely on yycontrol being
	visible here.
	* data/yacc.c (yyreport_parse_error): Rename yylocation as yylloc
	for the time being: %locations ought to provide it to yyerror.

2002-07-25  Akim Demaille  <akim@epita.fr>

	* src/output.c (prepare_tokens): Go up to ntokens, not ntokens + 1.
	* doc/bison.texinfo (Decl Summary): s/$illegal/$undefined./.
	* tests/regression.at (Web2c Actions): Adjust.

2002-07-25  Akim Demaille  <akim@epita.fr>

	Stop storing rules from 1 to nrules + 1.

	* src/LR0.c, src/closure.c, src/derives.c, src/gram.c, src/lalr.c
	* src/nullable.c, src/output.c, src/print.c, src/reader.c
	* src/reduce.c: Allocate and free from &rules[0], not &rules[1].
	Iterate from 0 to nrules.
	Use rule_number_as_item_number and item_number_as_rule_number.
	Adjust to `derive' now containing possibly 0.
	* src/gram.h (rule_number_as_item_number, item_number_as_rule_number):
	Handle the `- 1' part in rule numbers from/to item numbers.
	* src/conflicts.c (log_resolution): Fix the message which reversed
	shift and reduce.
	* src/output.c (action_row): Initialize default_rule to -1.
	(token_actions): Adjust.
	* tests/sets.at (Nullable, Firsts): Fix the previously bogus
	expected output.
	* tests/conflicts.at (Resolved SR Conflicts): Likewise.

2002-07-25  Akim Demaille  <akim@epita.fr>

	* data/c.m4 (b4_c_function, b4_c_ansi_args, b4_c_ansi_arg)
	(b4_c_knr_arg_names, b4_c_knr_arg_name, b4_c_knr_arg_decls)
	(b4_c_knr_arg_decl): New.
	* data/yacc.c: Use it to define yysymprint, yydestruct, and
	yyreport_parse_error.

2002-07-25  Akim Demaille  <akim@epita.fr>

	* data/yacc.c (yyreport_parse_error): New, extracted from...
	(yyparse): here.
	(yydestruct, yysymprint): Move above yyparse.
	Be K&R compliant.

2002-07-25  Akim Demaille  <akim@epita.fr>

	* data/c.m4 (b4_ints_in, b4_int_type, b4_int_type_for): New,
	replace...
	(b4_sint_type, b4_uint_type): these.
	* data/yacc.c, data/glr.c, data/lalr1.cc: Use b4_int_type_for.
	* tests/regression.at (Web2c Actions): Adjust.

2002-07-25  Akim Demaille  <akim@epita.fr>

	* src/gram.h (TIEM_NUMBER_MAX): New.
	(item_number_of_rule_number, rule_number_of_item_number): Rename
	as...
	(rule_number_as_item_number, item_number_as_rule_number): these.
	Adjust dependencies.
	* src/output.c (vector_number_t, VECTOR_NUMBER_MAX)
	(VECTOR_NUMBER_MIN, state_number_to_vector_number)
	(symbol_number_to_vector_number): New.
	(order): Of vector_number_t* type.
	(base_t, BASE_MAX, BASE_MIN): New.
	(froms, tos, width, pos, check): Of base_t type.
	(action_number_t, ACTION_MIN, ACTION_MAX): New.
	(actrow): Of action_number_t type.
	(conflrow): Of unsigned int type.
	(table_ninf, base_ninf): New.
	(GENERATE_MUSCLE_INSERT_TABLE): Also output the `*_min' value.
	(muscle_insert_int_table, muscle_insert_base_table)
	(muscle_insert_rule_number_table): New.
	(prepare_tokens): Output `toknum' as int_table.
	(action_row): Returns a rule_number_t.
	Use ACTION_MIN, not SHRT_MIN.
	(token_actions): yydefact is rule_number_t*.
	(table_ninf_remap): New.
	(pack_table): Use it for `base' and `table'.
	* data/yacc.c, data/glr.c, data/lalr1.cc (YYFLAG): Remove,
	replaced with...
	(YYPACT_NINF, YYTABLE_NINF): these.
	(yypact, yytable): Compute their types instead of hard-coded
	`short'.
	* tests/regression.at (Web2c Actions): Adjust.

2002-07-19  Akim Demaille  <akim@epita.fr>

	* src/scan-gram.l (id): Can start with an underscore.

2002-07-16  Akim Demaille  <akim@epita.fr>

	* src/assoc.c, src/asssoc.h (assoc_t, assoc_to_string): New.
	Adjust all former `associativity' dependencies.
	* src/symtab.c (symbol_new): Default associativity is `undef', not
	`right'.
	(symbol_check_alias_consistence): Adjust.

2002-07-09  Akim Demaille  <akim@epita.fr>

	* doc/bison.texinfo: Properly set the ``header'' part.
	Use @dircategory ``GNU programming tools'' as per Texinfo's
	documentation.
	Use @copying.

2002-07-09  Akim Demaille  <akim@epita.fr>

	* lib/quotearg.h: Protect against multiple inclusions.
	* src/location.h (location_t): Add a `file' member.
	(LOCATION_RESET, LOCATION_PRINT): Adjust.
	* src/complain.c (warn_at, complain_at, fatal_at): Drop
	`error_one_per_line' support.

2002-07-09  Akim Demaille  <akim@epita.fr>

	* src/complain.h, src/complain.c (warn, complain): Remove, unused.
	* src/reader.c (lineno): Remove.
	Adjust all dependencies.
	(get_merge_function): Take a location and use complain_at.
	* src/symtab.h, src/symtab.c (symbol_make_alias): Likewise.
	* tests/regression.at (Invalid inputs, Mixing %token styles):
	Adjust.

2002-07-09  Akim Demaille  <akim@epita.fr>

	* src/parse-gram.y (rules_or_grammar_declaration): Add an error
	recovery rule, and forbid extensions when --yacc.
	(gram_error): Use complain_at.
	* src/reader.c (reader): Exit if there were parse errors.

2002-07-09  Akim Demaille  <akim@epita.fr>

	* tests/synclines.at (AT_SYNCLINES_COMPILE): New.
	(AT_TEST_SYNCLINE): Adjust to unusual GCC outputs.
	Reported by R Blake <blakers@mac.com>.

2002-07-09  Akim Demaille  <akim@epita.fr>

	* data/yacc.c: Output the copyright notive in the header.

2002-07-03  Akim Demaille  <akim@epita.fr>

	* src/output.c (froms, tos): Are state_number_t.
	(save_column): sp, sp1, and sp2 are state_number_t.
	(prepare): Rename `final' as `final_state_number', `nnts' as
	`nterms_number', `nrules' as `rules_number', `nstates' as
	`states_number', and `ntokens' as `tokens_number'.  Remove `nsym',
	unused.
	* data/yacc.c, data/glr.c, data/lalr1.cc: Adjust.
	* data/lalr1.cc (nsym_): Remove, unused.

2002-07-03  Akim Demaille  <akim@epita.fr>

	* src/lalr.h, src/lalr.c (goto_number_t): New.
	* src/lalr.c (goto_list_t): New.
	Propagate them.
	* src/nullable.c (rule_list_t): New.
	Propagate.
	* src/types.h: Remove.

2002-07-03  Akim Demaille  <akim@epita.fr>

	* src/closure.c (print_fderives): Use rule_rhs_print.
	* src/derives.c (print_derives): Use rule_rhs_print.
	(rule_list_t): New, replaces `shorts'.
	(set_derives): Add comments.
	* tests/sets.at (Nullable, Firsts): Adjust.

2002-07-03  Akim Demaille  <akim@epita.fr>

	* src/output.c (prepare_actions): Free `tally' and `width'.
	(prepare_actions): Allocate and free `order'.
	* src/symtab.c (symbols_free): Free `symbols'.
	* src/scan-gram.l (scanner_free): Clear Flex's scanners memory.
	* src/output.c (m4_invoke): Move to...
	* src/scan-skel.l: here.
	(<<EOF>>): Close yyout, and free its name.

2002-07-03  Akim Demaille  <akim@epita.fr>

	Fix some memory leaks, and fix a bug: state 0 was examined twice.

	* src/LR0.c (new_state): Merge into...
	(state_list_append): this.
	(new_states): Merge into...
	(generate_states): here.
	(set_states): Don't ensure a proper `errs' state member here, do it...
	* src/conflicts.c (conflicts_solve): here.
	* src/state.h, src/state.c: Comment changes.
	(state_t): Rename member `shifts' as `transitions'.
	Adjust all dependencies.
	(errs_new): For consistency, also take the values as argument.
	(errs_dup): Remove.
	(state_errs_set): New.
	(state_reductions_set, state_transitions_set): Assert that no
	previous value was assigned.
	(state_free): New.
	(states_free): Use it.
	* src/conflicts.c (resolve_sr_conflict): Don't use an `errs_t' as
	temporary storage: use `errs' and `nerrs' as elsewhere.
	(set_conflicts): Allocate and free this `errs'.

2002-07-02  Akim Demaille  <akim@epita.fr>

	* lib/libiberty.h: New.
	* lib: Update the bitset implementation from upstream.
	* src/closure.c, src/lalr.c, src/output.c, src/print_graph.c,
	* src/state.c: Use BITSET_FOR_EACH, not BITSET_EXECUTE.
	* src/main.c: Adjust bitset stats calls.

2002-07-01  Paul Eggert  <eggert@twinsun.com>

	* src/scan-gram.l (<SC_ESCAPED_CHARACTER>): Convert to unsigned
	char, so that negative chars don't collide with $.

2002-06-30  Akim Demaille  <akim@epita.fr>

	Have the GLR tests be `warning' checked, and fix the warnings.

	* data/glr.c (YYFPRINTF): Always define it, not only when YYDEBUG
	(yyuserAction, yyreportAmbiguity): `Use' all the arguments.
	(yyremoveDeletes): `yyi' and `yyj' are size_t.
	Use YYFPRINTF when under if (YYDEBUG) to avoid empty `if' bodies.
	(yyaddDeferredAction): static.
	(yyglrReduce): yyi, yyk, amd yyposn are size_t.
	(yyreportParseError): yyprefix is const.
	yytokenp is used only when verbose.
	(yy__GNUC__): Replace with __GNUC__.
	(yypdumpstack): yyi is size_t.
	(yypreference): Un-yy local variables and arguments, to avoid
	clashes with `yyr1'.  Anyway, we are not in the user name space.
	(yytname_size): be an int, as is compared with ints.
	* tests/testsuite.at (AT_COMPILE, AT_PARSER_CHECK): New.
	Use them.
	* tests/cxx-gram.at: Use quotation to protect $1.
	Use AT_COMPILE to enable warnings hunts.
	Prototype yylex and yyerror.
	`Use' argc.
	Include `string.h', not `strings.h'.
	Produce and prototype stmtMerge only when used.
	yylex takes a location.

2002-06-30  Akim Demaille  <akim@epita.fr>

	We spend a lot of time in quotearg, in particular when --verbose.

	* src/symtab.c (symbol_get): Store a quoted version of the key.
	(symbol_tag_get, symbol_tag_get_n, symbol_tag_print): Remove.
	Adjust all callers.

2002-06-30  Akim Demaille  <akim@epita.fr>

	* src/state.h (reductions_t): Rename member `nreds' as num.
	(errs_t): Rename members `nerrs' and `errs' as `num' and `symbols'.
	* src/state.c (ERRS_ALLOC, REDUCTIONS_ALLOC): Use the correct types.

2002-06-30  Akim Demaille  <akim@epita.fr>

	* src/state.h, src/state.c (shift_t, SHIFT_SYMBOL, SHIFT_IS_SHIFT)
	(SHIFT_IS_GOTO, SHIFT_IS_ERROR, SHIFT_DISABLE, SHIFT_IS_DISABLED)
	(shifts_to): Rename as...
	(transition_t, TRANSITION_SYMBOL, TRANSITION_IS_TRANSITION)
	(TRANSITION_IS_GOTO, TRANSITION_IS_ERROR, TRANSITION_DISABLE)
	(TRANSITION_IS_DISABLED, transitions_to): these.

2002-06-30  Akim Demaille  <akim@epita.fr>

	* src/print.c (print_shifts, print_gotos): Merge into...
	(print_transitions): this.
	(print_transitions, print_errs, print_reductions): Align the
	lookaheads columns.
	(print_core, print_transitions, print_errs, print_state,
	print_grammar): Output empty lines separator before, not after.
	(state_default_rule_compute): Rename as...
	(state_default_rule): this.
	* tests/conflicts.at (Defaulted Conflicted Reduction),
	(Unresolved SR Conflicts, Resolved SR Conflicts): Adjust.
	* tests/regression.at (Rule Line Numbers, Web2c Report): Adjust.

2002-06-30  Akim Demaille  <akim@epita.fr>

	Display items as we display rules.

	* src/gram.h, src/gram.c (rule_lhs_print): New.
	* src/gram.c (grammar_rules_partial_print): Use it.
	* src/print.c (print_core): Likewise.
	* tests/conflicts.at (Defaulted Conflicted Reduction),
	(Unresolved SR Conflicts): Adjust.
	(Unresolved SR Conflicts): Adjust and rename as...
	(Resolved SR Conflicts): this, as was meant.
	* tests/regression.at (Web2c Report): Adjust.

2002-06-30  Akim Demaille  <akim@epita.fr>

	* src/print.c (state_default_rule_compute): New, extracted from...
	(print_reductions): here.
	Pessimize, but clarify the code.
	* tests/conflicts.at (Defaulted Conflicted Reduction): New.

2002-06-30  Akim Demaille  <akim@epita.fr>

	* src/output.c (action_row): Let default_rule be always a rule
	number.

2002-06-30  Akim Demaille  <akim@epita.fr>

	* src/closure.c (print_firsts, print_fderives, closure):
	Use BITSET_EXECUTE.
	* src/lalr.c (lookaheads_print): Likewise.
	* src/state.c (state_rule_lookaheads_print): Likewise.
	* src/print_graph.c (print_core): Likewise.
	* src/print.c (print_reductions): Likewise.
	* src/output.c (action_row): Likewise.
	Use SHIFT_IS_DISABLED, SHIFT_IS_SHIFT and SHIFT_SYMBOL.

2002-06-30  Akim Demaille  <akim@epita.fr>

	* src/print_graph.c: Use report_flag.

2002-06-30  Akim Demaille  <akim@epita.fr>

	* src/lalr.c (traverse, digraph, matrix_print, transpose): Move
	to...
	* src/relation.h, src/relation.c (traverse, relation_digraph)
	(relation_print, relation_transpose): New.

2002-06-30  Akim Demaille  <akim@epita.fr>

	* src/state.h, src/state.c (shifts_to): New.
	* src/lalr.c (build_relations): Use it.

2002-06-30  Akim Demaille  <akim@epita.fr>

	* src/gram.h (rule_number_t, RULE_NUMBER_MAX, int_of_rule_number)
	(item_number_of_rule_number, rule_number_of_item_number): New.
	* src/LR0.c, src/closure.c, src/derives.c, src/derives.h,
	* src/gram.c, src/lalr.c, src/nullable.c, src/output.c, src/print.c,
	* src/print_graph.c, src/reader.c, src/reduce.c, src/reduce.h:
	Propagate their use.
	Much remains to be done, in particular wrt `shorts' from types.h.

2002-06-30  Akim Demaille  <akim@epita.fr>

	* src/symtab.c (symbol_new): Initialize the `printer' member.

2002-06-30  Akim Demaille  <akim@epita.fr>

	* src/LR0.c (save_reductions): Remove, replaced by...
	* src/state.h, src/state.c (state_reductions_set): New.
	(reductions, errs): Rename as...
	(reductions_t, errs_t): these.
	Adjust all dependencies.

2002-06-30  Akim Demaille  <akim@epita.fr>

	* src/LR0.c (state_list_t, state_list_append): New.
	(first_state, last_state): Now symbol_list_t.
	(this_state): Remove.
	(new_itemsets, append_states, save_reductions): Take a state_t as
	argument.
	(set_states, generate_states): Adjust.
	(save_shifts): Remove, replaced by...
	* src/state.h, src/state.c (state_shifts_set): New.
	(shifts): Rename as...
	(shifts_t): this.
	Adjust all dependencies.
	* src/state.h (state_t): Remove the `next' member.

2002-06-30  Akim Demaille  <akim@epita.fr>

	* src/vcg.c (quote): Use slot 2, since we often pass symbol tag
	escaped in slot 0.

2002-06-30  Akim Demaille  <akim@epita.fr>

	Use hash.h for the state hash table.

	* src/LR0.c (STATE_HASH_SIZE, state_hash): Remove.
	(allocate_storage): Use state_hash_new.
	(free_storage): Use state_hash_free.
	(new_state, get_state): Adjust.
	* src/lalr.h, src/lalr.c (states): Move to...
	* src/states.h (state_t): Remove the `link' member, no longer
	used.
	* src/states.h, src/states.c: here.
	(state_hash_new, state_hash_free, state_hash_lookup)
	(state_hash_insert, states_free): New.
	* src/states.c (state_table, state_compare, state_hash): New.
	* src/output.c (output_actions): Do not free states now, since we
	still need to know the final_state number in `prepare', called
	afterwards.  Do it...
	* src/main.c (main): here: call states_free after `output'.

2002-06-30  Akim Demaille  <akim@epita.fr>

	* src/state.h, src/state.c (state_new): New, extracted from...
	* src/LR0.c (new_state): here.
	* src/state.h (STATE_ALLOC): Move to...
	* src/state.c: here.
	* src/LR0.h, src/LR0.c (nstates, final_state): Move to...
	* src/state.h, src/state.c: here.

2002-06-30  Akim Demaille  <akim@epita.fr>

	* src/reader.c (gensym): Rename as...
	* src/symtab.h, src/symtab.c (dummy_symbol_get): this.
	(getsym): Rename as...
	(symbol_get): this.

2002-06-30  Akim Demaille  <akim@epita.fr>

	* src/state.h (state_number_t, STATE_NUMBER_MAX): New.
	* src/LR0.c, src/LR0.h, src/conflicts.c, src/lalr.c, src/lalr.h,
	* src/output.c, src/print.c, src/print_graph.c: Propagate.
	* src/LR0.h, src/LR0.h (final_state): Is a state_t*.

2002-06-30  Akim Demaille  <akim@epita.fr>

	Make the test suite pass with warnings checked.

	* tests/actions.at (Printers and Destructors): Improve.
	Avoid unsigned vs. signed issues.
	* tests/calc.at: Don't exercise the scanner here, do it...
	* tests/input.at (Torturing the Scanner): here.

2002-06-28  Paul Hilfinger  <Hilfinger@CS.Berkeley.EDU>

	* data/glr.c: Correct typo in Emacs-mode directive.  Slightly
	reorganize first lines parallel to yacc.c.

2002-06-28  Akim Demaille  <akim@epita.fr>

	* data/c.m4 (b4_copyright, b4_sint_type, b4_uint_type, b4_token_define)
	(b4_token_enum, b4_token_defines): New, factored from...
	* data/lalr1.cc, data/yacc.c, glr.c: here.

2002-06-28  Akim Demaille  <akim@epita.fr>

	* data/yacc.c (yydestruct, yysymprint): Pacify GCC warnings for
	unused variables.
	* src/output.c (merger_output): static.

2002-06-28  Akim Demaille  <akim@epita.fr>

	* src/reader.h:	s/grammer_current_rule_merge_set/grammar_.../.
	* src/conflicts.c (conflicts_total_count): `i' is unsigned, to
	pacify GCC.
	* src/output.c (save_row): Initialize all the variables to pacify GCC.

2002-06-27  Paul Hilfinger  <Hilfinger@CS.Berkeley.EDU>

	Accumulated changelog for new GLR parsing features.

	* src/conflicts.c (count_total_conflicts): Change name to
	conflicts_total_count.
	* src/conflicts.h: Ditto.
	* src/output.c (token_actions): Use the new name.
	(output_conflicts): Change conflp => conflict_list_heads, and
	confl => conflict_list for better readability.
	* data/glr.c: Use the new names.
	* NEWS: Add self to GLR announcement.

	* src/reader.c (free_merger_functions): Cleanup: XFREE->free.

	* doc/bison.texinfo (GLR Parsers): Make corrections suggested by
	Akim Demaille.

	* data/bison.glr: Change name to glr.c
	* data/glr.c: Renamed from bison.glr.
	* data/Makefile.am: Add glr.c

	* src/getargs.c:

	* src/symlist.h:  Add dprec and merger fields to symbol_list_s.
	* src/symlist.c	(symbol_list_new): Initialize dprec and merger fields.

	Originally 2002-06-16  Paul Hilfinger  <Hilfinger@CS.Berkeley.EDU>

	* data/bison.glr: Be sure to restore the
	current #line when returning to the skeleton contents after having
	exposed the input file's #line.

	Originally 2002-06-13  Paul Hilfinger  <Hilfinger@CS.Berkeley.EDU>

	* data/bison.glr: Bring up to date with changes to bison.simple.

	Originally 2002-06-03  Paul Hilfinger  <Hilfinger@CS.Berkeley.EDU>

	* data/bison.glr: Correct definitions that use b4_prefix.
	Various reformatting.
	(GLRStack): Make yychar (in YYPURE case) and yytokenp as part of stack.
	(yyreportParseError, yyrecoverParseError, yyprocessOneStack): remove
	yytokenp argument; now part of stack.
	(yychar): Define to behave as documented.
	(yyclearin): Ditto.

	Originally 2002-05-14  Paul Hilfinger  <Hilfinger@CS.Berkeley.EDU>

	* src/reader.h: Add declaration for free_merger_functions.

	* src/reader.c (merge_functions): New variable.
	(get_merge_function): New function.
	(free_merger_functions): New function.
	(readgram): Check for %prec that is not followed by a symbol.
	Handle %dprec and %merge declarations.
	(packgram): Initialize dprec and merger fields in rules array.

	* src/output.c (conflict_tos, conflrow, conflict_table, conflict_list,
	conflict_list_cnt, conflict_list_free): New variables.
	(table_grow): Also grow conflict_table.
	(prepare_rules): Output dprec and merger tables.
	(conflict_row): New function.
	(action_row): Output conflict lists for GLR parser.  Don't use
	default reduction in conflicted states for GLR parser so that there
	are spaces for the conflict lists.
	(save_row): Also save conflict information.
	(token_actions): Allocate conflict list.
	(merger_output): New function.
	(pack_vector): Pack conflict table, too.
	(output_conflicts): New function to output yyconflp and yyconfl.
	(output_check): Allocate conflict_tos.
	(output_actions): Output conflict tables, also.
	(output_skeleton): Output b4_mergers definition.
	(prepare): Output b4_max_rhs_length definition.
	Use 'bison.glr' as default skeleton for GLR parsers.

	* src/gram.c (glr_parser): New flag.
	(grammar_free): Call free_merger_functions.

	* src/conflicts.c (count_rr_conflicts): Augment to optionally count
	all pairs of conflicting reductions, rather than just all tokens
	causing conflicts.  Needed to size conflict tables.
	(conflicts_output): Modify call to count_rr_conflicts for new
	interface.
	(conflicts_print): Ditto.
	(count_total_conflicts): New function.

	* src/reader.h (merger_list): New type.
	(merge_functions): New variable.

	* src/lex.h (tok_dprec, tok_merge): New token types.

	* src/gram.h (rule_s): Add dprec and merger fields.
	(glr_parser): New flag.

	* src/conflicts.h (count_total_conflicts): New function.

	* src/options.c (option_table): Add %dprec, %merge, and %glr-parser.

	* doc/bison.texinfo (Generalized LR Parsing): New section.
	(GLR Parsers): New section.
	(Language and Grammar): Mention GLR parsing.
	(Table of Symbols): Add %dprec, %glr-parser, %merge, GLR
	Correct typo ("tge" -> "the").

	* data/bison.glr: New skeleton for GLR parsing.

	* tests/cxx-gram.at: New tests for GLR parsing.

	* tests/testsuite.at: Include cxx-gram.at.

	* tests/Makefile.am: Add cxx-gram.at.

	* src/parse-gram.y:

	* src/scan-gram.l: Add %dprec, %glr-parser, %merge.

	* src/parse-gram.y: Grammar for %dprec, %merge, %glr-parser.

2002-06-27  Akim Demaille  <akim@epita.fr>

	* src/options.h, src/options.c: Remove.
	* src/getargs.c (short_options, long_options): New.

2002-06-27  Akim Demaille  <akim@epita.fr>

	* data/bison.simple, data/bison.c++: Rename as...
	* data/yacc.c, data/lalr1.cc: these.
	* doc/bison.texinfo (Environment Variables): Remove.

2002-06-25  Raja R Harinath  <harinath@cs.umn.edu>

	* src/getargs.c (report_argmatch): Initialize strtok().

2002-06-20  Akim Demaille  <akim@epita.fr>

	* data/bison.simple (b4_symbol_actions): New, replaces...
	(b4_symbol_destructor, b4_symbol_printer): these.
	(yysymprint): Be sure to call YYPRINT only for tokens, and using
	user token numbers.

2002-06-20  Akim Demaille  <akim@epita.fr>

	* data/bison.simple (yydestructor): Rename as...
	(yydestruct): this.

2002-06-20  Akim Demaille  <akim@epita.fr>

	* src/symtab.h, src/symtab.c (symbol_type_set)
	(symbol_destructor_set, symbol_precedence_set): The location is
	the last argument.
	Adjust all callers.

2002-06-20  Akim Demaille  <akim@epita.fr>

	* src/parse-gram.y (YYPRINT, yyprint): Don't mess with the parser
	internals.
	* src/reader.h, src/reader.c (grammar_current_rule_prec_set):
	Takes a location.
	* src/symtab.h, src/symtab.c (symbol_class_set)
	(symbol_user_token_number_set): Likewise.
	Adjust all callers.
	Promote complain_at.
	* tests/input.at (Type Clashes): Adjust.

2002-06-20  Akim Demaille  <akim@epita.fr>

	* data/bison.simple (YYLEX): Fix the declaration when
	%pure-parser.

2002-06-20  Akim Demaille  <akim@epita.fr>

	* data/bison.simple (yysymprint): Don't print the token number,
	just its name.
	* tests/actions.at (Destructors): Rename as...
	(Printers and Destructors): this.
	Also exercise %printer.

2002-06-20  Akim Demaille  <akim@epita.fr>

	* data/bison.simple (YYDSYMPRINT): New.
	Use it to remove many of the #if YYDEBUG/if (yydebug).

2002-06-20  Akim Demaille  <akim@epita.fr>

	* src/symtab.h, src/symtab.c (symbol_t): printer and
	printer_location are new members.
	(symbol_printer_set): New.
	* src/parse-gram.y (PERCENT_PRINTER): New token.
	Handle its associated rule.
	* src/scan-gram.l: Adjust.
	(handle_destructor_at, handle_destructor_dollar): Rename as...
	(handle_symbol_code_at, handle_symbol_code_dollar): these.
	* src/output.c (symbol_printers_output): New.
	(output_skeleton): Call it.
	* data/bison.simple (yysymprint): New.  Cannot be named yyprint
	since there are already many grammar files with a user `yyprint'.
	Replace the calls to YYPRINT to calls to yysymprint.
	* tests/calc.at: Adjust.
	* tests/torture.at (AT_DATA_STACK_TORTURE): Remove YYPRINT: it was
	taking advantage of parser very internal details (stack size!).

2002-06-20  Akim Demaille  <akim@epita.fr>

	* src/scan-gram.l: Complete the scanner with the missing patterns
	to pacify Flex.
	Use `quote' and `symbol_tag_get' where appropriate.

2002-06-19  Akim Demaille  <akim@epita.fr>

	* tests/actions.at (Destructors): Augment to test locations.
	* data/bison.simple (yydestructor): Pass it the current location
	if locations are enabled.
	Prototype only when __STDC__ or C++.
	Change the argument names to move into the yy name space: there is
	user code here.

2002-06-19  Akim Demaille  <akim@epita.fr>

	* data/bison.simple (b4_pure_if): New.
	Use it instead of #ifdef YYPURE.

2002-06-19  Akim Demaille  <akim@epita.fr>

	* data/bison.simple (b4_location_if): New.
	Use it instead of #ifdef YYLSP_NEEDED.

2002-06-19  Akim Demaille  <akim@epita.fr>

	Prepare @$ in %destructor, but currently don't bind it in the
	skeleton, as %location use is not cleaned up yet.

	* src/scan-gram.l (handle_dollar, handle_destructor_at)
	(handle_action_at): New.
	(handle_at, handle_action_dollar, handle_destructor_dollar): Take
	a braced_code_t and a location as additional arguments.
	(handle_destructor_dollar): Instead of requiring `b4_eval', just
	unquote one when outputting `b4_dollar_dollar'.
	Adjust callers.
	* data/bison.simple (b4_eval): Remove.
	(b4_symbol_destructor): Adjust.
	* tests/input.at (Invalid @n): Adjust.

2002-06-19  Zack Weinberg  <zack@codesourcery.com>

	* doc/bison.texinfo: Document ability to have multiple
	prologue sections.

2002-06-18  Akim Demaille  <akim@epita.fr>

	* src/files.c (compute_base_names): When computing the output file
	names from the input file name, strip the directory part.

2002-06-18  Akim Demaille  <akim@epita.fr>

	* data/bison.simple.new: Comment changes.
	Reported by Andreas Schwab.

2002-06-18  Matt Kraai  <kraai@alumni.cmu.edu>

	* data/bison.simple (yyoverflowlab): #ifndef yyoverflow, so that
	there are no `label `yyoverflowlab' defined but not used' warnings
	when yyoverflow is defined.

2002-06-18  Akim Demaille  <akim@epita.fr>

	* src/symtab.h, src/symtab.c (symbol_t): destructor_location is a
	new member.
	(symbol_destructor_set): Adjust.
	* src/output.c (symbol_destructors_output): Output the destructor
	locations.
	Output the symbol name.
	* data/bison.simple (b4_symbol_destructor): Adjust.

2002-06-18  Cris Bailiff  <c.bailiff@awayweb.com>
	and Akim Demaille  <akim@epita.fr>

	* data/bison.simple.new (yyerrlab1): Be sure to pop and destroy
	what's left on the stack when the error recovery hits EOF.
	* tests/actions.at (Destructors): Complete to exercise this case.

2002-06-17  Akim Demaille  <akim@epita.fr>

	* data/m4sugar/m4sugar.m4 (m4_map): Recognize when the list of
	arguments is really empty, not only equal to `[]'.
	* src/symtab.h, src/symtab.c (symbol_t): `destructor' is a new
	member.
	(symbol_destructor_set): New.
	* src/output.c (symbol_destructors_output): New.
	* src/reader.h (brace_code_t, current_braced_code): New.
	* src/scan-gram.l (BRACED_CODE): Use it to branch on...
	(handle_dollar): Rename as...
	(handle_action_dollar): this.
	(handle_destructor_dollar): New.
	* src/parse-gram.y (PERCENT_DESTRUCTOR): New.
	(grammar_declaration): Use it.
	* data/bison.simple (yystos): Is always defined.
	(yydestructor): New.
	* tests/actions.at (Destructors): New.
	* tests/calc.at (_AT_CHECK_CALC_ERROR): Don't rely on egrep.

2002-06-17  Akim Demaille  <akim@epita.fr>

	* src/symlist.h, src/symlist.c (symbol_list_length): New.
	* src/scan-gram.l (handle_dollar, handle_at): Compute the
	rule_length only when needed.
	* src/output.c (actions_output, token_definitions_output): Output
	the full M4 block.
	* src/symtab.c: Don't access directly to the symbol tag, use
	symbol_tag_get.
	* src/parse-gram.y: Use symbol_list_free.

2002-06-17  Akim Demaille  <akim@epita.fr>

	* src/reader.h, src/reader.c (symbol_list, symbol_list_new)
	(symbol_list_prepend, get_type_name): Move to...
	* src/symlist.h, src/symlist.c (symbol_list_t, symbol_list_new)
	(symbol_list_prepend, symbol_list_n_type_name_get): here.
	Adjust all callers.
	(symbol_list_free): New.
	* src/scan-gram.l (handle_dollar): Takes a location.
	* tests/input.at (Invalid $n): Adjust.

2002-06-17  Akim Demaille  <akim@epita.fr>

	* src/reader.h, src/reader.c (symbol_list_new): Export it.
	(symbol_list_prepend): New.
	* src/parse-gram.y (%union): `list' is a new member.
	(symbols.1): New, replaces...
	(terms_to_prec.1, nterms_to_type.1): these.
	* src/symtab.h, src/symtab.c (symbol_type_set, symbol_precedence_set)
	Take a location as additional argument.
	Adjust all callers.

2002-06-15  Akim Demaille  <akim@epita.fr>

	* src/parse-gram.y: Move %token in the declaration section so that
	we don't depend upon CVS Bison.

2002-06-15  Akim Demaille  <akim@epita.fr>

	* src/state.h, src/state.c (state_rule_lookaheads_print): New.
	* src/print.c (print_core): Use it.

2002-06-15  Akim Demaille  <akim@epita.fr>

	* src/conflicts.c (log_resolution): Accept the rule involved in
	the sr conflicts instead of the lookahead number that points to
	that rule.
	(flush_reduce): Accept the current lookahead vector as argument,
	instead of the index in LA.
	(resolve_sr_conflict): Accept the current number of lookahead
	bitset to consider for the STATE, instead of the index in LA.
	(set_conflicts): Adjust.
	* src/lalr.c, src/lalr.h, src/state.h: Comment changes.

2002-06-15  Akim Demaille  <akim@epita.fr>

	* src/state.h (state_t): Replace the `lookaheadsp' member, a
	short, with `lookaheads' (bitsetv), `lookaheads_rule' (rule_t**).
	Adjust all dependencies.
	* src/lalr.c (initialize_lookaheads): Split into...
	(states_lookaheads_count, states_lookaheads_initialize): these.
	(lalr): Adjust.

2002-06-15  Akim Demaille  <akim@epita.fr>

	* src/gram.h, src/gram.c (grammar_rules_partial_print): New, eved
	out of...
	(grammar_rules_print): here.
	* src/reduce.c (reduce_output): Use it.
	* tests/reduce.at (Useless Rules, Reduced Automaton)
	(Underivable Rules): Adjust.

2002-06-15  Akim Demaille  <akim@epita.fr>

	Copy BYacc's nice way to report the grammar.

	* src/gram.h, src/gram.c (grammar_rhs_print, grammar_rules_print):
	New.
	Don't print the rules' location, it is confusing and useless.
	(rule_print): Use grammar_rhs_print.
	* src/print.c (print_grammar): Use grammar_rules_print.

2002-06-15  Akim Demaille  <akim@epita.fr>

	Complete and rationalize `useless thing' warnings.

	* src/symtab.h, src/symtab.c (symbol_tag_get, symbol_tag_get_n)
	(symbol_tag_print): New.
	Use them everywhere in place of accessing directly the tag member.
	* src/gram.h, src/gram.c (rule_print): New.
	Use it where a rule used to be printed `by hand'.
	* src/reduce.c (nonterminals_reduce): Report the use nonterminals.
	(reduce_grammar_tables): Report the useless rules.
	(reduce_print): Useless things are a warning, not an error.
	Report it as such.
	* tests/reduce.at (Useless Nonterminals, Useless Rules):
	(Reduced Automaton, Underivable Rules): Adjust.
	* tests/regression.at (Web2c Report, Web2c Report): Adjust.
	* tests/conflicts.at (Unresolved SR Conflicts)
	(Solved SR Conflicts): Adjust.

2002-06-15  Akim Demaille  <akim@epita.fr>

	Let symbols have a location.

	* src/symtab.h, src/symtab.c (symbol_t): Location is a new member.
	(getsym): Adjust.
	Adjust all callers.
	* src/complain.h, src/complain.c (complain_at, fatal_at, warn_at):
	Use location_t, not int.
	* src/symtab.c (symbol_check_defined): Take advantage of the
	location.
	* tests/regression.at (Invalid inputs): Adjust.

2002-06-15  Akim Demaille  <akim@epita.fr>

	* src/parse-gram.y (YYLLOC_DEFAULT, current_lhs_location): New.
	(input): Don't try to initialize yylloc here, do it in the
	scanner.
	* src/scan-gram.l (YY_USER_INIT): Initialize yylloc.
	* src/gram.h (rule_t): Change line and action_line into location
	and action_location, of location_t type.
	Adjust all dependencies.
	* src/location.h, src/location.c (empty_location): New.
	* src/reader.h, src/reader.c (grammar_start_symbol_set)
	(grammar_symbol_append, grammar_rule_begin, grammar_rule_end)
	(grammar_current_rule_symbol_append)
	(grammar_current_rule_action_append): Expect a location as argument.
	* src/reader.c (grammar_midrule_action): Adjust to attach an
	action's location as dummy symbol location.
	* src/symtab.h, src/symtab.c (startsymbol_location): New.
	* tests/regression.at (Web2c Report, Rule Line Numbers): Adjust
	the line numbers.

2002-06-14  Akim Demaille  <akim@epita.fr>

	Grammar declarations may be found in the grammar section.

	* src/parse-gram.y (rules_or_grammar_declaration): New.
	(declarations): Each declaration may end with a semicolon, not
	just...
	(grammar_declaration): `"%union"'.
	(grammar): Branch to rules_or_grammar_declaration.

2002-06-14  Akim Demaille  <akim@epita.fr>

	* src/main.c (main): Invoke scanner_free.

2002-06-14  Akim Demaille  <akim@epita.fr>

	* src/output.c (m4_invoke): Extracted from...
	(output_skeleton): here.
	Free tempfile.

2002-06-14  Akim Demaille  <akim@epita.fr>

	* src/parse-gram.y (directives, directive, gram)
	(grammar_directives, precedence_directives, precedence_directive):
	Rename as...
	(declarations, declaration, grammar, grammar_declaration)
	(precedence_declaration, precedence_declarator): these.
	(symbol_declaration): New.

2002-06-14  Akim Demaille  <akim@epita.fr>

	* src/files.c (action_obstack): Remove, unused.
	(output_obstack): Remove it, and all its dependencies, as it is no
	longer needed.
	* src/reader.c (epilogue_set): Build the epilogue in the
	muscle_obstack.
	* src/output.h, src/output.c (muscle_obstack): Move to...
	* src/muscle_tab.h, src/muscle_tab.h: here.
	(muscle_init): Initialize muscle_obstack.
	(muscle_free): New.
	* src/main.c (main): Call it.

2002-06-14  Akim Demaille  <akim@epita.fr>

	* src/location.h: New, extracted from...
	* src/reader.h: here.
	* src/Makefile.am (noinst_HEADERS): Merge into
	(bison_SOURCES): this.
	Add location.h.
	* src/parse-gram.y: Use location_t instead of Bison's.
	* src/reader.h, src/reader.c (prologue_augment, epilogue_set):
	Use location_t instead of ints.

2002-06-14  Akim Demaille  <akim@epita.fr>

	* data/bison.simple, data/bison.c++: Be sure to restore the
	current #line when returning to the skeleton contents after having
	exposed the input file's #line.

2002-06-12  Akim Demaille  <akim@epita.fr>

	* src/scan-gram.l (SC_BRACED_CODE): Don't use `<.*>', it is too
	eager.
	* tests/actions.at (Exotic Dollars): New.

2002-06-12  Akim Demaille  <akim@epita.fr>

	* src/scan-gram.l (SC_PROLOGUE): Don't eat characters amongst
	['"/] too eagerly.
	* tests/input.at (Torturing the Scanner): New.

2002-06-11  Akim Demaille  <akim@epita.fr>

	* src/scan-gram.l (YY_OBS_INIT): Remove, replace with...
	[SC_COMMENT,SC_STRING,SC_CHARACTER,SC_BRACED_CODE,SC_PROLOGUE]
	[SC_EPILOGUE]: Output the quadrigraphs only when not in a comment.
	* src/reader.h, src/scan-gram.l (scanner_initialize): this.
	* src/reader.c (reader): Use it.

2002-06-11  Akim Demaille  <akim@epita.fr>

	* src/scan-gram.l (YY_OBS_FINISH): Don't set yylval.
	Adjust all callers.
	(scanner_last_string_free): New.

2002-06-11  Akim Demaille  <akim@epita.fr>

	* src/scan-gram.l (YY_INIT, YY_GROW, YY_FINISH): Rename as...
	(YY_OBS_INIT, YY_OBS_GROW, YY_OBS_FINISH): these.
	(last_string, YY_OBS_FREE): New.
	Use them when returning an ID.

2002-06-11  Akim Demaille  <akim@epita.fr>

	Have Bison grammars parsed by a Bison grammar.

	* src/reader.c, src/reader.h (prologue_augment): New.
	* src/reader.c (copy_definition): Remove.

	* src/reader.h, src/reader.c (gram_start_symbol_set, prologue_augment)
	(grammar_symbol_append, grammar_rule_begin, grammar_midrule_action)
	(grammar_current_rule_prec_set, grammar_current_rule_check)
	(grammar_current_rule_symbol_append)
	(grammar_current_rule_action_append): Export.
	* src/parse-gram.y (symbol_list_new, symbol_list_symbol_append_
	(symbol_list_action_append): Remove.
	Hook the routines from reader.
	* src/scan-gram.l: In INITIAL, characters and strings are tokens.
	* src/system.h (ATTRIBUTE_NORETURN, ATTRIBUTE_UNUSED): Now.

	* src/reader.c (read_declarations): Remove, unused.

	* src/parse-gram.y: Handle the epilogue.
	* src/reader.h, src/reader.c (gram_start_symbol_set): Rename as...
	(grammar_start_symbol_set): this.
	* src/scan-gram.l: Be sure to ``use'' yycontrol to keep GCC quiet.
	* src/reader.c (readgram): Remove, unused.
	(reader): Adjust to insert eoftoken and axiom where appropriate.

	* src/reader.c (copy_dollar): Replace with...
	* src/scan-gram.h (handle_dollar): this.
	* src/parse-gram.y: Remove `%thong'.

	* src/reader.c (copy_at): Replace with...
	* src/scan-gram.h (handle_at): this.

	* src/complain.h, src/complain.c (warn_at, complain_at, fatal_at):
	New.

	* src/scan-gram.l (YY_LINES): Keep lineno synchronized for the
	time being.

	* src/reader.h, src/reader.c (grammar_rule_end): New.

	* src/parse.y (current_type, current_class): New.
	Implement `%nterm', `%token' support.
	Merge `%term' into `%token'.
	(string_as_id): New.
	* src/symtab.h, src/symtab.c (symbol_make_alias): Don't pass the
	type name.

	* src/parse-gram.y: Be sure to handle properly the beginning of
	rules.

	* src/parse-gram.y: Handle %type.
	* src/reader.c (grammar_rule_end): Call grammar_current_rule_check.

	* src/parse-gram.y: More directives support.
	* src/options.c: No longer handle source directives.

	* src/parse-gram.y: Fix %output.

	* src/parse-gram.y: Handle %union.
	Use the prologue locations.
	* src/reader.c (parse_union_decl): Remove.

	* src/reader.h, src/reader.c (epilogue_set): New.
	* src/parse-gram.y: Use it.

	* data/bison.simple, data/bison.c++: b4_stype is now either not
	defined, then default to int, or to the contents of %union,
	without `union' itself.
	Adjust.
	* src/muscle_tab.c (muscle_init): Don't predefine `stype'.

	* src/output.c (actions_output): Don't output braces, as they are
	already handled by the scanner.

	* src/scan-gram.l (SC_CHARACTER): Set the user_token_number of
	characters to themselves.

	* tests/reduce.at (Reduced Automaton): End the grammars with %% so
	that the epilogue has a proper #line.

	* src/parse-gram.y: Handle precedence/associativity.

	* src/symtab.c (symbol_precedence_set): Requires the symbol to be
	a terminal.
	* src/scan-gram.l (SC_BRACED_CODE): Catch strings and characters.
	* tests/calc.at: Do not use `%token "foo"' as it makes not sense
	at all to define terminals that cannot be emitted.

	* src/scan-gram.l: Escape M4 characters.

	* src/scan-gram.l: Working properly with escapes in user
	strings/characters.

	* tests/torture.at (AT_DATA_TRIANGULAR_GRAMMAR)
	(AT_DATA_HORIZONTAL_GRAMMAR): Respect the `%token ID NUM STRING'
	grammar.
	Use more modest sizes, as for the time being the parser does not
	release memory, and therefore the process swallows a huge amount
	of memory.

	* tests/torture.at (AT_DATA_LOOKAHEADS_GRAMMAR): Adjust to the
	stricter %token grammar.

	* src/symtab.h (associativity): Add `undef_assoc'.
	(symbol_precedence_set): Do nothing when passed an undef_assoc.
	* src/symtab.c (symbol_check_alias_consistence): Adjust.

	* tests/regression.at (Invalid %directive): Remove, as it is now
	meaningless.
	(Invalid inputs): Adjust to the new error messages.
	(Token definitions): The new grammar doesn't allow too many
	eccentricities.

	* src/lex.h, src/lex.c: Remove.
	* src/reader.c (lastprec, skip_to_char, read_signed_integer)
	(copy_character, copy_string2, copy_string, copy_identifier)
	(copy_comment, parse_token_decl, parse_type_decl, parse_assoc_decl)
	(parse_muscle_decl, parse_dquoted_param, parse_skel_decl)
	(parse_action): Remove.
	* po/POTFILES.in: Adjust.

2002-06-11  Akim Demaille  <akim@epita.fr>

	* src/reader.c 	(parse_action): Don't store directly into the
	rule's action member: return the action as a string.
	Don't require `rule_length' as an argument: compute it.
	(grammar_current_rule_symbol_append)
	(grammar_current_rule_action_append): New, eved out from
	(readgram): here.
	Remove `action_flag', `rulelength', unused now.

2002-06-11  Akim Demaille  <akim@epita.fr>

	* src/reader.c (grammar_current_rule_prec_set).
	(grammar_current_rule_check): New, eved out from...
	(readgram): here.
	Remove `xaction', `first_rhs': useless.
	* tests/input.at (Type clashes): New.
	* tests/existing.at (GNU Cim Grammar): Adjust.

2002-06-11  Akim Demaille  <akim@epita.fr>

	* src/reader.c (grammar_midrule_action): New, Eved out from
	(readgram): here.

2002-06-11  Akim Demaille  <akim@epita.fr>

	* src/reader.c (grammar_rule_begin, previous_rule, current_rule):
	New.
	(readgram): Use them as replacement of inlined code, crule and
	crule1.

2002-06-11  Akim Demaille  <akim@epita.fr>

	* src/reader.c (grammar_end, grammar_symbol_append): New.
	(readgram): Use them.
	Make the use of `p' as local as possible.

2002-06-10  Akim Demaille  <akim@epita.fr>

	GCJ's parser requires the tokens to be defined before the prologue.

	* data/bison.simple: Output the token definition before the user's
	prologue.
	* tests/regression.at (Braces parsing, Duplicate string)
	(Mixing %token styles): Check the output from bison.
	(Early token definitions): New.

2002-06-10  Akim Demaille  <akim@epita.fr>

	* src/symtab.c (symbol_user_token_number_set): Don't complain when
	assigning twice the same user number to a token, so that we can
	use it in...
	* src/lex.c (lex): here.
	Also use `symbol_class_set' instead of hand written code.
	* src/reader.c (parse_assoc_decl): Likewise.

2002-06-10  Akim Demaille  <akim@epita.fr>

	* src/symtab.c, src/symtab.c (symbol_class_set)
	(symbol_user_token_number_set): New.
	* src/reader.c (parse_token_decl): Use them.
	Use a switch instead of ifs.
	Use a single argument.

2002-06-10  Akim Demaille  <akim@epita.fr>

	Remove `%thong' support as it is undocumented, unused, duplicates
	`%token's job, and creates useless e-mail traffic with people who
	want to know what it is, why it is undocumented, unused, and
	duplicates `%token's job.

	* src/reader.c (parse_thong_decl): Remove.
	* src/options.c (option_table): Remove "thong".
	* src/lex.h (tok_thong): Remove.

2002-06-10  Akim Demaille  <akim@epita.fr>

	* src/symtab.c, src/symtab.c (symbol_type_set)
	(symbol_precedence_set): New.
	* src/reader.c (parse_type_decl, parse_assoc_decl): Use them.
	(value_components_used): Remove, unused.

2002-06-09  Akim Demaille  <akim@epita.fr>

	Move symbols handling code out of the reader.

	* src/reader.h, src/reader.c (errtoken, undeftoken, eoftoken)
	(axiom): Move to...
	* src/symtab.h, src/symtab.c: here.

	* src/gram.c (start_symbol): Remove: use startsymbol->number.
	* src/reader.c (startval): Rename as...
	* src/symtab.h, src/symtab.c (startsymbol): this.
	* src/reader.c: Adjust.

	* src/reader.c (symbol_check_defined, symbol_make_alias)
	(symbol_check_alias_consistence, symbol_pack, symbol_translation)
	(token_translations_init)
	Move to...
	* src/symtab.c: here.
	* src/reader.c (packsymbols): Move to...
	* src/symtab.h, src/symtab.c (symbols_pack): here.
	* src/symtab.h, src/symtab.c (symbol_make_alias): Takes SYMVAL as
	argument.

2002-06-03  Akim Demaille  <akim@epita.fr>

	* src/muscle_tab.c (muscle_insert, muscle_find): Declarations,
	then statements.

2002-06-03  Akim Demaille  <akim@epita.fr>

	* src/muscle_tab.c (muscle_find, muscle_insert): Don't initialize
	structs with non literals.
	* src/scan-skel.l: never-interactive.
	* src/conflicts.c (enum conflict_resolution_e): No trailing
	comma.
	* src/getargs.c (usage): Split long literal strings.
	Reported by Hans Aberg.

2002-05-28  Akim Demaille  <akim@epita.fr>

	* data/bison.c++: Use C++ ostreams.
	(cdebug_): New member.

2002-05-28  Akim Demaille  <akim@epita.fr>

	* src/output.c (output_skeleton): Be sure to allocate enough room
	for `/' _and_ for `\0' in full_skeleton.

2002-05-28  Akim Demaille  <akim@epita.fr>

	* data/bison.c++: Catch up with bison.simple:
	2002-05-24  Paul Hilfinger  <Hilfinger@CS.Berkeley.EDU>
	and Paul Eggert  <eggert@twinsun.com>: `error' handing.
	2002-05-26  Akim Demaille  <akim@epita.fr>: stos_, token_number_,
	and popping traces.

2002-05-27  Paul Hilfinger  <Hilfinger@CS.Berkeley.EDU>

	* src/output.c (output_skeleton): Put an explicit path in front of
	the skeleton file name, rather than relying on the -I directory,
	to partially alleviate effects of having a skeleton file lying around
	in the current directory.

2002-05-27  Paul Hilfinger  <Hilfinger@CS.Berkeley.EDU>

	* src/conflicts.c (log_resolution): Correct typo:
	obstack_printf should be obstack_fgrow1.

2002-05-26  Akim Demaille  <akim@epita.fr>

	* src/state.h (state_t): `solved_conflicts' is a new member.
	* src/LR0.c (new_state): Set it to 0.
	* src/conflicts.h, src/conflicts.c (print_conflicts)
	(free_conflicts, solve_conflicts): Rename as...
	(conflicts_print, conflicts_free, conflicts_solve): these.
	Adjust callers.
	* src/conflicts.c (enum conflict_resolution_e)
	(solved_conflicts_obstack): New, used by...
	(log_resolution): this.
	Adjust to attach the conflict resolution to each state.
	Complete the description with the precedence/associativity
	information.
	(resolve_sr_conflict): Adjust.
	* src/print.c (print_state): Output its solved_conflicts.
	* tests/conflicts.at (Unresolved SR Conflicts)
	(Solved SR Conflicts): Exercise --report=all.

2002-05-26  Akim Demaille  <akim@epita.fr>

	* src/LR0.c, src/derives.c, src/gram.c, src/gram.h, src/lalr.c,
	* src/nullable.c, src/output.c, src/print.c, src/print_graph.c,
	* src/reader.c, src/reduce.c, src/state.h, src/symtab.h
	(token_number_t, item_number_as_token_number)
	(token_number_as_item_number, muscle_insert_token_number_table):
	Rename as...
	(symbol_number_t, item_number_as_symbol_number)
	(symbol_number_as_item_number, muscle_insert_symbol_number_table):
	these, since it is more appropriate.

2002-05-26  Akim Demaille  <akim@epita.fr>

	* tests/calc.at (AT_CHECK_CALC): Adjust: there are now additional
	`Error:' lines.
	* data/bison.simple (yystos) [YYDEBUG]: New.
	(yyparse) [YYDEBUG]: Display the symbols which are popped during
	error recovery.
	* tests/regression.at (Web2c Actions): Adjust: yystos is output now.

2002-05-25  Akim Demaille  <akim@epita.fr>

	* doc/bison.texinfo (Debugging): Split into...
	(Tracing): this new section, its former contents, and...
	(Understanding): this new section.
	* src/getargs.h, src/getargs.c (verbose_flag): Remove, replaced
	by...
	(report_flag): this.
	Adjust all dependencies.
	(report_args, report_types, report_argmatch): New.
	(usage, getargs): Report/support -r, --report.
	* src/options.h
	(struct option_table_struct): Rename as..,
	(struct option_table_s): this.
	Rename the `set_flag' member to `flag' to match with getopt_long's
	struct.
	* src/options.c (option_table): Split verbose into an entry for
	%verbose, and another for --verbose.
	Support --report/-r, so remove -r from the obsolete --raw.
	* src/print.c: Attach full item sets and lookaheads reports to
	report_flag instead of trace_flag.
	* lib/argmatch.h, lib/argmatch.c: New, from Fileutils 4.1.

2002-05-24  Paul Hilfinger  <Hilfinger@CS.Berkeley.EDU>
	and Paul Eggert  <eggert@twinsun.com>

	* data/bison.simple (yyparse): Correct error handling to conform to
	POSIX and yacc.  Specifically, after syntax error is discovered,
	do not reduce further before shifting the error token.
	Clean up the code a bit by removing the labels yyerrdefault,
	yyerrhandle, yyerrpop.
	* NEWS: Document the above.

2002-05-20  Paul Hilfinger  <Hilfinger@CS.Berkeley.EDU>

	* data/bison.simple (yyr1): Don't use yy_token_number_type as element
	type; it isn't always big enough, since it doesn't necessarily
	include non-terminals.
	(yytranslate): Expand definition of yy_token_number_type, so that
	the latter can be removed.
	(yy_token_number_type): Remove, only one use.
	* data/bison.c++ (r1_): Parallel change to yyr1 in bison.simple---
	don't use TokenNumberType as element type.

	* tests/regression.at: Modify expected output to agree with change
	to yyr1 and yytranslate.

2002-05-13  Florian Krohm  <florian@edamail.fishkill.ibm.com>

	* src/reader.c (parse_action): Use copy_character instead of
	obstack_1grow.

2002-05-13  Akim Demaille  <akim@epita.fr>

	* tests/regression.at (Token definitions): Prototype yylex and
	yyerror.

2002-05-12  Paul Hilfinger  <Hilfinger@CS.Berkeley.EDU>

	* src/scan-skel.l: Correct off-by-one error in handling of __oline__.
	* data/bison.simple (b4_sint_type, b4_uint_type): Correct to reflect
	32-bit arithmetic.
	* data/bison.c++ (b4_sint_type, b4_uint_type): Ditto.

2002-05-07  Akim Demaille  <akim@epita.fr>

	* tests/synclines.at: Be sure to prototype yylex and yyerror to
	avoid GCC warnings.

2002-05-07  Akim Demaille  <akim@epita.fr>

	Kill GCC warnings.

	* src/reduce.c (nonterminals_reduce): Don't loop over RITEM: loop
	over the RHS of each rule.
	* src/gram.h, src/gram.c (nritems): Is `unsigned int', not int.
	* src/state.h (state_t): Member `nitems' is unsigned short.
	* src/LR0.c (get_state): Adjust.
	* src/reader.c (packgram): Likewise.
	* src/output.c (GENERATE_MUSCLE_INSERT_TABLE): `max' is of type
	`Type'.
	(muscle_insert_int_table): Remove, unused.
	(prepare_rules): Remove `max'.

2002-05-06  Akim Demaille  <akim@epita.fr>

	* src/closure.c (print_firsts): Display of the symbol tags.
	(bitmatrix_print): Move to...
	* lib/bitsetv-print.h, lib/bitsetv-print.c (bitsetv_matrix_dump):
	here.
	* tests/sets.at (Nullable, Broken Closure, Firsts): Adjust.

2002-05-06  Akim Demaille  <akim@epita.fr>

	* src/muscle_tab.c (muscle_m4_output): Must return TRUE for
	hash_do_for_each.

2002-05-06  Akim Demaille  <akim@epita.fr>

	* src/LR0.c (new_state, get_state): Instead of using the global
	`kernel_size' and `kernel_base', have two new arguments:
	`core_size' and `core'.
	Adjust callers.

2002-05-06  Akim Demaille  <akim@epita.fr>

	* src/reader.c (packgram): No longer end `ritem' with a 0
	sentinel: it is not used.

2002-05-05  Akim Demaille  <akim@epita.fr>

	New experimental feature: display the lookaheads in the report and
	graph.

	* src/print (print_core): When --trace-flag, display the rules
	lookaheads.
	* src/print_graph.c (print_core): Likewise.
	Swap the arguments.
	Adjust caller.

2002-05-05  Akim Demaille  <akim@epita.fr>

	* tests/torture.at (Many lookaheads): New test.

2002-05-05  Akim Demaille  <akim@epita.fr>

	* src/output.c (GENERATE_OUTPUT_TABLE): Replace with...
	(GENERATE_MUSCLE_INSERT_TABLE): this.
	(output_int_table, output_unsigned_int_table, output_short_table)
	(output_token_number_table, output_item_number_table): Replace with...
	(muscle_insert_int_table, muscle_insert_unsigned_int_table)
	(muscle_insert_short_table, muscle_insert_token_number_table)
	(muscle_insert_item_number_table): these.
	Adjust all callers.
	(prepare_tokens): Don't free `translations', since...
	* src/reader.h, src/reader.c (grammar_free): do it.
	Move to...
	* src/gram.h, src/gram.c (grammar_free): here.
	* data/bison.simple, data/bison.c++: b4_token_number_max is now
	b4_translate_max.

2002-05-05  Akim Demaille  <akim@epita.fr>

	* src/output.c (output_unsigned_int_table): New.
	(prepare_rules): `i' is unsigned.
	`prhs', `rline', `r2' are unsigned int.
	Rename muscle `rhs_number_max' as `rhs_max'.
	Output muscles `prhs_max', `rline_max', and `r2_max'.
	Free rline and r1.
	* data/bison.simple, data/bison.c++: Adjust to use these muscles
	to compute types instead of constant types.
	* tests/regression.at (Web2c Actions): Adjust.

2002-05-04  Akim Demaille  <akim@epita.fr>

	* src/symtab.h (SALIAS, SUNDEF): Rename as...
	(USER_NUMBER_ALIAS, USER_NUMBER_UNDEFINED): these.
	Adjust dependencies.
	* src/output.c (token_definitions_output): Be sure not to output a
	`#define 'a'' when fed with `%token 'a' "a"'.
	* tests/regression.at (Token definitions): New.

2002-05-03  Paul Eggert  <eggert@twinsun.com>

	* data/bison.simple (b4_token_defines): Also define YYTOKENTYPE
	for K&R C.

2002-05-03  gettextize  <bug-gnu-gettext@gnu.org>

	* Makefile.am (SUBDIRS): Remove intl.
	(EXTRA_DIST): Add config/config.rpath.

2002-05-03  Akim Demaille  <akim@epita.fr>

	* data/bison.simple (m4_if): Don't output empty enums.
	And actually, output valid enum definitions :(.

2002-05-03  Akim Demaille  <akim@epita.fr>

	* configure.bat: Remove, completely obsolete.
	* Makefile.am (EXTRA_DIST): Adjust.
	Don't distribute config.rpath...
	* config/Makefile.am (EXTRA_DIST): Do it.

2002-05-03  Akim Demaille  <akim@epita.fr>

	* configure.in (GETTEXT_VERSION): New.
	Suggested by Bruno Haible for the forthcoming Gettext 0.10.3.

2002-05-03  Akim Demaille  <akim@epita.fr>

	* data/bison.simple (b4_token_enum): New.
	(b4_token_defines): Use it to output tokens both as #define and
	enums.
	Suggested by Paul Eggert.
	* src/output.c (token_definitions_output): Don't output spurious
	white spaces.

2002-05-03  Akim Demaille  <akim@epita.fr>

	* data/m4sugar/m4sugar.m4: Update from CVS Autoconf.

2002-05-02  Robert Anisko  <robert@lrde.epita.fr>

	* data/bison.c++: Adapt expansion of $s and @s to the C++ parser.
	Update the stack class, give a try to deque as the default container.

2002-05-02  Akim Demaille  <akim@epita.fr>

	* data/bison.simple (yyparse): Do not implement @$ = @1.
	(YYLLOC_DEFAULT): Adjust to do it.
	* doc/bison.texinfo (Location Default Action): Fix.

2002-05-02  Akim Demaille  <akim@epita.fr>

	* src/reader.c (parse_braces): Merge into...
	(parse_action): this.

2002-05-02  Akim Demaille  <akim@epita.fr>

	* configure.in (ALL_LINGUAS): Remove.
	* po/LINGUAS, hr.po: New.

2002-05-02  Akim Demaille  <akim@epita.fr>

	Remove the so called hairy (semantic) parsers.

	* src/system.h (EXT_GUARD_C, EXT_STYPE_H): Remove.
	* src/gram.h, src/gram.c (semantic_parser): Remove.
	(rule_t): Remove the guard and guard_line members.
	* src/lex.h (token_t): remove tok_guard.
	* src/options.c (option_table): Remove %guard and %semantic_parser
	support.
	* src/output.c, src/output.h (guards_output): Remove.
	(prepare): Adjust.
	(token_definitions_output): Don't output the `T'
	tokens (???).
	(output_skeleton): Don't output the guards.
	* src/files.c, src/files.c (attrsfile): Remove.
	* src/reader.c (symbol_list): Remove the guard and guard_line
	members.
	Adjust dependencies.
	(parse_guard): Remove.
	* data/bison.hairy: Remove.
	* doc/bison.texinfo (Environment Variables): Remove occurrences of
	BISON_HAIRY.

2002-05-02  Akim Demaille  <akim@epita.fr>

	* src/reader.c (copy_at, copy_dollarm parse_braces, parse_action)
	(parse_guard): Rename the formal argument `stack_offset' as
	`rule_length', which is more readable.
	Adjust callers.
	(copy_at, copy_dollar): Instead of outputting the hard coded
	values of $$, $n and so forth, output invocation to b4_lhs_value,
	b4_lhs_location, b4_rhs_value, and b4_rhs_location.
	Note: this patch partially drops `semantic-parser' support: it
	always does `rule_length - n', where semantic parsers ought to
	always use `-n'.
	* data/bison.simple, data/bison.c++ (b4_lhs_value)
	(b4_lhs_location, b4_rhs_value, and b4_rhs_location: New.

2002-05-02  Akim Demaille  <akim@epita.fr>

	* configure.in (AC_INIT): Bump to 1.49b.
	(AM_INIT_AUTOMAKE): Short invocation.

2002-05-02  Akim Demaille  <akim@epita.fr>

	Version 1.49a.

2002-05-01  Akim Demaille  <akim@epita.fr>

	* src/skeleton.h: Remove.

2002-05-01  Akim Demaille  <akim@epita.fr>

	* src/skeleton.h: Fix the #endif.
	Reported by Magnus Fromreide.

2002-04-26  Paul Eggert  <eggert@twinsun.com>

	* data/bison.simple (YYSTYPE_IS_TRIVIAL, YYLTYPE_IS_TRIVIAL):
	Define if we define YYSTYPE and YYLTYPE, respectively.
	(YYCOPY): Fix [] quoting problem in the non-GCC case.

2002-04-25  Robert Anisko  <robert@lrde.epita.fr>

	* src/scan-skel.l: Postprocess quadrigraphs.

	* src/reader.c (copy_character): New function, used to output
	single characters while replacing `[' and `]' with quadrigraphs, to
	avoid troubles with M4 quotes.
	(copy_comment): Output characters with copy_character.
	(read_additionnal_code): Likewise.
	(copy_string2): Likewise.
	(copy_definition): Likewise.

	* tests/calc.at: Exercise M4 quoting.

2002-04-25  Akim Demaille  <akim@epita.fr>

	* tests/sets.at (AT_EXTRACT_SETS): Sed portability issue: no space
	between `!' and the command.
	Reported by Paul Eggert.

2002-04-24  Robert Anisko  <robert@lrde.epita.fr>

	* tests/calc.at: Exercise prologue splitting.

	* data/bison.simple, data/bison.c++: Use `b4_pre_prologue' and
	`b4_post_prologue' instead of `b4_prologue'.

	* src/output.c (prepare): Add the `pre_prologue' and `post_prologue'
	muscles.
	(output): Free pre_prologue_obstack and post_prologue_obstack.
	* src/files.h, src/files.c (attrs_obstack): Remove.
	(pre_prologue_obstack, post_prologue_obstack): New.
	* src/reader.c (copy_definition): Add a parameter to specify the
	obstack to fill, instead of using attrs_obstack unconditionally.
	(read_declarations): Pass pre_prologue_obstack to copy_definition if
	`%union' has not yet been seen, pass post_prologue_obstack otherwise.

2002-04-23  Paul Eggert  <eggert@twinsun.com>

	* data/bison.simple: Remove unnecessary commentary and white
	space differences from 1_29-branch.
	Depend on YYERROR_VERBOSE, not defined (YYERROR_VERBOSE).

	(union yyalloc, YYSTACK_GAP_MAX, YYSTACK_BYTES, YYCOPY,
	YYSTACK_RELOCATE): Do not define if yyoverflow is defined, or
	if this is a C++ parser and YYSTYPE or YYLTYPE has nontrivial
	constructors or destructors.

	(yyparse) [! defined YYSTACK_RELOCATE]: Do not relocate the stack.

2002-04-23  Akim Demaille  <akim@epita.fr>

	* tests/sets.at (AT_EXTRACT_SETS): Don't use 8 char long sed labels.
	* tests/synclines.at (AT_TEST_SYNCLINE): Be robust to GCC's
	location with columns.
	* tests/conflicts.at (%nonassoc and eof): Don't use `error.h'.
	All reported by Paul Eggert.

2002-04-22  Akim Demaille  <akim@epita.fr>

	* src/reduce.c (dump_grammar): Move to...
	* src/gram.h, src/gram.c (grammar_dump): here.
	Be sure to separate long item numbers.
	Don't read the members of a rule's prec if its nil.

2002-04-22  Akim Demaille  <akim@epita.fr>

	* src/output.c (table_size, table_grow): New.
	(MAXTABLE): Remove, replace uses with table_size.
	(pack_vector): Instead of dying when the table is too big, grow it.

2002-04-22  Akim Demaille  <akim@epita.fr>

	* data/bison.simple (yyr1): Its type is that of a token number.
	* data/bison.c++ (r1_): Likewise.
	* tests/regression.at (Web2c Actions): Adjust.

2002-04-22  Akim Demaille  <akim@epita.fr>

	* src/reader.c (token_translations_init): 256 is now the default
	value for the error token, i.e., it will be assigned another
	number if the user assigned 256 to one of her tokens.
	(reader): Don't force 256 to error.
	* doc/bison.texinfo (Symbols): Adjust.
	* tests/torture.at (AT_DATA_HORIZONTAL_GRAMMAR)
	(AT_DATA_TRIANGULAR_GRAMMAR): Number the tokens as 1, 2, 3
	etc. instead of 10, 20, 30 (which was used to `jump' over error
	(256) and undefined (2)).

2002-04-22  Akim Demaille  <akim@epita.fr>

	Propagate more token_number_t.

	* src/gram.h (token_number_as_item_number)
	(item_number_as_token_number): New.
	* src/output.c (GENERATE_OUTPUT_TABLE): New.
	Use it to create output_item_number_table and
	output_token_number_table.
	* src/LR0.c, src/derives.c, src/gram.c, src/gram.h, src/lalr.c,
	* src/lex.c, src/nullable.c, src/output.c, src/print.c,
	* src/print_graph.c, src/reader.c, src/reduce.c, src/state.h,
	* src/symtab.c, src/symtab.h: Use token_number_t instead of shorts.

2002-04-22  Akim Demaille  <akim@epita.fr>

	* src/output.h, src/output.c (get_lines_number): Remove.

2002-04-19  Akim Demaille  <akim@epita.fr>

	* doc/bison.texinfo (Actions): Make clear that `|' is not the same
	as Lex/Flex'.
	(Debugging): More details about enabling the debugging features.
	(Table of Symbols): Describe $$, $n, @$, and @n.
	Suggested by Tim Josling.

2002-04-19  Akim Demaille  <akim@epita.fr>

	* doc/bison.texinfo: Remove the uses of the obsolete @refill.

2002-04-10  Akim Demaille  <akim@epita.fr>

	* src/system.h: Rely on HAVE_LIMITS_H.
	Suggested by Paul Eggert.

2002-04-09  Akim Demaille  <akim@epita.fr>

	* tests/calc.at (_AT_CHECK_CALC_ERROR): Receive as argument the
	full stderr, and strip it according to the bison options, instead
	of composing the error message from different bits.
	This makes it easier to check for several error messages.
	Adjust all the invocations.
	Add an invocation exercising the error token.
	Add an invocation demonstrating a stupid error message.
	(_AT_DATA_CALC_Y): Follow the GCS: initial column is 1, not 0.
	Adjust the tests.
	Error message are for stderr, not stdout.

2002-04-09  Akim Demaille  <akim@epita.fr>

	* src/gram.h, src/gram.c (error_token_number): Remove, use
	errtoken->number.
	* src/reader.c (reader): Don't specify the user token number (2)
	for $undefined, as it uselessly prevents using it.
	* src/gram.h (token_number_t): Move to...
	* src/symtab.h: here.
	(state_t.number): Is a token_number_t.
	* src/print.c, src/reader.c: Use undeftoken->number instead of
	hard coded 2.
	(Even though this 2 is not the same as above: the number of the
	undeftoken remains being 2, it is its user token number which
	might not be 2).
	* src/output.c (prepare_tokens): Rename the `maxtok' muscle with
	`user_token_number_max'.
	Output `undef_token_number'.
	* data/bison.simple, data/bison.c++: Use them.
	Be sure to map invalid yylex return values to
	`undef_token_number'.  This saves us from gratuitous SEGV.

	* tests/conflicts.at (Solved SR Conflicts)
	(Unresolved SR Conflicts): Adjust.
	* tests/regression.at (Web2c Actions): Adjust.

2002-04-08  Akim Demaille  <akim@epita.fr>

	* data/bison.c++: s/b4_item_number_max/b4_rhs_number_max/.
	Adding #line.
	Remove the duplicate `typedefs'.
	(RhsNumberType): Fix the declaration and various other typos.
	Use __ofile__.
	* data/bison.simple: Use __ofile__.
	* src/scan-skel.l: Handle __ofile__.

2002-04-08  Akim Demaille  <akim@epita.fr>

	* src/gram.h (item_number_t): New, the type of item numbers in
	RITEM.  Note that it must be able to code symbol numbers as
	positive number, and the negation of rule numbers as negative
	numbers.
	Adjust all dependencies (pretty many).
	* src/reduce.c (rule): Remove this `short *' pointer: use
	item_number_t.
	* src/system.h (MINSHORT, MAXSHORT): Remove.
	Include `limits.h'.
	Adjust dependencies to using SHRT_MAX and SHRT_MIN.
	(shortcpy): Remove.
	(MAXTABLE): Move to...
	* src/output.c (MAXTABLE): here.
	(prepare_rules): Use output_int_table to output rhs.
	* data/bison.simple, data/bison.c++: Adjust.
	* tests/torture.at (Big triangle): Move the limit from 254 to
	500.
	* tests/regression.at (Web2c Actions): Ajust.

	Trying with bigger grammars shows various phenomena: at 3000 (28Mb
	of grammar file) bison is killed by my system, at 2000 (12Mb) bison
	passes, but produces negative #line number, once fixed, GCC is
	killed while compiling 14Mb, at 1500 (6.7 Mb of grammar, 8.2Mb of
	C), it passes.
	* src/state.h (state_h): Code input lines on ints, not shorts.

2002-04-08  Akim Demaille  <akim@epita.fr>

	* src/reduce.c (reduce_grammar): First reduce the nonterminals,
	and then the grammar.

2002-04-08  Akim Demaille  <akim@epita.fr>

	* src/system.h: No longer using strndup.

2002-04-07  Akim Demaille  <akim@epita.fr>

	* src/muscle_tab.h (MUSCLE_INSERT_LONG_INT): New.
	* src/output.c (output_table_data): Return the longest number.
	(prepare_tokens): Output `token_number_max').
	* data/bison.simple, data/bison.c++ (b4_sint_type, b4_uint_type):
	New.
	Use them to define yy_token_number_type/TokenNumberType.
	Use this type for yytranslate.
	* tests/torture.at (Big triangle): Push the limit from 124 to
	253.
	* tests/regression.at (Web2c Actions): Adjust.

2002-04-07  Akim Demaille  <akim@epita.fr>

	* tests/torture.at (Big triangle): New.
	(GNU AWK Grammar, GNU Cim Grammar): Move to...
	* tests/existing.at: here.

2002-04-07  Akim Demaille  <akim@epita.fr>

	* src/gram.h, src/gram.c (nitems): Remove, it is an alias of
	nritems.
	Adjust dependencies.

2002-04-07  Akim Demaille  <akim@epita.fr>

	* src/reader.c: Normalize increments to prefix form.

2002-04-07  Akim Demaille  <akim@epita.fr>

	* src/reader.c, symtab.c: Remove debugging code.

2002-04-07  Akim Demaille  <akim@epita.fr>

	Rename all the `bucket's as `symbol_t'.

	* src/gram.c, src/gram.h, src/lex.c, src/lex.h, src/output.c,
	* src/reader.c, src/reader.h, src/reduce.c, src/state.h,
	* src/symtab.c, src/symtab.h (bucket): Rename as...
	(symbol_t): this.
	(symbol_list_new, bucket_check_defined, bucket_make_alias)
	(bucket_check_alias_consistence, bucket_pack, bucket_translation)
	(bucket_new, bucket_free, hash_compare_bucket, hash_bucket)
	(buckets_new, buckets_free, buckets_do): Rename as...
	(symbol_list_new, symbol_check_defined, symbol_make_alias)
	(symbol_check_alias_consistence, symbol_pack, symbol_translation)
	(symbol_new, symbol_free, hash_compare_symbol_t, hash_symbol_t)
	(symbols_new, symbols_free, symbols_do): these.

2002-04-07  Akim Demaille  <akim@epita.fr>

	Use lib/hash for the symbol table.

	* src/gram.c (ntokens): Initialize to 1, to reserve a slot for
	EOF.
	* src/lex.c (lex): Set the `number' member of new terminals.
	* src/reader.c (bucket_check_defined, bucket_make_alias)
	(bucket_check_alias_consistence, bucket_translation): New.
	(reader, grammar_free, readgram, token_translations_init)
	(packsymbols): Adjust.
	(reader): Number the predefined tokens.
	* src/reduce.c (inaccessable_symbols): Just use hard coded numbers
	for predefined tokens.
	* src/symtab.h (bucket): Remove all the hash table related
	members.
	* src/symtab.c (symtab): Replace by...
	(bucket_table): this.
	(bucket_new, bucket_free, hash_compare_bucket, hash_bucket)
	(buckets_new, buckets_do): New.

2002-04-07  Akim Demaille  <akim@epita.fr>

	* src/gram.c (nitems, nrules, nsyms, ntokens, nvars, nritems)
	(start_symbol, max_user_token_number, semantic_parser)
	(error_token_number): Initialize.
	* src/reader.c (grammar, start_flag, startval, typed, lastprec):
	Initialize.
	(reader): Don't.
	(errtoken, eoftoken, undeftoken, axiom): Extern.

2002-04-07  Akim Demaille  <akim@epita.fr>

	* src/gram.h (rule_s): prec and precsym are now pointers
	to the bucket giving the priority/associativity.
	Member `associativity' removed: useless.
	* src/reduce.c, src/conflicts.c: Adjust.

2002-04-07  Akim Demaille  <akim@epita.fr>

	* src/lalr.c, src/LR0.c, src/closure.c, src/gram.c, src/reduce.c:
	Properly escape the symbols' TAG when outputting them.

2002-04-07  Akim Demaille  <akim@epita.fr>

	* src/lalr.h (LA): Is a bitsetv, not bitset*.

2002-04-07  Akim Demaille  <akim@epita.fr>

	* src/lalr.h, src/lalr.c (LAruleno): Replace with...
	(LArule): this, which is an array to rule_t*.
	* src/print.c, src/conflicts.c: Adjust.

2002-04-07  Akim Demaille  <akim@epita.fr>

	* src/gram.h (rule_t): Rename `number' as `user_number'.
	`number' is a new member.
	Adjust dependencies.
	* src/reduce.c (reduce_grammar_tables): Renumber rule_t.number.

2002-04-07  Akim Demaille  <akim@epita.fr>

	As a result of the previous patch, it is no longer needed
	to reorder ritem itself.

	* src/reduce.c (reduce_grammar_tables): Don't sort RITEM.

2002-04-07  Akim Demaille  <akim@epita.fr>

	Be sure never to walk through RITEMS, but use only data related to
	the rules themselves. RITEMS should be banished.

	* src/output.c (output_token_translations): Rename as...
	(prepare_tokens): this.
	In addition to `translate', prepare the muscles `tname' and
	`toknum', which were handled by...
	(output_rule_data): this.
	Remove, and move the remainder of its outputs into...
	(prepare_rules): this new routines, which also merges content from
	(output_gram): this.
	(prepare_rules): Be sure never to walk through RITEMS.
	(output_stos): Rename as...
	(prepare_stos): this.
	(output): Always invoke prepare_states, after all, just don't use it
	in the output if you don't need it.

2002-04-07  Akim Demaille  <akim@epita.fr>

	* src/LR0.c (new_state): Display `nstates' as the name of the
	newly created state.
	Adjust to initialize first_state and last_state if needed.
	Be sure to distinguish the initial from the final state.
	(new_states): Create the itemset of the initial state, and use
	new_state.
	* src/closure.c (closure): Now that the initial state has its
	items properly set, there is no need for a special case when
	creating `ruleset'.

	As a result, now the rule 0, reducing to $axiom, is visible in the
	outputs.  Adjust the test suite.

	* tests/conflicts.at (Solved SR Conflicts)
	(Unresolved SR Conflicts): Adjust.
	* tests/regression.at (Web2c Report, Rule Line Numbers): Idem.
	* tests/conflicts.at (S/R in initial): New.

2002-04-07  Akim Demaille  <akim@epita.fr>

	* src/LR0.c (allocate_itemsets): Don't loop over ritem: loop over
	the RHS of the rules.
	* src/output.c (output_gram): Likewise.

2002-04-07  Akim Demaille  <akim@epita.fr>

	* src/gram.h (rule_t): `lhs' is now a pointer to the symbol's
	bucket.
	Adjust all dependencies.
	* src/reduce.c (nonterminals_reduce): Don't forget to renumber the
	`number' of the buckets too.
	* src/gram.h: Include `symtab.h'.
	(associativity): Move to...
	* src/symtab.h: here.
	No longer include `gram.h'.

2002-04-07  Akim Demaille  <akim@epita.fr>

	* src/gram.h, src/gram.c (rules_rhs_length): New.
	(ritem_longest_rhs): Use it.
	* src/gram.h (rule_t): `number' is a new member.
	* src/reader.c (packgram): Set it.
	* src/reduce.c (reduce_grammar_tables): Move the useless rules at
	the end of `rules', and count them out of `nrules'.
	(reduce_output, dump_grammar): Adjust.
	* src/print.c (print_grammar): It is no longer needed to check for
	the usefulness of a rule, as useless rules are beyond `nrules + 1'.
	* tests/reduce.at (Reduced Automaton): New test.

2002-04-07  Akim Demaille  <akim@epita.fr>

	* src/reduce.c (inaccessable_symbols): Fix a buglet: because of a
	lacking `+ 1' to nrules, Bison reported as useless a token if it
	was used solely to set the precedence of the last rule...

2002-04-07  Akim Demaille  <akim@epita.fr>

	* data/bison.c++, data/bison.simple: Don't output the current file
	name in #line, to avoid useless diffs between two identical
	outputs under different names.

2002-04-07  Akim Demaille  <akim@epita.fr>

	* src/closure.c, src/print.c, src/reader.c, src/reduce.c:
	Normalize loops to using `< nrules + 1', not `<= nrules'.

2002-04-07  Akim Demaille  <akim@epita.fr>

	* TODO: Update.

2002-04-07  Akim Demaille  <akim@epita.fr>

	* src/output.c, src/reader.c, src/symtab.c, src/symtab.h: Rename
	bucket.value as bucket.number.

2002-04-07  Akim Demaille  <akim@epita.fr>

	* src/closure.c, src/derives.c, src/gram.h, src/lalr.c,
	* src/nullable.c, src/output.c, src/print.c, src/print_graph.c,
	* src/reader.c, src/reduce.c: Let rule_t.rhs point directly to the
	RHS, instead of being an index in RITEMS.

2002-04-04  Paul Eggert  <eggert@twinsun.com>

	* doc/bison.texinfo: Update copyright date.
	(Rpcalc Lexer, Symbols, Token Decl): Don't assume ASCII.
	(Symbols): Warn about running Bison in one character set,
	but compiling and/or running in an incompatible one.
	Warn about character code 256, too.

2002-04-03  Paul Eggert  <eggert@twinsun.com>

	* src/bison.data (YYSTACK_ALLOC): Depend on whether
	YYERROR_VERBOSE is nonzero, not whether it is defined.

	Merge changes from bison-1_29-branch.

2002-03-20  Paul Eggert  <eggert@twinsun.com>

	Merge fixes from Debian bison_1.34-1.diff.

	* configure.in (AC_PREREQ): 2.53.

2002-03-20  Akim Demaille  <akim@epita.fr>

	* src/conflicts.c (log_resolution): Argument `resolution' is const.

2002-03-19  Paul Eggert  <eggert@twinsun.com>

	* src/bison.simple (YYCOPY): New macro.
	(YYSTACK_RELOCATE): Use it.
	Remove Type arg; no longer needed.  All callers changed.
	(yymemcpy): Remove; no longer needed.

	* Makefile.am (AUTOMAKE_OPTIONS): 1.6.
	* doc/Makefile.am (AUTOMAKE_OPTIONS): Remove.

2002-03-19  Akim Demaille  <akim@epita.fr>

	Test and fix the #line outputs.

	* tests/atlocal.at (GCC): New.
	* tests/synclines.at (AT_TEST_SYNCLINE): New macro.
	(Prologue synch line, ,%union synch line, Postprologue synch line)
	(Action synch line, Epilogue synch line): New tests.
	* src/reader.c (parse_union_decl): Define the muscle stype_line.
	* data/bison.simple, data/bison.c++: Use it.

2002-03-19  Akim Demaille  <akim@epita.fr>

	* tests/regression.at (%nonassoc and eof, Unresolved SR Conflicts)
	(Solved SR Conflicts, %expect not enough, %expect right)
	(%expect too much): Move to...
	* tests/conflicts.at: this new file.

2002-03-19  Akim Demaille  <akim@epita.fr>

	* data/m4sugar/m4sugar.m4: Update from CVS Autoconf.
	* data/bison.simple, data/bison.c++: Handle the `#define' part, so
	that we can move to enums for instance.
	* src/output.c (token_definitions_output): Output a list of
	`token-name, token-number' instead of the #define.
	(output_skeleton): Name this list `b4_tokens', not `b4_tokendefs'.

2002-03-14  Akim Demaille  <akim@epita.fr>

	Use Gettext 0.11.1.

2002-03-09  Robert Anisko  <robert@lrde.epita.fr>

	* data/bison.c++: Make the user able to add members to the generated
	parser by subclassing.

2002-03-05  Robert Anisko  <robert@lrde.epita.fr>

	* src/reader.c (read_additionnal_code): `c' should be an integer, not
	a character.
	Reported by Nicolas Tisserand and Nicolas Burrus.

2002-03-04  Robert Anisko  <robert@lrde.epita.fr>

	* src/reader.c: Warn about lacking semi-colons, do not complain.

2002-03-04  Robert Anisko  <robert@lrde.epita.fr>

	* data/bison.c++: Remove a debug line.

2002-03-04  Robert Anisko  <robert@lrde.epita.fr>

	* data/bison.c++: Unmerge value as yylval and value as yyval.  Unmerge
	location as yylloc and location as yyloc.  Use YYLLOC_DEFAULT, and
	provide a default implementation.

2002-03-04  Akim Demaille  <akim@epita.fr>

	* tests/input.at (Invalid $n, Invalid @n): Add the ending `;'.
	* tests/output.at (AT_CHECK_OUTPUT): Likewise.
	* tests/headers.at (AT_TEST_CPP_GUARD_H): Ditto.
	* tests/semantic.at (Parsing Guards): Similarly.
	* src/reader.at (readgram): Complain if the last rule is not ended
	with a semi-colon.

2002-03-04  Akim Demaille  <akim@epita.fr>

	* src/warshall.h, src/warshall.c (bitmatrix_print): Move to...
	* src/closure.c: here.
	(set_firsts): Use bitsetv_reflexive_transitive_closure instead of
	RTC.
	* src/warshall.h, src/warshall.c: Remove.
	* tests/sets.at (Broken Closure): Adjust.

2002-03-04  Akim Demaille  <akim@epita.fr>

	* src/output.c (output_skeleton): tempdir is const.
	bytes_read is unused.

2002-03-04  Akim Demaille  <akim@epita.fr>

	* lib/bbitset.h, lib/bitset.c, lib/bitset.h, lib/bitsetv.c,
	* lib/bitsetv.h, lib/ebitset.c, lib/lbitset.c, lib/sbitset.c:
	Update.
	From Michael Hayes.

2002-03-04  Akim Demaille  <akim@epita.fr>

	* src/closure.c (closure): `r' is unused.

2002-03-04  Akim Demaille  <akim@epita.fr>

	* tests/sets.at (Broken Closure): Add the ending `;'.
	* src/reader.at (readgram): Complain if a rule is not ended with a
	semi-colon.

2002-03-04  Akim Demaille  <akim@epita.fr>

	* src/conflicts.c (set_conflicts): Use bitset_disjoint_p.
	(count_sr_conflicts): Use bitset_count.
	* src/reduce.c (inaccessable_symbols): Ditto.
	(bits_size): Remove.
	* src/warshall.h, src/warshall.c: Convert to bitsetv.

2002-03-04  Akim Demaille  <akim@epita.fr>

	* src/closure.c, src/conflicts.c, src/lalr.c, src/print.c,
	* src/reduce.c: Remove the `bitset_zero's following the
	`bitset_create's, as now it is performed by the latter.

2002-03-04  Akim Demaille  <akim@epita.fr>

	* lib/bitset.c, lib/bitset.h, lib/bitsetv.c, lib/bitsetv.h,
	* lib/ebitset.c, lib/ebitset.h, lib/lbitset.c, lib/lbitset.h,
	* lib/sbitset.c, lib/sbitset.h, lib/bbitset.h: Update from the
	latest sources from Michael.

2002-03-04  Akim Demaille  <akim@epita.fr>

	* src/output.c (output): Don't free the grammar.
	* src/reader.c (grammar_free): New.
	* src/main.c (main): Call it and don't free symtab here.

2002-03-04  Akim Demaille  <akim@epita.fr>

	* src/lex.c (parse_percent_token): Be sure to 0-end token_buffer
	before returning.
	Reported by Benoit Perrot.

2002-03-04  Akim Demaille  <akim@epita.fr>

	Use bitset operations when possible, not loops over bits.

	* src/conflicts.c (set_conflicts, count_sr_conflicts): Use
	bitset_or.
	* src/print.c (print_reductions): Use bitset_and, bitset_andn.
	* src/reduce.c (useless_nonterminals): Formatting changes.
	* src/warshall.c (TC): Use bitset_or.

2002-03-04  Akim Demaille  <akim@epita.fr>

	* src/lalr.h, src/lalr.c (tokensetsize): Remove, unused.
	* src/system.h (BITS_PER_WORD, WORDSIZE, SETBIT, RESETBIT, BITISSET):
	Ditto.

2002-03-04  Akim Demaille  <akim@epita.fr>

	* src/lalr.c (F): Now a bitset*.
	Adjust all dependencies.

2002-03-04  Akim Demaille  <akim@epita.fr>

	* src/conflicts.c (shiftset, lookaheadset): Now bitset.
	Adjust all dependencies.

2002-03-04  Akim Demaille  <akim@epita.fr>

	* src/L0.c, src/LR0.h (nstates): Be size_t.
	Adjust comparisons (signed vs unsigned).
	* src/conflics.c, src/lalr.c, src/lalr.h, src/output.c (LA): Now a
	bitset*.
	Adjust all dependencies.

2002-03-04  Akim Demaille  <akim@epita.fr>

	* src/closure.c (firsts): Now, also a bitset.
	Adjust all dependencies.
	(varsetsize): Remove, now unused.
	* src/warshall.h, src/warshall.c: Now work on arrays of bitsets.

2002-03-04  Akim Demaille  <akim@epita.fr>

	* src/print.c: Convert to use bitset.h, not hand coded iterations
	over ints.

2002-03-04  Akim Demaille  <akim@epita.fr>

	* src/reduce.c: Convert to use bitset.h, not hand coded BSet.

2002-03-04  Akim Demaille  <akim@epita.fr>

	* src/closure.c (ruleset): Be a bitset.
	(rulesetsize): Remove.

2002-03-04  Akim Demaille  <akim@epita.fr>

	* lib/bitset-int.h, lib/bitset.c, lib/bitset.h, lib/bitsetv.c,
	* lib/bitsetv.h, lib/ebitset.c, lib/ebitset.h, lib/lbitset.c,
	* lib/lbitset.h, lib/sbitset.c, lib/sbitset.h: New.
	* src/closure.c (fderives): Be an array of bitsets.

2002-02-28  Robert Anisko  <robert@lrde.epita.fr>

	* data/bison.c++: Merge the two generated headers.  Insert a copyright
	notice in each output file.

2002-02-28  Akim Demaille  <akim@epita.fr>

	* data/bison.c++: Copy the prologue of bison.simple to fetch
	useful M4 definitions, such as b4_header_guard.

2002-02-25  Akim Demaille  <akim@epita.fr>

	* src/getargs.c (version): Give the name of the authors, and use a
	translator friendly scheme for the bgr
	copyright notice.

2002-02-25  Akim Demaille  <akim@epita.fr>

	* src/output.c (header_output): Remove, now handled completely via
	M4.

2002-02-25  Akim Demaille  <akim@epita.fr>

	* m4/m4.m4: New, from CVS Autoconf.
	* configure.in: Invoke it.
	* src/output.c (output_skeleton): Use its result instead of the
	hard coded name.

2002-02-25  Akim Demaille  <akim@epita.fr>

	* lib/tempname.c, lib/mkstemp.c, m4/mkstemp.m4: New, stolen from
	Fileutils 4.1.5.
	* configure.in: Invoke UTILS_FUNC_MKSTEMP.
	* src/output.c (output_skeleton): Use mkstemp to create a real
	temporary file.
	Move the filling of `skeleton' and its muscle to...
	(prepare): here.
	(output): Move the definition of the prologue muscle to...
	(prepare): here.
	* src/system.h (DEFAULT_TMPDIR): New.

2002-02-14  Paul Eggert  <eggert@twinsun.com>

	Remove the support for C++ namespace cleanliness; it was
	causing more problems than it was curing, since it didn't work
	properly on some nonstandard C++ compilers.  This can wait
	for a proper C++ parser.

	* NEWS: Document this.
	* doc/bison.texinfo (Bison Parser, Debugging): Remove special mention
	of C++, as it's treated like C now.
	* src/bison.simple (YYSTD): Remove.
	(YYSIZE_T, YYFPRINTF, YYPARSE_PARAM_ARG, YYPARSE_PARAM_DECL):
	Treat C++ just like Standard C instead of trying to support
	namespace cleanliness.

2002-02-14  Akim Demaille  <akim@epita.fr>

	* tests/regression.at (else): Adjust to Andreas' change.

2002-02-14  Akim Demaille  <akim@epita.fr>

	* lib/Makefile.am (EXTRA_DIST): Ship strnlen.c.

2002-02-13  Andreas Schwab  <schwab@suse.de>

	* src/output.c (output_rule_data): Don't output NULL, it might
	not be defined yet.

2002-02-11  Robert Anisko  <robert@lrde.epita.fr>

	* data/bison.c++ (YYDEBUG, YYERROR_VERBOSE): After the prologue.
	(Copyright notice): Update.

2002-02-11  Akim Demaille  <akim@epita.fr>

	* tests/regression.at (%nonassoc and eof): Don't include
	nonportable headers.

2002-02-08  Robert Anisko  <robert@lrde.epita.fr>

	* data/bison.c++: Correct error recovery.  Make the user able to
	initialize the starting location.

2002-02-07  Akim Demaille  <akim@epita.fr>

	* tests/input.at: New.

2002-02-07  Robert Anisko  <robert@lrde.epita.fr>

	* data/bison.c++: Replace some direct m4 expansions by constants.  Be
	more consistent when naming methods and variables.  Put preprocessor
	directives around tables only needed for debugging.

2002-02-07  Robert Anisko  <robert@lrde.epita.fr>

	* data/bison.c++ (yy::b4_name::print_): New method, replaces yyprint in
	C++ parsers.
	(yy::b4_name::parse): Use print_.

2002-02-07  Robert Anisko  <robert@lrde.epita.fr>

	* data/bison.c++ (yy::b4_name::parse): Error recovery is back.

2002-02-07  Robert Anisko  <robert@lrde.epita.fr>

	* data/bison.c++ (yy::b4_name::error_): New method, replaces yyerror in
	C++ parsers.
	(yy::b4_name::parse): Build verbose error messages, and use error_.

2002-02-06  Robert Anisko  <robert@lrde.epita.fr>

	* data/bison.c++: Fix m4 quoting in comments.

2002-02-06  Robert Anisko  <robert@lrde.epita.fr>

	* data/bison.c++: Adjust the parser code.  Fix some muscles that were
	not expanded by m4.

2002-02-05  Akim Demaille  <akim@epita.fr>

	* data/bison.c++: Adjust to the M4 back end.
	More is certainly needed.

2002-02-05  Akim Demaille  <akim@epita.fr>

	Give a try to M4 as a back end.

	* lib/readpipe.c: New, from wdiff.
	* src/Makefile.am (DEFS): Define PKGDATADIR, not BISON_SIMPLE and
	BISON_HAIRY.
	* src/system.h (BISON_HAIRY, BISON_SIMPLE): Remove the DOS and VMS
	specific values.  Now it is m4 that performs the lookup.
	* src/parse-skel.y: Remove.
	* src/muscle_tab.c, src/muscle_tab.h (muscles_m4_output): New.
	* src/output.c (actions_output, guards_output)
	(token_definitions_output): No longer keeps track of the output
	line number, hence remove the second argument.
	(guards_output): Check against the guard member of a rule, not the
	action member.
	Adjust callers.
	(output_skeleton): Don't look for the skeleton location, let m4 do
	that.
	Create `/tmp/muscles.m4'.  This is temporary, a proper temporary
	file will be used.
	Invoke `m4' on m4sugar.m4, muscles.m4, and the skeleton.
	(prepare): Given that for the time being changesyntax is not
	usable in M4, rename the muscles using `-' to `_'.
	Define `defines_flag', `output_parser_name' and `output_header_name'.
	* src/output.h (actions_output, guards_output)
	(token_definitions_output): Adjust prototypes.
	* src/scan-skel.l: Instead of scanning the skeletons, it now
	processes the output of m4: `__oline__' and `#output'.
	* data/bison.simple: Adjust to be used by M4(sugar).
	* tests/Makefile.am: Use check_SCRIPTS to make sure `bison' is up
	to date.
	* tests/bison.in: Use the secrete envvar `BISON_PKGDATADIR'
	instead of the dead `BISON_SIMPLE' and `BISON_HAIRY'.
	* data/m4sugar/m4sugar.m4, data/m4sugar/version.m4: New,
	shamelessly stolen from CVS Autoconf.

2002-02-05  Akim Demaille  <akim@epita.fr>

	* lib/hash.c, lib/hash.h: Replace with Fileutils 4.1's version.
	* configure.in: Check for the declarations of free and malloc.
	* src/muscle_tab.c: Adjust.

2002-02-05  Akim Demaille  <akim@epita.fr>

	* src/muscle_tab.c (muscle_init): Don't default to NULL muscle
	which have no values.

2002-02-05  Akim Demaille  <akim@epita.fr>

	* src/bison.simple, src/bison.hairy, src/bison.c++: Move to...
	* data/: here.

2002-01-29  Paul Eggert  <eggert@twinsun.com>

	* src/bison.simple (YYSIZE_T): Do not define merely because
	YYSTACK_USE_ALLOCA is nonzero or alloca or _ALLOCA_H are defined.
	On some platforms, <alloca.h> does not declare YYSTD (size_t).

2002-01-27  Akim Demaille  <akim@epita.fr>

	Fix `%nonassoc and eof'.

	* src/state.c (errs_dup): Aaaah!  The failure was due to bytes
	which were not properly copied!  Replace
	memcpy (res->errs, src->errs, src->nerrs);
	with
	memcpy (res->errs, src->errs, src->nerrs * sizeof (src->errs[0]));
	!!!
	* tests/regression.at (%nonassoc and eof): Adjust to newest
	Autotest: `.' is not in the PATH.

2002-01-27  Akim Demaille  <akim@epita.fr>

	* tests/sets.at (AT_EXTRACT_SETS): New.
	(Nullable): Use it.
	(Firsts): New.

2002-01-26  Akim Demaille  <akim@epita.fr>

	* tests/actions.at, tests/calc.at, tests/headers.at,
	* tests/torture.at: Adjust to the newest Autotest which no longer
	forces `.' in the PATH.

2002-01-25  Akim Demaille  <akim@epita.fr>

	* tests/regression.at (%nonassoc and eof): New.
	Suggested by Robert Anisko.

2002-01-24  Akim Demaille  <akim@epita.fr>

	Bison dumps core when trying to complain about broken input files.
	Reported by Cris van Pelt.

	* src/lex.c (parse_percent_token): Be sure to set token_buffer.
	* tests/regression.at (Invalid input: 1, Invalid input: 2): Merge
	into...
	(Invalid inputs): Strengthen: exercise parse_percent_token.

2002-01-24  Robert Anisko  <robert.anisko@epita.fr>

	* src/Makefile.am: Add bison.c++.
	* src/bison.c++: New skeleton.

2002-01-21  Paolo Bonzini <bonzini@gnu.org>

	* po/it.po: New.

2002-01-21  Kees Zeelenberg  <kzlg@users.sourceforge.net>

	* src/files.c (skeleton_find) [MSDOS]: Fix cp definition.

2002-01-20  Marc Autret  <marc@gnu.org>

	* src/files.c (compute_output_file_names): Fix

2002-01-20  Marc Autret  <marc@gnu.org>

	* tests/output.at: New test.
	* src/files.c (compute_base_names): Don't map extensions when
	the YACC flag is set, use defaults.
	Reported by Evgeny Stambulchik.

2002-01-20  Marc Autret  <marc@gnu.org>

	* src/system.h: Need to	define __attribute__ away for non-GCC
	compilers as well (i.e.	the vendor C compiler).
	Suggested by Albert Chin-A-Young.

2002-01-11  Tim Van Holder  <tim.van.holder@pandora.be>

	* lib/hash.h, lib/hash.c: Renamed __P to PARAMS and used the
	canonical definition.
	* src/system.h: Use the canonical definition for PARAMS (avoids
	a conflict with the macro from lib/hash.h).

2002-01-11  Akim Demaille  <akim@epita.fr>

	* configure.in: Use AC_FUNC_STRNLEN.
	Fixes the failures observed on AIX 4.3 by H.Merijn Brand.

2002-01-09  Akim Demaille  <akim@epita.fr>

	* src/files.c, src/files.h (output_infix): New.
	(tab_extension): Remove.
	(compute_base_names): Compute the former, drop the latter.
	* src/output.c (prepare): Insert the muscles `output-infix', and
	`output-suffix'.
	* src/parse-skel.y (string, string.1): New.
	(section.header): Use it.
	(section.yacc): Remove.
	(prefix): Remove too.
	* src/scan-skel.l: Adjust.
	* src/bison.simple, src/bison.hairy: Adjust.

2002-01-09  Akim Demaille  <akim@epita.fr>

	* configure.in (WERROR_CFLAGS): Compute it.
	* src/Makefile.am (CFLAGS): Pass it.
	* tests/atlocal.in (CFLAGS): Idem.
	* src/files.c: Fix a few warnings.
	(get_extension_index): Remove, unused.

2002-01-08  Akim Demaille  <akim@epita.fr>

	* src/getargs.c (AS_FILE_NAME): New.
	(getargs): Use it to convert DOSish file names.
	* src/files.c (base_name): Rename as full_base_name to avoid
	clashes with `base_name ()'.
	(filename_split): New.
	(compute_base_names): N-th rewrite, using filename_split.

2002-01-08  Akim Demaille  <akim@epita.fr>

	* lib/basename.c, lib/dirname.h, lib/dirname.c, lib/memrchr.c:
	New, stolen from the Fileutils 4.1.
	* lib/Makefile.am (libbison_a_SOURCES): Adjust.
	* configure.in: Check for the presence of memrchr, and of its
	prototype.

2002-01-07  Tim Van Holder  <tim.van.holder@pandora.be>

	* lib/hash.h (__P): Added definition for this macro.
	* src/Makefile.am: Add parse-skel.c and scan-skel.c to
	BUILT_SOURCES, to ensure they are generated first.
	* src/parse-skel.y: Use YYERROR_VERBOSE instead of
	%error-verbose to allow bootstrapping with bison 1.30x.

2002-01-06  Akim Demaille  <akim@epita.fr>

	* src/reader.c (parse_braces): Don't fetch the next char, the
	convention is to fetch on entry.
	* tests/torture.at (GNU Cim Grammar): Reintroduce their weird
	'switch' without a following semicolon.
	* tests/regression.at (braces parsing): New.

2002-01-06  Akim Demaille  <akim@epita.fr>

	Bison is dead wrong in its RR conflict reports.

	* tests/torture.at (GNU Cim Grammar): New.
	* src/conflicts.c (count_rr_conflicts): Fix.

2002-01-06  Akim Demaille  <akim@epita.fr>

	Creating package.m4 from configure.ac causes too many problems.

	* tests/Makefile.am (package.m4): Create it by hand,
	AC_CONFIG_TESTDIR no longer does in the most recent CVS Autoconf.

2002-01-06  Akim Demaille  <akim@epita.fr>

	* src/Makefile.am (bison_SOURCES): Add parse-skel.h and
	skeleton.h.

2002-01-04  Paul Eggert  <eggert@twinsun.com>

	* doc/bison.texinfo (Debugging):
	Remove YYSTDERR; it's no longer defined or used.
	Also, s/cstdio.h/cstdio/.

2002-01-03  Akim Demaille  <akim@epita.fr>

	* tests/bison.in, tests/atlocal.in: Adjust to CVS Autoconf.

2002-01-03  Akim Demaille  <akim@epita.fr>

	* src/parse-skel.y (process_skeleton): Don't bind the parser's
	tracing code to --trace, wait for a better --trace option, with
	args.

2002-01-03  Akim Demaille  <akim@epita.fr>

	* src/bison.simple (YYSTDERR): Remove, replace `stderr'.
	The ISO C++ standard is extremely clear about it: stderr is
	considered a macro, not a regular symbol (see table 94 `Header
	<cstdio> synopsis', [lib.c.files] 27.8.2 C Library files).
	Therefore std:: does not apply to it.  It still does with fprintf.
	Also, s/cstdio.h/cstdio/.

2002-01-03  Akim Demaille  <akim@epita.fr>

	* lib/quotearg.c: Use `#include "..."' instead of `#include <...>'
	for non system headers.

2002-01-02  Akim Demaille  <akim@epita.fr>

	Equip the skeleton chain with location tracking, runtime trace,
	pure parser and scanner.

	* src/parse-skel.y: Request a pure parser, locations, and prefix
	renaming.
	(%union): Having several members with the same type does not help
	type mismatches, simplify.
	(YYPRINT, yyprint): New.
	(yyerror): ``Rename'' (there is a #define yyerror skel_error) as...
	(skel_error): this.
	Handle locations.
	* src/scan-skel.l: Adjust to these changes.
	* src/skeleton.h (LOCATION_RESET, LOCATION_LINES, LOCATION_STEP)
	(LOCATION_PRINT, skel_control_t): New.

2001-12-30  Akim Demaille  <akim@epita.fr>

	* src/parse-skel.y: Get rid of the shift/reduce conflict:
	replace `gb' with BLANKS.
	* src/scan-skel.l: Adjust.

2001-12-30  Akim Demaille  <akim@epita.fr>

	* src/system.h: We don't need nor want bcopy.
	Throw away MS-DOS crap: we don't need getpid.
	* configure.in: We don't need strndup.  It was even causing
	problems: because Flex includes the headers *before* us,
	_GNU_SOURCE is not defined by config.h, and therefore strndup was
	not visible.
	* lib/xstrndup.c: New.
	* src/scan-skel.l: Use it.
	Be sure to initialize yylval.muscle member when scanning a MUSCLE.
	* src/parse-skel.y: Use %directives instead of #defines.

2001-12-30  Akim Demaille  <akim@epita.fr>

	* src/skeleton.h: New.
	* src/output.c (output_parser, output_master_parser): Remove, dead
	code.
	* src/output.h (get_lines_number, actions_output, guards_output)
	(token_definitions_output): Prototype them.
	* src/parse-skel.y: Add the license notice.
	Include output.h and skeleton.h.
	(process_skeleton): Returns void, and takes a single parameter.
	* src/scan-skel.l: Add the license notice.
	Include skeleton.h.
	Don't use %option yylineno: it seems that then Flex imagines
	REJECT has been used, and therefore it won't reallocate its
	buffers (which makes no other sense to me than a bug).  It results
	in warnings for `unused: yy_flex_realloc'.

2001-12-30  Robert Anisko  <robert.anisko@epita.fr>

	* src/muscle_tab.h (MUSCLE_INSERT_INT, MUSCLE_INSERT_STRING)
	(MUSCLE_INSERT_PREFIX): ...to there.
	* src/output.c (MUSCLE_INSERT_INT, MUSCLE_INSERT_STRING)
	(MUSCLE_INSERT_PREFIX): Move from here...

	* src/bison.hairy: Add a section directive.  Put braces around muscle
	names.  This parser skeleton is still broken, but Bison should not
	choke on a bad muscle 'syntax'.
	* src/bison.simple: Add a section directive.  Put braces around muscle
	names.

	* src/files.h (strsuffix, stringappend): Add declarations.
	(tab_extension): Add declaration.
	(short_base_name): Add declaration.

	* src/files.c (strsuffix, stringappend): No longer static.  These
	functions are used in the skeleton parser.
	(tab_extension): New.
	(compute_base_names): Use the computations done in this function
	to guess if the generated parsers should have '.tab' in their
	names.
	(short_base_name): No longer static.

	* src/output.c (output_skeleton): New.
	(output): Disable call to output_master_parser, and give a try to
	a new skeleton handling system.
	(guards_output, actions_output): No longer static.
	(token_definitions_output, get_lines_number): No longer static.

	* configure.in: Use AM_PROG_LEX and AC_PROG_YACC.

	* src/Makefile.am (bison_SOURCES): Add scan-skel.l and
	parse-skel.y.

	* src/parse-skel.y: New file.
	* src/scan-skel.l: New file.

2001-12-29  Akim Demaille  <akim@epita.fr>

	%name-prefix is broken.

	* src/files.c (spec_name_prefix): Initialize to NULL, not to "yy".
	Adjust all dependencies.
	* tests/headers.at (export YYLTYPE): Strengthen this test: use
	%name-prefix.

	Renaming yylval but not yylloc is not consistent.  Now we do.

	* src/bison.simple: Prefix yylloc if used.
	* doc/bison.texinfo (Decl Summary): Document that.

2001-12-29  Akim Demaille  <akim@epita.fr>

	* doc/bison.texinfo: Promote `%long-directive' over
	`%long_directive'.
	Remove all references to fixed-output-files, yacc is enough.

2001-12-29  Akim Demaille  <akim@epita.fr>

	* src/bison.simple: Define YYDEBUG and YYERROR_VERBOSE *after* the
	user prologue.  These are defaults.
	* tests/actions.at (Mid-rule actions): Make sure the user can
	define YYDEBUG and YYERROR_VERBOSE.

2001-12-29  Akim Demaille  <akim@epita.fr>

	* src/output.c (header_output): Don't forget to export YYLTYPE and
	yylloc.
	* tests/headers.at (export YYLTYPE): New, make sure it does.
	* tests/regression.at (%union and --defines, Invalid CPP headers):
	Move to...
	* tests/headers.at: here.

2001-12-29  Akim Demaille  <akim@epita.fr>

	* src/gram.h (rule_s): Member `assoc' is of type `associativity'.

2001-12-29  Akim Demaille  <akim@epita.fr>

	* tests/actions.at (Mid-rule actions): Output on a single line
	instead of several.

2001-12-29  Akim Demaille  <akim@epita.fr>

	* doc/bison.texinfo: Formatting changes.

2001-12-29  Akim Demaille  <akim@epita.fr>

	Don't store the token defs in a muscle, just be ready to output it
	on command.  Now possible via `symbols'.  Fixes a memory leak.

	* src/output.c (token_definitions_output): New.
	(output_parser, header_output): Use it.
	* src/reader.c (symbols_save): Remove.

2001-12-29  Akim Demaille  <akim@epita.fr>

	* src/bison.simple: Do not provide a default for YYSTYPE and
	YYLTYPE before the user's prologue.  Otherwise it's hardly... a
	default.

2001-12-29  Akim Demaille  <akim@epita.fr>

	Mid-rule actions are simply... ignored!

	* src/reader.c (readgram): Be sure to attach mid-rule actions to
	the empty-rule associated to the dummy symbol, not to the host
	rule.
	* tests/actions.at (Mid-rule actions): New.

2001-12-29  Akim Demaille  <akim@epita.fr>

	Memory leak.

	* src/reader.c (reader): Free grammar.

2001-12-29  Akim Demaille  <akim@epita.fr>

	Memory leak.

	* src/LR0.c (new_itemsets): Don't allocate `shift_symbol' here,
	since it allocates it for each state, although only one is needed.
	(allocate_storage): Do it here.

2001-12-29  Akim Demaille  <akim@epita.fr>

	* src/options.h, src/options.c (create_long_option_table): Rename
	as...
	(long_option_table_new): this, with a clearer prototype.
	(percent_table): Remove, unused,
	* src/getargs.c (getargs): Adjust.

2001-12-29  Akim Demaille  <akim@epita.fr>

	* src/LR0.c, src/conflicts.c, src/lalr.c, src/lalr.h, src/output.c
	* src/print.c, src/print_graph.c, src/state.h: Rename state_table
	as states.

2001-12-29  Akim Demaille  <akim@epita.fr>

	* src/lalr.c (build_relations): Rename `states' as `states1'.
	Sorry, I don't understand exactly what it is, no better name...

2001-12-29  Akim Demaille  <akim@epita.fr>

	* src/closure.c, src/conflicts.c, src/derives.c, src/gram.c
	* src/gram.h, src/lalr.c, src/nullable.c, src/output.c, src/print.c
	* src/print_graph.c, src/reader.c, src/reduce.c: Rename rule_table
	as rules.

2001-12-29  Akim Demaille  <akim@epita.fr>

	* src/gram.c (rprec, rprecsym, rassoc): Remove, unused since long
	ago.

2001-12-29  Akim Demaille  <akim@epita.fr>

	* src/reader.c, src/reader.h (user_toknums): Remove.
	Adjust all users to use symbols[i]->user_token_number.

2001-12-29  Akim Demaille  <akim@epita.fr>

	* src/gram.c, src/gram.h (sprec, sassoc): Remove.
	Adjust all users to use symbols[i]->prec or ->assoc.

2001-12-29  Akim Demaille  <akim@epita.fr>

	* src/reader.c, src/reader.h (tags): Remove.
	Adjust all users to use symbols[i]->tag.

2001-12-29  Akim Demaille  <akim@epita.fr>

	* src/gram.h, src/gram.c (symbols): New, similar to state_table
	and rule_table.
	* src/reader.c (packsymbols): Fill this table.
	Drop sprec.
	* src/conflicts.c (resolve_sr_conflict): Adjust.
	* src/reduce.c (reduce_grammar): Adjust: just sort symbols, a
	single table.
	Use symbols[i]->tag instead of tags[i].

2001-12-29  Akim Demaille  <akim@epita.fr>

	* tests/calc.at (_AT_DATA_CALC_Y): Also use %union.
	In addition, put a comment in there, to replace...
	* tests/regression.at (%union and C comments): Remove.

2001-12-29  Akim Demaille  <akim@epita.fr>

	* tests/regression.at (Web2c Actions): Blindly move the actual
	output as expected output.  The contents *seem* right to me, but I
	can't pretend reading perfectly parser tables...  Nonetheless, all
	the other tests pass correctly, the table look OK, even though the
	presence of `$axiom' is to be noted: AFAICS it is useless (but
	harmless).

2001-12-29  Akim Demaille  <akim@epita.fr>

	* src/reader.c (readgram): Don't add the rule 0 if there were no
	rules read.  In other words, add it _after_ having performed
	grammar sanity checks.
	Fixes the `tests/regression.at (Invalid input: 1)' Failure.

2001-12-29  Akim Demaille  <akim@epita.fr>

	* tests/regression.at (Web2c Report): Catch up: the rule 0 is now
	visible, and some states have now a different number.

2001-12-29  Akim Demaille  <akim@epita.fr>

	* src/reader.c (readgram): Bind the initial rule's lineno to that
	of the first rule.
	* tests/regression.at (Rule Line Numbers, Unresolved SR Conflicts):
	(Solved SR Conflicts): Adjust rule 0's line number.

2001-12-29  Akim Demaille  <akim@epita.fr>

	Fix the `GAWK Grammar' failure.

	* src/LR0.c (final_state): Initialize to -1 so that we do compute
	the reductions of the first state which was mistakenly confused
	with the final state because precisely final_state was initialized
	to 0.
	* tests/sets.at (Nullable): Adjust: state 0 does have lookaheads,
	now noticed by Bison.
	* tests/regression.at (Rule Line Numbers): Adjust: state 0 does
	have a reduction on $default.

2001-12-29  Akim Demaille  <akim@epita.fr>

	* src/gram.c (ritem_print): Be sure to subtract 1 when displaying
	rule line numbers.
	* src/closure.c (print_closure): Likewise.
	* src/derives.c (print_derives): Likewise.
	* tests/sets.at (Nullable): Adjust: the rule numbers are correct
	now.

2001-12-29  Akim Demaille  <akim@epita.fr>

	* src/lalr.c (lookaheads_print): New.
	(lalr): Call it when --trace-flag.
	* tests/sets.at (Nullable): Adjust: when tracing, the lookaheads
	are dumped.

2001-12-29  Akim Demaille  <akim@epita.fr>

	* src/derives.c (print_derives): Be sure to use `>= 0', not `> 0',
	when walking through ritem, even via rule->rhs.
	* src/reduce.c (dump_grammar, useful_production, reduce_output)
	(useful_production, useless_nonterminals): Likewise.
	(reduce_grammar_tables): Likewise, plus update nritems.
	* src/nullable.c (set_nullable): Likewise.
	* src/lalr.c (build_relations): Likewise.
	* tests/sets.at (Nullable): Adjust.
	Fortunately, now, the $axiom is no longer nullable.

2001-12-29  Akim Demaille  <akim@epita.fr>

	* src/LR0.c (generate_states): Use nritems, not nitems, nor using
	the 0-sentinel.
	* src/gram.c (ritem_longest_rhs): Likewise.
	* src/reduce.c (nonterminals_reduce): Likewise.
	* src/print_graph.c (print_graph): Likewise.
	* src/output.c (output_rule_data): Likewise.
	* src/nullable.c (set_nullable):  Likewise.

2001-12-29  Akim Demaille  <akim@epita.fr>

	* src/output.c: Comment changes.

2001-12-27  Paul Eggert  <eggert@twinsun.com>

	* src/bison.simple (YYSTACK_ALLOC, YYSIZE_T): Remove special
	cases for non-GNU systems like AIX, HP-UX, SGI, Sun, and
	Sparc, as they were causing more porting problems than the
	(minor) performance improvement was worth.

	Also, catch up with 1.31's YYSTD.

2001-12-27  Akim Demaille  <akim@epita.fr>

	* src/output.c (output_gram): Rely on nritems, not the
	0-sentinel.  See below.
	Use -1 as separator, not 0.
	* src/bison.simple (yyparse): Subtract 1 to the rule numbers.
	Rely on -1 as separator in yyrhs, instead of 0.
	* tests/calc.at (AT_CHECK_CALC): Now, the parsers no longer issue
	twice `Now at end of input', therefore there are two lines less to
	expect.

2001-12-27  Akim Demaille  <akim@epita.fr>

	* tests/regression.at (Unresolved SR Conflicts):
	(Solved SR Conflicts, Rule Line Numbers): Adjust to the changes
	below.

2001-12-27  Akim Demaille  <akim@epita.fr>

	* src/LR0.c (new_state): Recognize the final state by the fact it
	is reached by eoftoken.
	(insert_start_shifting_state, insert_eof_shifting_state)
	(insert_accepting_state, augment_automaton): Remove, since now
	these states are automatically computed from the initial state.
	(generate_states): Adjust.
	* src/print.c: When reporting a rule number to the user, substract
	1, so that the axiom rule is rule 0, and the first user rule is 1.
	* src/reduce.c: Likewise.
	* src/print_graph.c (print_core): For the time being, just as for
	the report, depend upon --trace-flags to dump the full set of
	items.
	* src/reader.c (readgram): Once the grammar read, insert the rule
	0: `$axiom: START-SYMBOL $'.
	* tests/set.at: Adjust: rule 0 is now displayed, and since the
	number of the states has changed (the final state is no longer
	necessarily the last), catch up.

2001-12-27  Akim Demaille  <akim@epita.fr>

	Try to make the use of the eoftoken valid.  Given that its value
	is 0 which was also used as a sentinel in ritem, (i) make sure >= 0
	is used instead of > 0 where appropriate, (ii), depend upon nritems
	instead of the 0-sentinel.

	* src/gram.h, src/gram.c (nritems): New.
	Expected to be duplication of nitems, but for the time being...
	* src/reader.c (packgram): Assert nritems and nitems are equal.
	* src/LR0.c (allocate_itemsets, new_itemsets): Adjust.
	* src/closure.c (print_closure, print_fderives): Likewise.
	* src/gram.c (ritem_print): Likewise.
	* src/print.c (print_core, print_grammar): Likewise.
	* src/print_graph.c: Likewise.

2001-12-27  Akim Demaille  <akim@epita.fr>

	* src/main.c (main): If there are complains after grammar
	reductions, then output the report anyway if requested, then die.
	* src/symtab.c (bucket_new): Initialize `value' to -1, not 0.
	* src/reader.c (eoftoken): New.
	(parse_token_decl): If the token being defined has value `0', it
	is the eoftoken.
	(packsymbols): No longer hack `tags' to insert `$' by hand.
	Be sure to preserve the value of the eoftoken.
	(reader): Make sure eoftoken is defined.
	Initialize nsyms to 0: now eoftoken is created just like the others.
	* src/print.c (print_grammar): Don't special case the eof token.
	* src/regression.at: Adjust: `$' has value 0, not -1, which was a
	lie anyway, albeit pleasant.
	* tests/calc.at: Exercise error messages with eoftoken.
	Change the grammar so that empty input is invalid.
	Adjust expectations.
	When yyungeting, be sure to use a valid yylloc: use last_yylloc.

2001-12-27  Akim Demaille  <akim@epita.fr>

	* configure.in: Check the protos of strchr ans strspn.
	Replace strchr if needed.
	* src/system.h: Provide the protos of strchr, strspn and memchr if
	missing.
	* lib/strchr.c: New.
	* src/reader.c (symbols_save): Use strchr.

2001-12-27  Akim Demaille  <akim@epita.fr>

	* src/print.c, src/print_graph.c (escape): New.
	Use it to quote the TAGS outputs.
	* src/print_graph.c (print_state): Now errors are in red, and
	reductions in green.
	Prefer high to wide: output the state number on a line of its own.

2001-12-27  Akim Demaille  <akim@epita.fr>

	* src/state.h, src/state.c (reductions_new): New.
	* src/LR0.c (set_state_table): Let all the states have a
	`reductions', even if reduced to 0.
	(save_reductions): Adjust.
	* src/lalr.c (initialize_LA, initialize_lookaheads): Adjust.
	* src/print.c (print_reductions, print_actions): Adjust.
	* src/output.c (action_row): Adjust.

2001-12-27  Akim Demaille  <akim@epita.fr>

	* src/state.h, src/state.c (errs_new, errs_dup): New.
	* src/LR0.c (set_state_table): Let all the states have an errs,
	even if reduced to 0.
	* src/print.c (print_errs, print_reductions): Adjust.
	* src/output.c (output_actions, action_row): Adjust.
	* src/conflicts.c (resolve_sr_conflict): Adjust.

2001-12-27  Akim Demaille  <akim@epita.fr>

	* src/lalr.c (set_goto_map, initialize_F): Use SHIFT_SYMBOL.

2001-12-27  Akim Demaille  <akim@epita.fr>

	* src/conflicts.c, src/conflicts.h (print_reductions): Move to...
	* src/print.c: here.
	(lookaheadset, shiftset): New, used as additional storage by
	print_reductions.
	(print_results): Adjust.
	(print_shifts, print_gotos, print_errs): New, extracted from...
	(print_actions): here.
	* src/print_graph.c (print_actions): Remove dead code.

2001-12-27  Akim Demaille  <akim@epita.fr>

	* src/reader.c (copy_dollar, copy_at): Better checking of `n' in
	`$n' and `@n'.

2001-12-27  Akim Demaille  <akim@epita.fr>

	* src/lalr.c (add_lookback_edge): Use state_t instead of ints.
	(build_relations): Adjust.

2001-12-27  Akim Demaille  <akim@epita.fr>

	* src/lalr.c (set_goto_map): Remove a wrong but benign loop
	duplication.

2001-12-27  Akim Demaille  <akim@epita.fr>

	* src/reader.c (packgram): Catch nitems overflows.

2001-12-27  Akim Demaille  <akim@epita.fr>

	* src/files.c, src/files.h (guard_obstack): Remove.
	* src/output.c (output): Adjust.
	* src/reader.c (parse_braces): New, factoring...
	(copy_action, copy_guard): these two which are renamed as...
	(parse_action, parse_guard): these.
	As a voluntary consequence, using braces around guards is now
	mandatory.

2001-12-27  Akim Demaille  <akim@epita.fr>

	* src/gram.h (rule_t): `guard' and `guard_line' are new members.
	* src/reader.c (symbol_list): `guard' and `guard_line' are new
	members.
	(symbol_list_new): Adjust.
	(copy_action): action_line is the first line, not the last.
	(copy_guard): Just as for actions, store the `action' only, not
	the switch/case/break flesh.
	Don't parse the user action that might follow the guard, let...
	(readgram): do it, i.e., now, there can be an action after a
	guard.
	In other words the guard is just explicitly optional.
	(packgram): Adjust.
	* src/output.c (guards_output): New.
	(output_parser): Call it when needed.
	(output): Also free the guard and attrs obstacks.
	* src/files.c, src/files.h (obstack_save): Remove.
	(output_files): Remove.
	As a result, if one needs the former `.act' file, using an
	appropriate skeleton which requires actions and guards is now
	required.
	* src/main.c (main): Adjust.
	* tests/semantic.at: New.
	* tests/regression.at: Use `input.y' as input file name.
	Avoid 8+3 problems by requiring input.c when the test needs the
	parser.

2001-12-27  Akim Demaille  <akim@epita.fr>

	* src/reader.c (symbol_list_new): Be sure to initialize all the
	fields.

2001-12-27  Akim Demaille  <akim@epita.fr>

	All the hacks using a final pseudo state are now useless.

	* src/LR0.c (set_state_table): state_table holds exactly nstates.
	* src/lalr.c (nLA): New.
	(initialize_LA, compute_lookaheads, initialize_lookaheads): Use it
	instead of lookaheadsp from the pseudo state (nstate + 1).

2001-12-27  Akim Demaille  <akim@epita.fr>

	* src/output.c (action_row, token_actions): Use a state_t instead
	of a integer, and nlookaheads instead of the following state's
	lookaheadsp.

2001-12-27  Akim Demaille  <akim@epita.fr>

	* src/conflicts.c (log_resolution, flush_shift)
	(resolve_sr_conflict, set_conflicts, solve_conflicts)
	(count_sr_conflicts, count_rr_conflicts, conflicts_output)
	(conflicts_print, print_reductions): Use a state_t instead of an
	integer when referring to a state.
	As much as possible, depend upon nlookaheads, instead of the
	`lookaheadsp' member of the following state (since lookaheads of
	successive states are successive, the difference between state n + 1
	and n served as the number of lookaheads for state n).
	* src/lalr.c (add_lookback_edge): Likewise.
	* src/print.c (print_core, print_actions, print_state)
	(print_results): Likewise.
	* src/print_graph.c (print_core, print_actions, print_state)
	(print_graph): Likewise.
	* src/conflicts.h: Adjust.

2001-12-27  Akim Demaille  <akim@epita.fr>

	* src/bison.hairy: Formatting/comment changes.
	ANSIfy.
	Remove `register' indications.
	Add plenty of `static'.

2001-12-27  Akim Demaille  <akim@epita.fr>

	* src/output.c (prepare): Drop the muscle `ntbase' which
	duplicates ntokens.
	* src/bison.simple: Formatting/comment changes.
	Use YYNTOKENS only, which is documented, but not YYNTBASE, which
	is an undocumented synonym.

2001-12-22  Akim Demaille  <akim@epita.fr>

	* src/output.c (output_table_data): Change the prototype to use
	`int' for array ranges: some invocations do pass an int, not a
	short.
	Reported by Wayne Green.

2001-12-22  Akim Demaille  <akim@epita.fr>

	Some actions of web2c.y are improperly triggered.
	Reported by Mike Castle.

	* src/lalr.c (traverse): s/F (i)[k] = F (j)[k]/F (j)[k] = F (i)[k]/.
	* tests/regression.at (Web2c): Rename as...
	(Web2c Report): this.
	(Web2c Actions): New.

2001-12-22  Akim Demaille  <akim@epita.fr>

	Reductions in web2c.y are improperly reported.
	Reported by Mike Castle.

	* src/conflicts.c (print_reductions): Fix.
	* tests/regression.at (Web2c): New.

2001-12-18  Akim Demaille  <akim@epita.fr>

	Some host fail on `assert (!"foo")', which expands to
	((!"foo") ? (void)0 : __assert("!"foo."", __FILE__, __LINE__))
	Reported by Nelson Beebee.

	* src/output.c, src/vcg.c: Replace `assert (!"it succeeded")' with
	`#define it_succeeded 0' and `assert (it_succeeded)'.

2001-12-17  Marc Autret  <autret_m@epita.fr>

	* src/bison.simple: Don't hard code the skeleton line and filename.
	* src/output.c (output_parser): Rename 'line' as 'output_line'.
	New line counter 'skeleton_line' (skeleton-line muscle).

2001-12-17  Paul Eggert  <eggert@twinsun.com>

	* NEWS, doc/bison.texinfo, doc/bison.1, doc/bison.rnh: Document that
	YYDEBUG must be defined to a nonzero value.

	* src/bison.simple (yytname): Do not assume that the user defines
	YYDEBUG to a properly parenthesized expression.

2001-12-17  Akim Demaille  <akim@epita.fr>

	* src/state.h (state_t): Rename lookaheads as lookaheadsp.
	nlookaheads is a new member.
	Adjust all users.
	* src/lalr.h (nlookaheads): Remove this orphan declaration.
	* src/lalr.c (initialize_lookaheads): Set nlookaheads for each
	state.

2001-12-17  Akim Demaille  <akim@epita.fr>

	* src/files.h, src/files.c (open_files, close_files): Remove.
	* src/main.c (main): Don't open/close files, nor invoke lex_free,
	let...
	* src/reader.c (reader): Do it.

2001-12-17  Akim Demaille  <akim@epita.fr>

	* src/conflicts.c (print_reductions): Formatting changes.

2001-12-17  Akim Demaille  <akim@epita.fr>

	* src/conflicts.c (flush_shift): Also adjust lookaheadset.
	(flush_reduce): New.
	(resolve_sr_conflict): Adjust.

2001-12-17  Akim Demaille  <akim@epita.fr>

	* src/output.c (output_obstack): Be static and rename as...
	(format_obstack): this, to avoid any confusion with files.c's
	output_obstack.
	* src/reader.h (muscle_obstack): Move to...
	* src/output.h: here, since it's defined in output.c.

2001-12-17  Akim Demaille  <akim@epita.fr>

	* src/output.c (action_row, save_column, default_goto)
	(sort_actions, matching_state, pack_vector): Better variable
	locality.

2001-12-17  Akim Demaille  <akim@epita.fr>

	* src/output.c: Various formatting changes.

2001-12-17  Akim Demaille  <akim@epita.fr>

	* src/files.c (output_files): Free the output_obstack.
	* src/main.c (main): Call print and print_graph conditionally.
	* src/print.c (print): Work unconditionally.
	* src/print_graph.c (print_graph): Work unconditionally.
	* src/conflicts.c (log_resolution): Output only if verbose_flag.

2001-12-16  Marc Autret  <autret_m@epita.fr>

	* src/output.c (actions_output): Fix. When we use %no-lines,
	there is one less line per action.

2001-12-16  Marc Autret  <autret_m@epita.fr>

	* src/bison.simple: Remove a useless #line directive.
	s/#line %%line %%skeleton/#line %%line "%%parser-file-name"/'.
	* src/output.c (get_lines_number): New.
	(output_parser): Adjust, now takes care about the lines of a
	output muscles.
	Fix line numbering.
	(actions_output): Computes the number of lines taken by actions.
	(output_master_parser): Insert new skeleton which is the name of
	the output parser file name.

2001-12-15  Marc Autret  <autret_m@epita.fr>

	* src/bison.simple [YYERROR_VERBOSE]: Restore backward compatibility.

2001-12-15  Marc Autret  <autret_m@epita.fr>

	* src/output.c (output_gram): Keep track of the hairy one.

2001-12-15  Akim Demaille  <akim@epita.fr>

	Make `make distcheck' work.

	* lib/Makefile.am (INCLUDES): Add top_srcdir/intl, since hash uses
	system.h which uses libgettext.h.

2001-12-15  Akim Demaille  <akim@epita.fr>

	* src/nullable.c (set_nullable): Useless rules must be skipped,
	otherwise, since we range over their symbols, we might look at a
	nonterminal which no longer ``exists'', i.e., it is not counted in
	`nvars', hence we overflow our arrays.

2001-12-15  Akim Demaille  <akim@epita.fr>

	The header can also be produced directly, without any obstack!
	Yahoo!

	* src/files.c, src/files.h (defines_obstack): Remove.
	(compute_header_macro): Global.
	(defines_obstack_save): Remove.
	* src/reader.c (parse_union_decl): No longer output to
	defines_obstack: its content can be found in the `stype' muscle
	anyway.
	(output_token_translations): Merge into...
	(symbols_output): this.
	Rename as...
	(symbols_save): this.
	(reader): Adjust.
	* src/output.c (header_output): New.
	(output): Call it.

2001-12-15  Akim Demaille  <akim@epita.fr>

	* src/reader.c (parse_union_decl): Instead of handling two obstack
	simultaneously, use one to define the `stype' muscle, and use the
	value of the latter to fill defines_obstack.
	(copy_comment): Remove.
	(copy_comment2): Work for a single obstack.
	Rename as...
	(copy_comment): this.

2001-12-15  Akim Demaille  <akim@epita.fr>

	* src/lex.c, src/lex.h (xgetc): No longer static.
	* src/reader.c (parse_union_decl): Revamp.

2001-12-15  Akim Demaille  <akim@epita.fr>

	Still making progress in separating Bison into (i) input, (ii)
	process, (iii) output: now we can directly output the parser file
	without using table_obstack at all.

	* src/files.c, src/files.h (table_obstack): Bye bye.
	(parser_file_name): New.
	* src/files.c (compute_output_file_names): Compute it.
	* src/output.c (actions_output, output_parser)
	(output_master_parser): To a file instead of an obstack.

2001-12-15  Akim Demaille  <akim@epita.fr>

	Attach actions to rules, instead of pre-outputting them to
	actions_obstack.

	* src/gram.h (rule_t): action and action_line are new members.
	* src/reader.c (symbol_list): Likewise.
	(copy_action): Save the actions within the rule.
	(packgram): Save them in rule_table.
	* src/output.c (actions_output): New.
	(output_parser): Use it on `%%actions'.
	(output_rule_data): Don't free rule_table.
	(output): Do it.
	(prepare): Don't save the `action' muscle.
	* src/bison.simple: s/%%action/%%actions/.

2001-12-15  Akim Demaille  <akim@epita.fr>

	* src/reader.c (copy_action): When --yacc, don't append a `;'
	to the user action: let it fail if lacking.
	Suggested by Arnold Robbins and Tom Tromey.

2001-12-14  Akim Demaille  <akim@epita.fr>

	* src/lex.c (literalchar): Simply return the char you decoded, non
	longer mess around with obstacks and int pointers.
	Adjust all callers.

2001-12-14  Akim Demaille  <akim@epita.fr>

	* src/lex.c (literalchar): Don't escape the special characters,
	just decode them, and keep them as char (before, eol was output as
	the 2 char string `\n' etc.).
	* src/output.c (output_rule_data): Use quotearg to output the
	token strings.

2001-12-13  Paul Eggert  <eggert@twinsun.com>

	* src/bison.simple (YYSIZE_T, YYSTACK_ALLOC, YYSTACK_FREE):
	Do not infringe on the global user namespace when using C++.
	(YYFPRINTF, YYSTDERR): New macros, needed for the above.
	All uses of `fprintf' and `stderr' changed.

	* doc/bison.texinfo: Document YYFPRINTF, YYSTDERR.

2001-12-13  Akim Demaille  <akim@epita.fr>

	The computation of nullable is broken: it doesn't handle empty
	RHS's properly.

	* tests/torture.at (GNU AWK Grammar): New.
	* tests/sets.at (Nullable): New.
	* src/nullable.c (set_nullable): Instead of blindly looping over
	`ritems', loop over the rules, and then over their rhs's.

	Work around Autotest bugs.

	* src/warshall.c (bitmatrix_print): Don't use `+--+' as table
	frame, because Autotest understand lines starting with a `+' as
	traces from the shell.  Then, they are not processed properly.
	Admittedly an Autotest bug, but we don't have time to wait for
	Autotest to catch up.
	* tests/regression.at (Broken Closure): Adjust to the new table
	frames.
	Move to...
	* tests/sets.at: here.

2001-12-13  Akim Demaille  <akim@epita.fr>

	* src/closure.c (closure): Use nrules instead of playing tricks
	with BITS_PER_WORD.

2001-12-13  Akim Demaille  <akim@epita.fr>

	* src/print.c (print_actions): Output the handling of `$' as the
	traces do: shifting the token EOF.  Before EOF was treated as a
	nonterminal.
	* tests/regression.at: Adjust some tests.
	* src/print_graph.c (print_core): Complete the set of items via
	closure.  The next-to-final and final states are still unsatisfying,
	but that's to be addressed elsewhere.
	No longer output the rule numbers, but do output the state number.
	A single loop for the shifts + gotos is enough, but picked a
	distinct color for each.
	(print_graph): Initialize and finalize closure.

2001-12-13  Akim Demaille  <akim@epita.fr>

	* src/reader.c (readgram): Remove dead code, an strip useless
	braces.
	(get_type): Remove, unused.

2001-12-12  Akim Demaille  <akim@epita.fr>

	* src/complain.h, src/complain.c: Remove error_one_per_line, rely
	on that of lib/error.c.

2001-12-12  Akim Demaille  <akim@epita.fr>

	Some hosts don't like `/' in includes.

	* src/system.h: Include libgettext.h without qualifying the path.
	* src/Makefile.am (INCLUDES): Add $(top_srcdir)/intl, remove
	$(top_srcdir).

2001-12-11  Marc Autret  <autret_m@epita.fr>

	* src/output.c (output_parser): Remove useless muscle.

2001-12-11  Marc Autret  <autret_m@epita.fr>

	* src/bison.simple: Remove #line just before %%epilogue. It
	is now handled in ...
	* src/reader.c (read_additionnal_code): Add the output of a
	#line for the epilogue.

2001-12-10  Marc Autret  <autret_m@epita.fr>

	* src/reader.c (copy_definition): Re-use CPP-outed code which
	replace precedent remove.
	* src/bison.simple: Remove #line before %%prologue because
	%%input-line is wrong at this time.

2001-12-10  Marc Autret  <autret_m@epita.fr>

	* src/reader.c (symbols_output): Clean up.
	* src/output.c (output_gram, output): Clean up.

2001-12-10  Akim Demaille  <akim@epita.fr>

	* src/lalr.c (initialize_lookaheads): New.  Extracted from...
	* src/LR0.c (set_state_table): here.
	* src/lalr.c (lalr): Call it.

2001-12-10  Akim Demaille  <akim@epita.fr>

	* src/state.h (shifts): Remove the `number' member: shifts are
	attached to state, hence no longer need to be labelled with a
	state number.

2001-12-10  Akim Demaille  <akim@epita.fr>

	Now that states have a complete set of members, the linked list of
	shifts is useless: just fill directly the state's shifts member.

	* src/state.h (shifts): Remove the `next' member.
	* src/LR0.c (first_state, last_state): Remove.
	Adjust the callers.
	(augment_automaton): Don't look for the shifts that must be added
	a shift on EOF: it is those of the state we looked for!  But now,
	since shifts are attached, it is no longer needed to looking
	merely by its id: its number.

2001-12-10  Akim Demaille  <akim@epita.fr>

	* src/LR0.c (augment_automaton): Better variable locality.
	Remove an impossible branch: if there is a state corresponding to
	the start symbol being shifted, then there is shift for the start
	symbol from the initial state.

2001-12-10  Akim Demaille  <akim@epita.fr>

	* src/LR0.c (augment_automaton): Call `insert_eof_shifting_state'
	only when appropriate: when insert_start_shifting_state' is not
	invoked.
	* tests/regression.at (Rule Line Numbers): Adjust.

2001-12-10  Akim Demaille  <akim@epita.fr>

	* src/LR0.c (augment_automaton): Now that all states have shifts,
	merge the two cases addition shifts to the initial state.

2001-12-10  Akim Demaille  <akim@epita.fr>

	* src/lalr.c (set_state_table): Move to...
	* src/LR0.c: here.
	* src/lalr.c (lalr): Don't call it...
	* src/LR0.c (generate_states): do it.
	* src/LR0.h (first_state): Remove, only the table is used.

2001-12-10  Akim Demaille  <akim@epita.fr>

	* src/LR0.h (first_shift, first_reduction): Remove.
	* src/lalr.c: Don't use first_shift: find shifts through the
	states.

2001-12-10  Akim Demaille  <akim@epita.fr>

	* src/LR0.c: Attach shifts to states as soon as they are
	computed.
	* src/lalr.c (set_state_table): Instead of assigning shifts to
	state, just assert that the mapping was properly done.

2001-12-10  Akim Demaille  <akim@epita.fr>

	* src/LR0.c (insert_start_shift): Rename as...
	(insert_start_shifting_state): this.
	(insert_eof_shifting_state, insert_accepting_state): New.
	(augment_automaton): Adjust.
	Better locality of the variables.
	When looking if the start_symbol is shifted from the initial
	state, using `while (... symbol != start_symbol ...)' sounds
	better than `while (... symbol < start_symbol ...)': If fail
	to see how the order between symbols could be relevant!

2001-12-10  Akim Demaille  <akim@epita.fr>

	* src/getargs.h: Don't declare `spec_name_prefix' and
	`spec_file_prefix', declared by src/files.h.
	* src/files.c, src/files.h: Default for spec_name_prefix is "yy".
	* src/muscle_tab.c (muscle_init): Default prefix to NULL.
	* src/output.c (prepare): Adjust.
	* src/reader.c (symbols_output): Likewise.
	* src/vmsgetargs.c: Vaguely adjust, but who cares?

2001-12-10  Akim Demaille  <akim@epita.fr>

	* src/muscle_tab.c (muscle_init): NULL is a better default than
	`"0"'.

2001-12-10  Akim Demaille  <akim@epita.fr>

	* src/reader.c (reader): Calling symbols_output once is enough.

2001-12-10  Akim Demaille  <akim@epita.fr>

	Now that states have a complete set of members, the linked list of
	reductions is useless: just fill directly the state's reductions
	member.

	* src/state.h (struct reductions): Remove member `number' and
	`next'.
	* src/LR0.c (first_reduction, last_reduction): Remove.
	(save_reductions): Don't link the new reductions, store them in
	this_state.
	* src/lalr.c (set_state_table): No need to attach reductions to
	states, it's already done.
	* src/output.c (output_actions): No longer free the shifts, then
	the reductions, then the states: free all the states and their
	members.

2001-12-10  Akim Demaille  <akim@epita.fr>

	* src/options.c (OPTN, DRTV, BOTH): New.
	(option_table): Use them.

	* src/muscle_tab.c: Don't include xalloc.h and string.h: that's
	the job of system.h.
	* src/options.c: Don't include stdio.h and xalloc.h for the same
	reasons.

2001-12-10  Akim Demaille  <akim@epita.fr>

	* src/output.c (output, prepare): Make sure the values of the
	muscles `action' and `prologue' are 0-terminated.

2001-12-10  Akim Demaille  <akim@epita.fr>

	Clean up GCC warnings.

	* src/reader.c (copy_action): `buf' is not used.
	(parse_skel_decl): Be static.
	* src/muscle_tab.c (mhash1, mhash2, muscle_insert): Preserve `const'.
	* src/options.h (create_long_option_table): Have a real prototype.
	* lib/hash.c, lib/hash.h (hash_insert, hash_insert_at, hash_delete)
	(hash_delete_at): Return const void *.
	Adjust casts to preserve the const.

2001-12-10  Akim Demaille  <akim@epita.fr>

	* configure.in: Require 2.52g.
	M4 is not needed, but AUTOM4TE is.
	* m4/m4.m4: Remove.
	* tests/Makefile.am: Adjust.

2001-12-10  Akim Demaille  <akim@epita.fr>

	One structure for states is enough, even though theoretically
	there are LR(0) states and LALR(1) states.

	* src/lalr.h (state_t): Remove.
	(state_table): Be state_t **, not state_t *.
	* src/state.h (core, CORE_ALLOC): Rename as...
	(state_t, STATE_ALLOC): this.
	Add the LALR(1) members: shifts, reductions, errs.
	* src/LR0.c (state_table): Rename as...
	(state_hash): this, to avoid name clashes with the global
	`state_table'.
	* src/print_graph.c, src/LR0.c, src/LR0.h, src/conflicts.c
	* src/lalr.c, src/lalr.h, src/output.c, src/print.c: Adjust.

2001-12-10  Akim Demaille  <akim@epita.fr>

	Bison dumps core on bash.y.
	Reported by Pascal Bart.

	* src/warshall.c (bitmatrix_print): New.
	(TC): Use it.
	When performing a transitive closure R(i, j) && R(j, k) => R(i,	k),
	j must be the outer loop.
	* tests/regression.at (Broken Closure): New.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* tests/atlocal.in (CPPFLAGS): Do not leave a space between -I and
	its argument.
	Reported by Peter Hmorsk.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/conflicts.c (err_table): Remove.
	(resolve_sr_conflict): Adjust.
	* src/lalr.h (state_t.reduction_table, state_t.shift_table):
	Rename as...
	(state_t.reductions, state_t.shifts): this.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/reduce.c (reduce_grammar_tables): No longer disable the
	removal of useless rules via CPP but via `if (0)', so that the
	compiler still check the code is valid.
	For instance, it should have noticed `rline' no longer exists: use
	the `line' member of rule_t.
	* src/gram.c (dummy, rline): Remove, unused.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/output.c (pack_vector): Use assert, not berror.
	* src/main.c (berror): Remove, unused.

2001-12-05  Akim Demaille  <akim@epita.fr>

	New experimental feature: if --verbose --trace output all the
	items of a state, not only its kernel.

	* src/print.c (print_core): If `trace_flag', then invoke closure
	before outputting the items of the state (print_core is no longer
	a correct name them).
	(print_results): Invoke new_closure/free_closure if needed.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/LR0.c (new_itemsets): Use nshifts only, not shiftcount.
	* src/closure.c, src/closure.h (itemsetsize): Rename as...
	(nitemset): for consistency with the rest of the project.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/closure.c (print_closure): Improve.
	(closure): Use it for printing input and output.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/closure.c (FIRSTS, FDERIVES): Adjust to reality: they are
	indexed by nonterminals.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/warshall.c (TC, RTC): De-obsfucate (source reduced to 22% of
	what it was!).
	* src/warshall.h: Remove accidental duplication of the content.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/closure.c (set_fderives): De-obfuscate.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/closure.c (print_firsts, print_fderives): De-obfuscate.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/closure.c (set_firsts): De-obfuscate.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/output.c (action_row): De-obfuscate
	using the good o' techniques: arrays not pointers, variable
	locality, BITISSET, RESETBIT etc.

2001-12-05  Akim Demaille  <akim@epita.fr>

	Pessimize the code to simplify it: from now on, all the states
	have a valid SHIFTS, which NSHIFTS is possibly 0.

	* src/LR0.c (shifts_new): Be global and move to..
	* src/state.c, src/state.h: here.
	* src/conflicts, src/lalr.c, src/output.c, src/print.c,
	* src/print_graph: Adjust.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/state.h (SHIFT_DISABLE, SHIFT_IS_DISABLED): New.
	* src/conflicts.c: Use it.
	Restore a few missing `if (!SHIFT_IS_DISABLED)' which were
	incorrectly ``simplified''.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/conflicts.c (flush_shift, resolve_sr_conflict): De-obfuscate
	using the good o' techniques: arrays not pointers, variable
	locality, BITISSET, RESETBIT etc.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/state.h (SHIFT_SYMBOL): New.
	* src/conflicts.c: Use it to deobfuscate.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/conflicts.c (count_sr_conflicts, count_rr_conflicts)
	(print_reductions): De-obfuscate using the good o' techniques:
	arrays not pointers, variable locality, BITISSET.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/conflicts.c (print_reductions): Arrays, not pointers.
	Use BITISSET.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/conflicts.c (print_reductions): Pessimize, but clarify.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/conflicts.c (print_reductions): Improve variable locality.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/conflicts.c (print_reductions): Pessimize, but clarify.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/conflicts.c (print_reductions): Improve variable locality.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/state.h (SHIFT_IS_ERROR, SHIFT_IS_GOTO, SHIFT_IS_SHIFT): New.
	* src/lalr.c: Use them.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/LR0.c (augment_automaton): Formatting changes.
	Better variable locality.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/lalr.c (matrix_print): New.
	(transpose): Use it.
	Use arrays instead of pointers.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/lalr.c (maxrhs): Move to...
	* src/gram.c, src/gram.h (ritem_longest_rhs): here.
	* src/lalr.c (build_relations): Adjust.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/lalr.c (transpose): Free the memory allocated to the
	argument, as it is replaced by the results by the unique caller.
	(build_relations): Merely invoke transpose: it handles the memory
	deallocation.
	Improve variable locality.
	Avoid variables used as mere abbreviations.
	(compute_lookaheads): Use arrays instead of pointers.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/lalr.c (initialize_F): Improve variable locality.
	Avoid variables used as mere abbreviations.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/derives.c (print_derives): Display the ruleno.
	* src/lalr.c (initialize_F, transpose): Better variable locality
	to improve readability.
	Avoid variables used as mere abbreviations.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/lalr.c (traverse): Use arrays instead of pointers.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/nullable.c (set_nullable): Use a for loop to de-obfuscate
	the handling of squeue.
	`symbol >= 0' is wrong now, use `rule_table[ruleno].useful'.

2001-12-05  Akim Demaille  <akim@epita.fr>

	Because useless nonterminals are now kept alive (instead of being
	`destroyed'), we now sometimes examine them, and store information
	related to them.  Hence we need to know their number, and adjust
	memory allocations.

	* src/reduce.c, src/reduce.h (nuseless_nonterminals): No longer
	static.
	* src/LR0.c (allocate_itemsets): The memory allocated to
	`symbol_count' was used for two different purpose: once to count
	the number of occurrences of each symbol, and later reassigned to
	`shift_symbol', containing the symbol that can be shifted from a
	given state.
	Deobfuscate, i.e., allocate, use and free `symbol_count' here
	only, and...
	(new_itemsets): Allocate `shift_symbol' here.
	(allocate_itemsets): symbol_count includes useless nonterminals.
	Make room for them.
	(free_storage): Use `free', not `XFREE', for pointers that cannot
	be null.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/nullable.c (set_nullable): Deobfuscate the handling of
	ritem.
	`symbol >= 0' is wrong now, use `rule_table[ruleno].useful'.

2001-12-05  Akim Demaille  <akim@epita.fr>

	* src/gram.c, src/gram.h (ritem_print): New.
	* src/gram.c (dummy): Remove, now there is actual code in gram.c.
	(This useless function was defined only to work around VMS linkers
	that can't handle compilation units with variables only).
	* src/reduce.c (dump_grammar): Use it to trace the construction of
	ritem.

2001-12-04  Paul Eggert  <eggert@twinsun.com>

	* src/bison.simple (union yyalloc): Change member names
	to be the same as the stack names.
	(yyparse): yyptr is now union yyalloc *, not char *.
	(YYSTACK_RELOCATE): Likewise.  This avoids a GCC warning,
	and may generate better code on some machines.
	(yystpcpy): Use prototype if __STDC__ is defined, not just
	if __cplusplus is defined.

2001-11-30  Akim Demaille  <akim@epita.fr>

	* configure.in (WARNING_CFLAGS): Add -Werror when possible.
	(CFLAGS): Do not include the WARNING_CFLAGS here, since GNU
	Gettext doesn't compile cleanly, and dies with -Werror.
	* src/Makefile.am, lib/Makefile.am, tests/atlocal.in (CFLAGS):
	Include WARNING_CFLAGS here.
	* lib/xstrdup.c: Include xalloc.h, so that xstrdup be declared
	before being defined.

2001-11-27  Paul Eggert  <eggert@twinsun.com>

	* lib/quotearg.h (quotearg_n, quotearg_n_style):
	First arg is int, not unsigned.
	* lib/quotearg.c (quotearg_n, quotearg_n_style): Likewise.
	(SIZE_MAX, UINT_MAX): New macros.
	(quotearg_n_options): Abort if N is negative.
	Avoid overflow check on hosts where size_t is 64 bits and int
	is 32 bits, as overflow is impossible there.
	Fix off-by-one typo that caused unnecessary reallocation.

2001-11-29  Paul Eggert  <eggert@twinsun.com>

	Name space cleanup in generated parser.

	* doc/bison.texinfo (Bison Parser): Discuss system headers
	and their effect on the user name space.

	* src/bison.simple:
	(YYSTACK_ALLOC, YYSTACK_FREE, union yyalloc, YYSTACK_GAP_MAX,
	YYSTACK_BYTES, YYSTACK_RELOCATE): Do not define unless necessary,
	i.e. unless ! defined (yyoverflow) || defined (YYERROR_VERBOSE).

	(YYSIZE_T): New macro.  Use it instead of size_t, to avoid infringing
	on user names when possible.

	(YYSTACK_USE_ALLOCA): Do not define; just use any existing defn.
	Simplify test for whather <alloca.h> exists.

	(<stdlib.h>): Include if we will use malloc, and if standard C or C++.

	(<stdio.h>): Include if YYDEBUG.

	(yymemcpy): Renamed from __yy_memcpy.  Do not define unless
	! defined (yyoverflow) && ! defined (yymemcpy).

	(yymemcpy, yyparse): Rename local variables as needed so that
	they all begin with 'yy'.

	(yystrlen, yystpcpy): New functions.

	(YY_DECL_NON_LSP_VARIABLES): Renamed from _YY_DECL_VARIABLES.
	All uses changed.

	(yyparse): size_t -> YYSIZE_T.  Use yystrlen and yystpcpy
	instead of relying on string.h functions.  Use YYSTACK_ALLOC
	and YYSTACK_FREE instead of malloc and free.

2001-11-30  Akim Demaille  <akim@epita.fr>

	* src/bison.simple (YYSTYPE, YYLTYPE): Move their definitions
	before their first uses.
	(YYBISON, YYPURE): Move to the top of the output.

2001-11-30  Akim Demaille  <akim@epita.fr>

	* tests/reduce.at (Useless Nonterminals): Fix.

2001-11-30  Akim Demaille  <akim@epita.fr>

	* src/bison.simple (YYSTACK_FREE): Use `do {;} while (0)' as empty
	if body instead of `;' to pacify GCC's warnings.

2001-11-30  Akim Demaille  <akim@epita.fr>

	Instead of mapping the LHS of unused rules to -1, keep the LHS
	valid, but flag the rules as invalid.

	* src/gram.h (rule_t): `useful' is a new member.
	* src/print.c (print_grammar): Adjust.
	* src/derives.c (set_derives): Likewise.
	* src/reader.c (packgram, reduce_output): Likewise.
	* src/reduce.c (reduce_grammar_tables): Likewise.
	* tests/reduce.at (Underivable Rules, Useless Rules): New.

2001-11-30  Akim Demaille  <akim@epita.fr>

	* src/reduce.c (reduce_output): Formatting changes.
	* src/print.c (print_results, print_grammar): Likewise.
	* tests/regression.at (Rule Line Numbers)
	(Solved SR Conflicts, Unresolved SR Conflicts): Adjust.

2001-11-30  Akim Demaille  <akim@epita.fr>

	* src/reduce.c (nonterminals_reduce): Instead of throwing away
	useless nonterminals, move them at the end of the symbol arrays.
	(reduce_output): Adjust.
	* tests/reduce.at (Useless Nonterminals): Adjust.

2001-11-30  Akim Demaille  <akim@epita.fr>

	* src/reduce.c: Various comment/formatting changes.
	(nonterminals_reduce): New, extracted from...
	(reduce_grammar_tables): here.
	(reduce_grammar): Call nonterminals_reduce.

2001-11-29  Paul Eggert  <eggert@twinsun.com>

	* src/bison.simple (YYSTACK_REALLOC): Remove.
	(YYSTACK_ALLOC): Resurrect this macro, with its old meaning.
	(YYSTACK_FREE, YYSTACK_GAP_MAX, YYSTACK_BYTES, YYSTACK_RELOCATE):
	New macros.
	(union yyalloc): New type.
	(__yy_memcpy): Last arg is size_t, not unsigned int, to remove
	an arbitrary restriction on hosts where size_t is wider than int.

	(yyparse): Don't dump core if alloca or malloc fails; instead, report
	a parser stack overflow.  Allocate just one block of memory for all
	three stacks, instead of allocating three blocks; this typically is
	faster and reduces fragmentation.

	Do not limit the number of items in the stack to a value that fits
	in 'int', as this is an arbitrary limit on hosts with 64-bit
	size_t and 32-bit int.

2001-11-29  Marc Autret  <autret_m@epita.fr>

	* tests/calc.at [AT_DATA_CALC_Y]: Use %error-verbose instead
	of defining YYERROR_VERBOSE.
	[AT_DATA]: $4 is now out of C declarations in the prologue.

2001-11-28  Marc Autret  <autret_m@epita.fr>

	* src/reader.c (parse_dquoted_param): New.
	(parse_skel_decl): Use it.
	* src/lex.h: Add its prototype.
	* src/lex.c (literalchar): Become not static.

2001-11-28  Marc Autret  <autret_m@epita.fr>

	* src/output.h: And put its extern declaration here.
	* src/output.c (error_verbose): Define here.
	(prepare): Echo name modification.
	* src/getargs.h: Clean its extern declaration.
	* src/getargs.c (error_verbose_flag): Remove.
	(getargs): Remove case 'e'.
	* src/options.c (option_table): 'error-verbose' is now seen as simple
	percent option.
	Include output.h.

	* src/reader.c (read_declarations): Remove case tok_include.
	(parse_include_decl): Remove.
	* src/lex.h (token_t): Remove tok_include.
	* src/options.c (option_table): 'include' is now a simple command line
	option.

2001-11-28  Marc Autret  <autret_m@epita.fr>

	* src/bison.simple: Adjust muscle names.
	* src/muscle_tab.c (muscle_init): Also rename the muscles.
	* src/output.c (prepare): s/_/-/ for the muscles names.
	(output_parser): When scanning for a muscle, allow '-' instead of '_'.

2001-11-28  Marc Autret  <autret_m@epita.fr>

	* src/bison.simple: Fix debug.
	[YYERROR_VERBOSE]: Re-integrate as an internal macro.

2001-11-28  Akim Demaille  <akim@epita.fr>

	* src/LR0.c (shifts_new): New.
	(save_shifts, insert_start_shift, augment_automaton): Use it.

2001-11-28  Akim Demaille  <akim@epita.fr>

	* src/closure.c (closure): `b' and `ruleno' denote the same value:
	keep ruleno only.

2001-11-28  Akim Demaille  <akim@epita.fr>

	* src/closure.c (closure): Instead of looping over word in array
	then bits in words, loop over bits in array.

2001-11-28  Akim Demaille  <akim@epita.fr>

	* src/closure.c (closure): No longer optimize the special case
	where all the bits of `ruleset[r]' are set to 0, to make the code
	clearer.

2001-11-28  Akim Demaille  <akim@epita.fr>

	* src/closure.c (closure): `r' and `c' are new variables, used to
	de-obfuscate accesses to RULESET and CORE.

2001-11-28  Akim Demaille  <akim@epita.fr>

	* src/reduce.c (reduce_print): Use ngettext.
	(dump_grammar): Improve the trace accuracy.

2001-11-28  Akim Demaille  <akim@epita.fr>

	* src/reduce.c (dump_grammar): Don't translate trace messages.

2001-11-28  Akim Demaille  <akim@epita.fr>

	* tests/reduce.at (Useless Terminals, Useless Nonterminals): New.
	* src/reduce.c (reduce_grammar_tables): Do not free useless tags,
	as all tags are free'ed afterwards.
	From Enrico Scholz.

2001-11-27  Paul Eggert  <eggert@twinsun.com>

	* src/bison.simple (YYSTACK_REALLOC): Fix typo that caused us to
	use alloca when we didn't want to, and vice versa.

2001-11-27  Marc Autret  <autret_m@epita.fr>

	* src/muscle_tab.c (muscle_init): Remove 'verbose' muscle
	initialization.
	* src/output.c (prepare): Remove its update.

2001-11-27  Marc Autret  <autret_m@epita.fr>

	* tests/torture.at [AT_DATA]: Remove YYERROR_VERBOSE definition.
	Use %error-verbose.

2001-11-27  Marc Autret  <autret_m@epita.fr>

	* src/bison.simple: Remove YYERROR_VERBOSE using.
	Use %%error_verbose.
	(yyparse): Likewise.
	* src/output.c (prepare): Give its final value.
	* src/muscle_tab.c (muscle_init): Init new muscle 'error_verbose'.
	* src/getargs.h: Add its extern declaration.
	* src/getargs.c (error_verbose_flag): New int.
	(getargs): Update to catch new case.
	* src/options.c (option_table): 'error-verbose' is a new option.
	(shortopts): Update.

2001-11-27  Akim Demaille  <akim@epita.fr>

	* src/system.h: Use intl/libgettext.h.
	* src/Makefile.am (INCLUDES): Add -I $(top_srcdir).

2001-11-27  Akim Demaille  <akim@epita.fr>

	* tests/torture.at (Exploding the Stack Size with Malloc):
	s/YYSTACK_USE_ALLOCA_ALLOCA/YYSTACK_USE_ALLOCA/.

2001-11-27  Akim Demaille  <akim@epita.fr>

	* src/files.c: Include error.h.
	Reported by Hans Aberg.

2001-11-26  Marc Autret  <autret_m@epita.fr>

	* src/reader.c (parse_include_decl): New, not yet implemented.
	(read_declarations): Add case tok_include.
	* src/getargs.h (include): Add its extern definition.
	* src/getargs.c (include): New const char *.
	(getargs): Add case '-I'.
	* src/options.c (option_table): Add include as command line and
	percent option.
	* src/lex.h (token_t): Add tok_include.

2001-11-26  Akim Demaille  <akim@epita.fr>

	* src/reader.c (readgram): Make sure rules for mid-rule actions
	have a lineno equal to that of their host rule.
	Reported by Hans Aberg.
	* tests/regression.at (Rule Line Numbers): New.

2001-11-26  Akim Demaille  <akim@epita.fr>

	* src/LR0.c (allocate_itemsets): kernel_size contains ints, not
	size_ts.

2001-11-26  Akim Demaille  <akim@epita.fr>

	* src/complain.c, src/complain.h (error): Remove, provided by
	lib/error.[ch].

2001-11-26  Akim Demaille  <akim@epita.fr>

	* src/reader.c (read_declarations): Don't abort on tok_illegal,
	issue an error message.
	* tests/regression.at (Invalid %directive): New.
	Reported by Hans Aberg.

2001-11-26  Akim Demaille  <akim@epita.fr>

	* configure.in: Invoke AC_FUNC_OBSTACK and AC_FUNC_ERROR_AT_LINE.
	* lib/Makefile.am (libbison_a_SOURCES): Adjust.

2001-11-26  Akim Demaille  <akim@epita.fr>

	* src/conflicts.c (conflicts_print): Don't complain at all when
	there are no reduce/reduce conflicts, and as many shift/reduce
	conflicts as expected.
	* tests/regression.at (%expect right): Adjust.

2001-11-23  Akim Demaille  <akim@epita.fr>

	* lib/alloca.c: Update, from fileutils.

2001-11-23  Akim Demaille  <akim@epita.fr>

	* lib/Makefile.am (libbison_a_LIBADD): Add @ALLOCA@.

2001-11-23  Akim Demaille  <akim@epita.fr>

	* src/system.h: Include alloca.h.
	* src/main.c (main) [C_ALLOCA]: Call alloca (0).

2001-11-23  Akim Demaille  <akim@epita.fr>

	* src/print_graph.c (print_actions): Remove `rule', unused.
	* src/LR0.c (kernel_size): Contain `int' instead of `size_t' to
	pacify GCC's signed < unsigned warnings.
	* src/closure.c (itemsetsize): Likewise.
	* src/reader.c (symbol_list_new): Static.

2001-11-23  Akim Demaille  <akim@epita.fr>

	Attaching lineno to buckets is stupid, since only one copy of each
	symbol is kept, only the line of the first occurrence is kept too.

	* src/symtab.h, src/symtab.c (bucket): Remove the line member.
	* src/reader.c (rline_allocated): Remove, unused.
	(symbol_list): Have a `line' member.
	(symbol_list_new): New.
	(readgram): Use it.
	* src/print.c (print_grammar): Output the rule line numbers.
	* tests/regression.at (Solved SR Conflicts)
	(Unresolved SR Conflicts): Adjust.
	Reported by Hans Aberg.

2001-11-22  Marc Autret  <autret_m@epita.fr>

	* src/bison.simple [YYERROR_VERBOSE]: Force its value to be 1 or 0.

2001-11-22  Marc Autret  <autret_m@epita.fr>

	* src/muscle_tab.c (muscle_init): Remove initialization of
	skeleton muscle.
	* src/output.c (output_master_parser): Do it here.

2001-11-20  Akim Demaille  <akim@epita.fr>

	* po/sv.po: New.
	* configure.in (ALL_LINGUAS): Adjust.
	* po/POTFILE.in: Remove `nullable.c' and `derives.c' which no
	longer contains strings to translate.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/conflicts.c (conflicts_print): Add a missing \n.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/nullable.c (nullable_print): New.
	(set_nullable): Call it when tracing.
	Better locality of variables.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/print.c (print_actions): Better locality of variables.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/derives.c (print_derives): Fix and enrich.
	* src/closure.c (print_fderives): Likewise.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/closure.c (itemsetend): Remove, replaced with...
	(itemsetsize): new.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/LR0.c (kernel_end): Remove, replaced with...
	(kernel_size): new.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/conflicts.c (set_conflicts): Use arrays instead of pointers
	to clarify.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/closure.c (closure): Use arrays instead of pointers to clarify.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/closure.c, src/derives.c, src/nullable.c: Adjust various
	trace messages.
	* src/LR0.c: Likewise.
	(allocate_itemsets): Use arrays instead of pointers to clarify.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/getargs.c (statistics_flag): Replace with...
	(trace_flag): New.
	(longopts): Accept --trace instead of --statistics.
	* src/getargs.h, src/options.c: Adjust.
	* src/LR0.c, src/closure.c, src/derives.c, src/nullable.c,
	* src/reduce.c: Use trace_flags instead of the CPP conditional TRACE.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/LR0.c (new_itemsets, get_state): Use more arrays and fewer
	pointers to clarify the code.
	(save_reductions, save_shifts): Factor common parts of alternatives.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/LR0.c (new_state, get_state): Complete TRACE code.
	* src/closure.c: Include `reader.h' to get `tags', needed by the
	trace code.
	Rename the conditional DEBUG as TRACE.
	Output consistently TRACEs to stderr, not stdout.
	* src/derives.c: Likewise.
	* src/reduce.c: (inaccessable_symbols): Using if is better style
	than goto.
	Use `#if TRACE' instead of `#if 0' for tracing code.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/system.h (LIST_FREE, shortcpy): New.
	* src/LR0.c: Use them.
	* src/output.c (free_itemsets, free_reductions, free_shifts):
	Remove, replaced by LIST_FREE.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/state.h (CORE_ALLOC, SHIFTS_ALLOC, ERRS_ALLOC)
	(REDUCTIONS_ALLOC):  New.
	* src/LR0.c, src/conflicts.c: Use them to de-obfuscate memory
	allocation.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/LR0.c (new_state): Complete trace code.
	* src/nullable.c (set_nullable): Don't translate traces.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/print_graph.c (print_core): Better locality of variables.
	* src/print.c (print_core): Likewise.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/vcg.c: You do the output, so you are responsible of the
	handling of VCG syntax, in particular: use quotearg.
	* src/print_graph.c: Don't.
	(print_actions): Don't output the actions as part of the nodes,
	since that's the job of the edges.
	(print_state): Don't output by hand: fill the node description,
	and ask for its output.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/bison.simple (yyparse): When verbosely reporting an error,
	no longer put additional quotes around token names.
	* tests/calc.at: Adjust.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/symtab.h, src/symtab.c: `line' is a new member of `bucket'.
	* src/reader.c (record_rule_lines, rline, rline_allocated): Remove.
	* src/output.c: Adjust.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/gram.h (rprec, rprecsym, rassoc): Remove, now part of...
	(rule_t): this.
	* src/conflicts.c, src/reader.c, src/reduce.c: Adjust.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/gram.h (rule_t): New.
	(rule_table): New.
	(rrhs, rlhs): Remove, part of state_t.
	* src/print_graph.c, src/closure.c, src/conflicts.c, src/derives.c,
	* src/lalr.c, src/nullable.c, src/output.c, src/print.c,
	* src/reader.c, src/reduce.c: Adjust.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/reader.c (symbols_output): New, extracted from...
	(packsymbols): Here.
	(reader): Call it.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/lalr.c (set_maxrhs, maxrhs): Remove, replaced with...
	(maxrhs): this new function.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/lalr.c (F): New macro to access the variable F.
	Adjust.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/lalr.h (LA): New macro to access the variable LA.
	* src/output.c, src/lalr.c, src/print_graph.c, src/conflicts.c:
	* src/lalr.c: Adjust.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/lalr.c (initialize_LA): Only initialize LA.  Let...
	(set_state_table): handle the `lookaheads' members.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/lalr.h (lookaheads): Removed array, whose contents is now
	a member of...
	(state_t): this structure.
	* src/output.c, src/lalr.c, src/print_graph.c, src/conflicts.c:
	Adjust.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/lalr.h (consistent): Removed array, whose contents is now
	a member of...
	(state_t): this structure.
	* src/output.c, src/lalr.c, src/print_graph.c, src/conflicts.c:
	Adjust.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/lalr.h (reduction_table, shift_table): Removed arrays, whose
	contents are now members of...
	(state_t): this structure.
	* src/output.c, src/lalr.c, src/print_graph.c, src/conflicts.c:
	Adjust.

2001-11-19  Akim Demaille  <akim@epita.fr>

	* src/lalr.h (state_t): New.
	(state_table): Be a state_t * instead of a core **.
	(accessing_symbol): Remove, part of state_t.
	* src/lalr.c: Adjust.
	(set_accessing_symbol): Merge into...
	(set_state_table): this.
	* src/print_graph.c, src/conflicts.c: Adjust.

2001-11-14  Akim Demaille  <akim@epita.fr>

	* tests/calc.at, tests/output.at, tests/regression.at,
	* tests/testsuite.at, tests/torture.at: Rely on Autotest 2.52g:
	now the tests are run in private dirs, therefore AC_CLEANUP and
	family can be simplified to 0-ary.
	* tests/atlocal.in: Now that we run `elsewhere' than in tests/,
	use abs. path to find config.h.
	* tests/calc.at (AT_CHECK_CALC): Don't try to check the compiler's
	stderr, there can be way too much random noise.
	Instead pass -Werror to GCC and rely on the exit status.
	Reported by Wolfram Wagner.

2001-11-14  Akim Demaille  <akim@epita.fr>

	* src/bison.simple (yyparse): Let yyls1, yyss1 and yyvs1 be
	defined only if yyoverflow is defined, to avoid `warning: unused
	variable `yyvs1''.
	Reported by The Test Suite.

2001-11-14  Akim Demaille  <akim@epita.fr>

	* src/print.c: Include reduce.h.
	Reported by Hans Aberg.

2001-11-14  Akim Demaille  <akim@epita.fr>

	* src/lex.c, src/lex.h (token_buffer, unlexed_token_buffer):
	Revert a previous patch:  these are really const.
	* src/conflicts.c (conflict_report): Additional useless pair of
	braces to pacify GCC's warnings for `if () if () {} else {}'.
	* src/lex.c (parse_percent_token): Replace equal_offset with
	arg_offset.
	arg is const.
	Be sure to strdup `arg' when used, since there is no reason for
	token_buffer not to change.

2001-11-14  Akim Demaille  <akim@epita.fr>

	* src/system.h (EXIT_SUCCESS, EXIT_FAILURE): Ensure a proper
	definition.
	* src/main.c (main): Use them.
	Suggested by Hans Aberg.

2001-11-12  Akim Demaille  <akim@epita.fr>

	* src/system.h (ngettext): Now that we use ngettext, be sure to
	provide a default definition when NLS are not used.

2001-11-12  Akim Demaille  <akim@epita.fr>

	* doc/bison.texinfo: Use `$' as shell prompt, not `%'.
	Use @kbd to denote user input.
	(Language and Grammar): ANSIfy the example.
	Adjust its layout for info/notinfo.
	(Location Tracking Calc): Output error messages to stderr.
	Output locations in a more GNUtically correct way.
	Fix a couple of Englishos.
	Adjust @group/@end group pairs.

2001-11-12  Akim Demaille  <akim@epita.fr>

	%expext was not functioning at all.

	* src/conflicts.c (expected_conflicts): Set to -1.
	(conflict_report): Use ngettext.
	(conflicts_print): Check %expect and make its violation an error.
	* doc/bison.texinfo (Expect Decl): Adjust.
	* configure.in (AM_GNU_GETTEXT): Ask for ngettext.
	* tests/regression.at (%expect not enough, %expect right)
	(%expect too much): New.

2001-11-12  Akim Demaille  <akim@epita.fr>

	* tests/regression.at (Conflicts): Rename as...
	(Unresolved SR Conflicts): this.
	(Solved SR Conflicts): New.

2001-11-12  Akim Demaille  <akim@epita.fr>

	* src/reduce.c (print_results): Rename as...
	(reduce_output): This.
	Output to OUT, passed as argument, instead of output_obstack.
	(dump_grammar): Likewise.
	(reduce_free): New.
	Also free V1.
	(reduce_grammar): No longer call reduce_output, since...
	* src/print.c (print_results): do it.
	* src/main.c (main): Call reduce_free;

2001-11-12  Akim Demaille  <akim@epita.fr>

	* src/conflicts.c (print_reductions): Accept OUT as argument.
	Output to it, not to output_obstack.
	* src/print.c (print_actions): Adjust.

2001-11-12  Akim Demaille  <akim@epita.fr>

	* src/conflicts.c (count_sr_conflicts, count_rr_conflicts): Return
	the result instead of using...
	(src_total, rrc_total, src_count, rrc_count): Remove.
	(any_conflicts): Remove.
	(print_conflicts): Split into...
	(conflicts_print, conflicts_output): New.
	* src/conflicts.h: Adjust.
	* src/main.c (main): Invoke both conflicts_output and conflicts_print.
	* src/print.c (print_grammar): Issue `\n' between two rules.
	* tests/regression.at (Conflicts): New.
	Reported by Tom Lane.

2001-11-12  Akim Demaille  <akim@epita.fr>

	* tests/regression.at (Invalid input): Remove, duplicate with
	``Invalid input: 1''.

2001-11-12  Akim Demaille  <akim@epita.fr>

	* tests/torture.at (AT_DATA_STACK_TORTURE)
	(Exploding the Stack Size with Alloca)
	(Exploding the Stack Size with Malloc): New.

2001-11-12  Akim Demaille  <akim@epita.fr>

	* src/bison.simple (YYSTACK_REALLOC): New.
	(yyparse) [!yyoverflow]: Use it and free the old stack.
	Reported by Per Allansson.

2001-11-12  Pascal Bart  <pascal.bart@epita.fr>

	* src/bison.simple: Define type yystype instead of YYSTYPE, and
	define CPP macro, which substitute YYSTYPE by yystype.
	* src/reader.c (parse_union_decl): Output yystype/YYSTYPE as we do
	with yyltype/YYLTYPE.  This allows inclusion of the generated
	header within the parser if the compiler, such as GGC, accepts
	multiple equivalent #defines.
	From Akim.

2001-11-05  Akim Demaille  <akim@epita.fr>

	* src/reader.c (symbols_output): New, extracted from...
	(packsymbols): here.
	(reader): Adjust.

2001-11-05  Akim Demaille  <akim@epita.fr>

	* src/lex.c (parse_percent_token): s/quotearg/quote/.

2001-11-05  Akim Demaille  <akim@epita.fr>

	* tests/regression.at (AT_TEST_CPP_GUARD_H): Adjust the clean up
	pattern.

2001-11-05  Akim Demaille  <akim@epita.fr>

	* src/options.h (struct option_table_struct): set_flags is void*.
	* src/options.c (longopts): Support `--output' and `%output'.
	(usage): Adjust.
	* src/lex.h (tok_setopt): Remove, replaced with...
	(tok_intopt, tok_stropt): these new guys.
	* src/lex.c (getopt.h): Not needed.
	(token_buffer, unlexed_token_buffer): Not const.
	(percent_table): Promote `-' over `_' in directive names.
	Active `%name-prefix', `file-prefix', and `output'.
	(parse_percent_token): Accept possible arguments to directives.
	Promote `-' over `_' in directive names.

2001-11-04  Akim Demaille  <akim@epita.fr>

	* doc/bison.texinfo (Decl Summary): Split the list into
	`directives for grammars' and `directives for bison'.
	Sort'em.
	Add description of `%name-prefix', `file-prefix', and `output'.
	Promote `-' over `_' in directive names.
	(Bison Options): s/%locactions/%locations/.  Nice Freudian slip.
	Simplify the description of `--name-prefix'.
	Promote `-' over `_' in directive names.
	Promote `--output' over `--output-file'.
	Fix the description of `--defines'.
	* tests/output.at: Exercise %file-prefix and %output.

2001-11-02  Akim Demaille  <akim@epita.fr>

	* doc/refcard.tex: Update.

2001-11-02  Akim Demaille  <akim@epita.fr>

	* src/symtab.h (SUNDEF): New.
	* src/symtab.c (bucket_new): Init user_token_number to SUNDEF to
	stand for `uninitialized', instead of 0.
	* src/reader.c (packsymbols, parse_thong_decl): Adjust.
	* src/lex.c (lex): Adjust.

	* tests/calc.at (_AT_DATA_CALC_Y): Declare a token for EOF.
	Number it 0.
	Let yylex return it instead of a plain 0.
	Reported by Dick Streefland.

2001-11-02  Akim Demaille  <akim@epita.fr>

	* tests/regression.at (Mixing %token styles): New test.

2001-11-02  Akim Demaille  <akim@epita.fr>

	* src/reader.c (parse_thong_decl): Formatting changes.
	(token_translations_init): New, extracted from...
	(packsymbols): Here.
	Adjust.

2001-11-01  Akim Demaille  <akim@epita.fr>

	* tests/regression.at (AT_TEST_CPP_GUARD_H): New.
	Check that `9foo.y' produces correct cpp guards.
	* src/files.c (compute_header_macro): Prepend `BISON_' to CPP
	guards.
	Reported by Wwp.

2001-11-01  Akim Demaille  <akim@epita.fr>

	* tests/regression.at (Invalid input: 2): New.
	* src/lex.c (unlexed_token_buffer): New.
	(lex, unlex): Adjust: when unlexing, be sure to save token_buffer
	too.
	Reported by Wwp.

2001-11-01  Akim Demaille  <akim@epita.fr>

	* tests/calc.at: Catch up with 1.30.
	* configure.in: Bump to 1.49a.
	Adjust to newer Autotest.

2001-10-19  Pascal Bart  <pascal.bart@epita.fr>

	* src/conflicts.c: Move global variables rrc_total and src_total ...
	(print_conflicts): here.
	* src/output.c (output): Free global variable user_toknums.
	* src/lex.c (token_obstack): Become static.

2001-10-18  Akim Demaille  <akim@epita.fr>

	* tests/atlocal.in (GCC): Add.
	* tests/calc.at: s/m4_match/m4_bmatch/.
	s/m4_patsubst/m4_bpatsubst/.
	(AT_CHECK_CALC): Check the compiler's stderr only if it's GCC.
	* configure.in: AC_SUBST(GCC).

2001-10-14  Marc Autret  <autret_m@epita.fr>

	* src/options.c (create_long_option_table): Fix.

2001-10-10  Akim Demaille  <akim@epita.fr>

	* src/bison.simple: Be sure to set YYSTACK_USE_ALLOCA.

2001-10-04  Akim Demaille  <akim@epita.fr>

	* src/reader.c (parse_union_decl): Push the caracters in
	union_obstack, not attrs_obstack.

2001-10-04  Akim Demaille  <akim@epita.fr>

	Merge in the branch 1.29.

	* src/reader.c (packsymbols): Use a temporary obstack for
	`%%tokendef', since output_stack is already used elsewhere.

	2001-10-02  Akim Demaille  <akim@epita.fr>

	Bump 1.29d.

	2001-10-02  Akim Demaille  <akim@epita.fr>

	Version 1.29c.

	2001-10-02  Akim Demaille  <akim@epita.fr>

	* tests/regression.at (Invalid CPP headers): New.
	From Alexander Belopolsky.
	* src/files.c (compute_header_macro): Map non alnum chars to `_'.

	2001-10-02  Akim Demaille  <akim@epita.fr>

	* tests/regression.at (Invalid input): New.
	* src/lex.c (lex): Be sure to set `token_buffer' in any case.
	Reported by Shura.

	2001-10-02  Akim Demaille  <akim@epita.fr>

	* tests/calc.at: Now that --debug works, the tests must be adjusted.

	2001-10-02  Akim Demaille  <akim@epita.fr>

	* src/output.c (output_parser): Assert `skeleton'.
	* src/files.c (skeleton_find): Look harder for skeletons on DOSish
	systems.
	From Shura.

	2001-10-01  Marc Autret  <autret_m@epita.fr>

	* src/lex.h: Echo modifications.
	* src/lex.c (unlex): Parameter is now token_t.
	From Hans Aberg.

	2001-10-01  Marc Autret  <autret_m@epita.fr>

	* src/main.c: Include lex.h.
	From Hans Aberg.

	2001-09-29  Akim Demaille  <akim@epita.fr>

	* src/getargs.c (longopts): `--debug' is `-t', not `-d'.

	2001-09-28  Akim Demaille  <akim@epita.fr>

	* tests/testsuite.at: Update to newer Autotest.
	* tests/Makefile.am (EXTRA_DIST): bison is not to be shipped.

	2001-09-27  Akim Demaille  <akim@epita.fr>

	Position independent wrapper.

	* tests/bison: Remove.
	* tests/bison.in: New.
	* configure.in: Adjust.

	2001-09-27  Paul Eggert  <eggert@twinsun.com>

	Port quotearg fixes from tar 1.13.24.

	* lib/quotearg.c: BSD/OS 4.1 wchar.h requires FILE and struct
	tm to be declared.
	(HAVE_MBSINIT): Undef if !HAVE_MBRTOWC.
	(mbsinit): Define to 1 if !defined mbsinit && !HAVE_MBSINIT.

	* m4/Makefile.am (EXTRA_DIST): Add mbrtowc.m4.
	* m4/mbrtowc.m4: New file.
	* m4/prereq.m4 (jm_PREREQ_QUOTEARG): Check for mbsinit and stddef.h.
	Use jm_FUNC_MBRTOWC instead of AC_CHECK_FUNCS(mbrtowc).

	2001-09-27  Akim Demaille  <akim@epita.fr>

	Bump to 1.29c.

	2001-09-27  Akim Demaille  <akim@epita.fr>

	Version 1.29b.

	2001-09-25  Akim Demaille  <akim@epita.fr>

	* src/system.h: Include `xalloc.h'.
	Remove it from the C files.
	* src/files.c (output_files): Free the obstacks.
	* src/lex.c (init_lex): Rename as...
	(lex_init): this.
	(lex_free): New.
	* src/main.c (main): Use it.

	2001-09-24  Marc Autret  <autret_m@epita.fr>

	* src/vcg.c (open_edge, close_edge, open_node, close_node): Change
	to output informations in fout (FILE*).
	(open_graph, close_graph): Likewise.
	(output_graph, output_edge, output_node): Likewise.
	* src/vcg.h: Update function prototypes.
	* src/print_graph.c (print_graph): Open output graph file.
	(print_actions): Adjust.
	* src/files.h: Remove extern declaration.
	* src/files.c: Remove graph_obstack declaration.
	(open_files): Remove graph_obstack initialization.
	(output_files): Remove graph_obstack saving.

	2001-09-24  Marc Autret  <autret_m@epita.fr>

	* src/files.c (compute_output_file_names): Fix.

	2001-09-24  Marc Autret  <autret_m@epita.fr>,
		    Akim Demaille  <akim@epita.fr>

	* src/reader.c (reader): Remove call to free_symtab ().
	* src/main.c (main): Call it here.
	Include symtab.h.
	* src/conflicts.c (initialize_conflicts): Rename as...
	(solve_conflicts): this.
	* src/print.c (print_core, print_actions, print_state)
	(print_grammar): Dump to a file instead a `output_obstack'.
	(print_results): Dump `output_obstack', and then proceed with the
	FILE *.
	* src/files.c (compute_output_file_names, close_files): New.
	(output_files): Adjust.
	* src/main.c (main): Adjust.

	2001-09-23  Marc Autret  <autret_m@epita.fr>

	* src/files.c (compute_header_macro): Computes header macro name
	from spec_defines_file when given.

	2001-09-23  Marc Autret  <autret_m@epita.fr>

	* src/files.c (output_files): Add default extensions.

	2001-09-22  Akim Demaille  <akim@epita.fr>

	* src/conflicts.c (finalize_conflicts): Rename as...
	(free_conflicts): this.

	2001-09-22  Akim Demaille  <akim@epita.fr>

	* src/gram.c (gram_free): Rename back as...
	(dummy): this.
	(output_token_translations): Free `token_translations'.
	* src/symtab.c (free_symtab): Free the tag field.

	2001-09-22  Akim Demaille  <akim@epita.fr>

	Remove `translations' as it is always set to true.

	* src/gram.h: Adjust.
	* src/reader.c (packsymbols, parse_token_decl): Adjust
	* src/print.c (print_grammar): Adjust.
	* src/output.c (output_token_translations): Adjust.
	* src/lex.c (lex): Adjust.
	* src/gram.c: Be sure the set pointers to NULL.
	(dummy): Rename as...
	(gram_free): this.

	2001-09-22  Akim Demaille  <akim@epita.fr>

	* configure.in: Invoke AM_LIB_DMALLOC.
	* src/system.h: Use dmalloc.
	* src/LR0.c: Be sure to have pointers initialized to NULL.
	(allocate_itemsets): Allocate kernel_items only if needed.

	2001-09-22  Akim Demaille  <akim@epita.fr>

	* configure.in: Bump to 1.29b.
	* tests/Makefile.am (DISTCLEANFILES): Add package.m4.
	* tests/calc.at (_AT_DATA_CALC_Y): #undef malloc so that we don't
	need xmalloc.c in calc.y.
	From Pascal Bart.

	2001-09-21  Akim Demaille  <akim@epita.fr>

	Version 1.29a.
	* Makefile.maint, config/config.guess, config/config.sub,
	* config/missing: Update from masters.
	* tests/Makefile.am ($(srcdir)/$(TESTSUITE)): No longer depend
	upon package.m4.
	* configure.in (ALL_LINGUAS): Add `tr'.

	2001-09-21  Akim Demaille  <akim@epita.fr>

	* tests/Makefile.am (package.m4): Move to...
	($(srcdir)/$(TESTSUITE)): here.

	2001-09-20  Akim Demaille  <akim@epita.fr>

	* src/complain.c: No longer try to be standalone: use system.h.
	Don't assume __STDC__ is defined to 1. Just test if it is defined.
	* src/complain.h: Likewise.
	* src/reduce.c (useless_nonterminals, inaccessable_symbols):
	Remove the unused variable `n'.
	From Albert Chin-A-Young.

	2001-09-18  Marc Autret  <autret_m@epita.fr>

	* doc/bison.1: Update.
	* doc/bison.texinfo (Bison Options): Update --defines and --graph
	descriptions.
	(Option Cross Key): Update.
	Add --graph.

	2001-09-18  Marc Autret  <autret_m@epita.fr>

	* tests/regression.at: New test (comment in %union).

	2001-09-18  Marc Autret  <autret_m@epita.fr>

	* src/reader.c (parse_union_decl): Do not output '/'. Let copy_comment
	do that.
	Reported by Keith Browne.

	2001-09-18  Marc Autret  <autret_m@epita.fr>

	* tests/output.at: Add tests for --defines and --graph.

	2001-09-18  Marc Autret  <autret_m@epita.fr>

	* tests/output.at: Removes tests of %{header,src}_extension features.

	2001-09-18  Akim Demaille  <akim@epita.fr>

	* tests/Makefile.am (package.m4): New.
	* tests/calc.at (_AT_CHECK_CALC): Just run `calc input'.
	(_AT_CHECK_CALC_ERROR): Likewise.
	Factor the `, ' part of verbose error messages.

	2001-09-18  Marc Autret  <autret_m@epita.fr>

	* src/getargs.c (longopts): Declare --defines and --graph as options
	with optional arguments.
	* src/files.h: Add extern declarations.
	* src/files.c (spec_graph_file, spec_defines_file): New.
	(output_files): Update.
	Remove CPP-outed code.

	2001-09-18  Marc Autret  <autret_m@epita.fr>

	Turn off %{source,header}_extension feature.

	* src/files.c (compute_exts_from_gf): Update.
	(compute_exts_from_src): Update.
	(output_files): CPP-out useless code.
	* src/files.h: Remove {header,source}_extension extern declarations.
	* src/reader.c (parse_dquoted_param): CPP-out.
	(parse_header_extension_decl): Remove.
	(parse_source_extension_decl): Remove.
	(read_declarations): Remove cases tok_{hdrext,srcext}.
	* src/lex.c (percent_table): Remove {header,source}_extension entries.
	* src/lex.h (token_t): Remove tok_hdrext and tok_srcext.

	2001-09-10  Akim Demaille  <akim@epita.fr>

	* tests/output.at (AT_CHECK_BISON_FLAGS, AT_CHECK_BISON_PERCENT):
	(AT_CHECK_BISON_PERCENT_FLAGS): Merge into...
	(AT_CHECK_OUTPUT): this.
	Merely check ls' exit status, its output is useless.

	2001-09-10  Akim Demaille  <akim@epita.fr>

	* tests/calc.at: Use m4_match.
	(_AT_DATA_CALC_Y): Check `yyin != NULL', not `stdin != NULL'.

	2001-09-10  Marc Autret  <autret_m@epita.fr>,
		    Akim Demaille  <akim@epita.fr>

	* src/vcg.h (graph_s): color, textcolor, bordercolor are now
	enum color_e.
	* src/print_graph.c (print_graph): Initalize graph.layoutalgorithm
	to `normal'.
	* src/reader.c (parse_token_decl): Initialize token with tok_eof.
	* src/lex.h: Adjust prototype.
	(token_t): Add `tok_undef'.
	* src/lex.c (struct percent_table_struct): Retval is now a token_t.
	(parse_percent_token): Now returns token_t.
	Add default statement in switch.
	(lex): Separate `c' as an input variable, from the token_t result
	part.
	(unlexed): Is a token_t.

	2001-09-10  Akim Demaille  <akim@epita.fr>

	* configure.in: Bump to 1.29a.

	2001-09-07  Akim Demaille  <akim@epita.fr>

	Version 1.29.

	2001-08-30  Akim Demaille  <akim@epita.fr>

	* tests/atgeneral.m4, tests/atconfig.in, tests/suite.at: Remove.
	* m4/atconfig.m4: Remove.
	* tests/testsuite.at, tests/atlocal.in, tests/output.at,
	* tests/bison: New.
	* tests/regression.at, tests/calc.at: Use m4_define, AT_BANNER,
	m4_if, m4_patsubst, and m4_regexp.
	* tests/calc.at (_AT_CHECK_CALC, _AT_CHECK_CALC_ERROR): Use an
	`input' file instead of echo.

	2001-08-29  Akim Demaille  <akim@epita.fr>

	Bump to 1.28e.

	2001-08-29  Akim Demaille  <akim@epita.fr>

	Version 1.28d.

	2001-08-29  Paul Eggert  <eggert@twinsun.com>

	* src/bison.simple (yyparse): Don't take the address of an
	item before the start of an array, as that doesn't conform to
	the C Standard.

	2001-08-29  Robert Anisko  <anisko_r@epita.fr>

	* doc/bison.texinfo (Location Tracking Calc): New node.

	2001-08-29  Paul Eggert  <eggert@twinsun.com>

	* src/output.c (output): Do not define const, as this now
	causes more problems than it cures.

	2001-08-29  Akim Demaille  <akim@epita.fr>

	* doc/bison.texinfo: Modernize `@node' and `@top' use: just name
	the nodes.
	Be sure to tag the `detailmenu'.

	2001-08-29  Akim Demaille  <akim@epita.fr>

	* Makefile.maint (do-po-update): Wget refuses to overwrite files:
	download in a tmp dir.

	2001-08-28  Marc Autret  <autret_m@epita.fr>

	* config/depcomp: New file.

	2001-08-28  Marc Autret  <autret_m@epita.fr>

	* doc/bison.1 (mandoc): Adjust.
	From Juan Manuel Guerrero.

	2001-08-28  Marc Autret  <autret_m@epita.fr>

	* src/print_graph.c (print_state): Fix.

	2001-08-27  Marc Autret  <autret_m@epita.fr>

	* src/vcg.h (classname_s, infoname_s, node_s): Constify the
	char * members.
	Echo modifications to the functions prototypes.
	* src/vcg.c (add_classname, add_infoname): Adjust arguments.

	2001-08-27  Marc Autret  <autret_m@epita.fr>

	* src/vcg.c: Include `xalloc.h'.
	(add_colorentry): New.
	(add_classname): New.
	(add_infoname): New.
	* src/vcg.h: Add new prototypes.

	2001-08-27  Akim Demaille  <akim@epita.fr>

	* Makefile.maint: Sync. again with CVS Autoconf.

	2001-08-27  Akim Demaille  <akim@epita.fr>

	* Makefile.maint: Formatting changes.
	(po-update, cvs-update, update): New targets.
	(AMTAR): Remove.

	2001-08-27  Akim Demaille  <akim@epita.fr>

	* Makefile.am (AUTOMAKE_OPTIONS): 1.5.
	* Makefile.maint: Sync. with CVS Autoconf.

	2001-08-27  Marc Autret  <autret_m@epita.fr>

	* src/vcg.h (struct infoname_s): New.
	(struct colorentry_s): New.
	(graph_s): New fields {vertical,horizontal}_order in structure.
	Add `infoname' field.
	Add `colorentry' field;
	* src/vcg_defaults.h (G_VERTICAL_ORDER): New.
	(G_HORIZONTAL_ORDER): New.
	(G_INFONAME): New.
	(G_COLORENTRY): New.
	* src/vcg.c (output_graph): Add output of {vertical,horizontal}_order.
	Add output of `infoname'.
	Add output of `colorentry'.

	2001-08-27  Marc Autret  <autret_m@epita.fr>

	* src/reader.c (parse_dquoted_param): Rename variable `index' to `i'.
	This one shadowed a global parameter.

	2001-08-24  Marc Autret  <autret_m@epita.fr>

	* src/print_graph.c (node_output_size): Declared POSIX `size_t' type,
	instead of `unsigned'.
	(print_state): Do not call obstack_object_size () in obstack_grow ()
	to avoid macro variables shadowing.

	2001-08-23  Marc Autret  <autret_m@epita.fr>

	* src/lex.c (percent_table): Typo: s/naem/name/.
	Add graph option.
	Normalize new options declarations.

	2001-08-20  Pascal Bart  <pascal.bart@epita.fr>

	* tests/suite.at: Exercise %header_extension and %source_extension.

	2001-08-16  Marc Autret  <autret_m@epita.fr>

	* src/reader.c (parse_dquoted_param): New.
	(parse_header_extension_decl): Use it.
	(parse_source_extension_decl): Likewise.

	2001-08-16  Marc Autret  <autret_m@epita.fr>

	* src/vcg.c: Remove includes of `complain.h' and `xalloc.h'.
	(get_xxxx_str): Use assert () instead of complain ().
	Remove return invokations in default cases.
	(get_decision_str): Modify default behaviour. Remove second argument.
	Echo modifications on calls.
	(output_graph): Fix.

	2001-08-16  Marc Autret  <autret_m@epita.fr>

	* src/getargs.c (usage): Update with ``-g, --graph''.

	2001-08-16  Marc Autret  <autret_m@epita.fr>

	* doc/bison.texinfo (Bison Options): Add items `-g', `--graph'.
	(Option Cross Key): Likewise.
	* doc/bison.1: Update.

2001-09-25  Pascal Bart  <pascal.bart@epita.fr>

	* src/output.c (output_master_parser): Don't finish action_obstack.
	(output_parser): Don't care about the muscle action, here.
	(prepare): Copy the action_obstack in the action muscle.
	(output): Free action_obstack.

2001-09-23  Pascal Bart  <pascal.bart@epita.fr>

	* src/reader.c (parse_union_decl): Add new obstack union_obstack.  Which
	will contain `%union' declaration.
	(parse_union_decl): Delete #line directive output.
	(parse_union_decl): Substitute /attrs_obstack/union_obstack for all
	informations about %union.
	(parse_union_decl): Copy the union_obstack in the muscle stype.
	* src/bison.simple: Add new #line directive.
	Add typdef %%stype YYSTYPE.

2001-09-23  Pascal Bart  <pascal.bart@epita.fr>

	* src/bison.simple: Add new `#line' directive.

2001-09-22  Pascal Bart  <pascal.bart@epita.fr>

	* src/bison.simple: New `#line' directive.
	* src/output.c (output_parser): Support new dynamic muscle input_line.

2001-09-22  Marc Autret  <autret_m@epita.fr>

	* src/output.c (output_master_parser): New.
	(output_parser): Be more re-entrant.

2001-09-21  Marc Autret  <autret_m@epita.fr>

	* src/reader.c (copy_definition, parse_union_decl): Update and use
	`linef' muscle.
	(copy_action): Likewise.
	Use obstack_1grow ().
	* src/muscle_tab.c (muscle_init): Add muscle `linef'.

2001-09-21  Marc Autret  <autret_m@epita.fr>

	* src/options.c (option_table): Adjust.
	* src/lex.c (parse_percent_token): Fix.

2001-09-20  Pascal Bart  <pascal.bart@epita.fr>

	* src/options.c (symtab.h): Include it, need by lex.h.

2001-09-20  Pascal Bart  <pascal.bart@epita.fr>

	* src/lex.c (parse_percent_token): Change type of variable `tx', which
	is now an option_table_struct*.
	(option_strcmp): New function option_strcmp.
	(parse_percent_token): Call option_strcmp.
	* src/getargs.c (xalloc.h, options.h): Include it.
	(getargs): Call create_long_option_table.
	(getargs): Free longopts at the end of the function.
	(shortopts): Move in options.c.
	* src/options.c (create_long_option_table): New function.  Convert
	information from option_table to option structure.
	* src/reader.c (options.h): Include it.

	* src/Makefile.am: Adjust.
	* src/options.c (option_table): Create from longopts and percent_table.
	* src/getargs.c (longopts): Delete.
	* src/lex.c (struct percent_table_struct): Delete.
	(percent_table): Delete.
	(options.h): Include it.
	* src/options.c: Create.
	* src/options.h: Create.
	Declare enum opt_access_e.
	Define struct option_table_struct.

2001-09-20  Marc Autret  <autret_m@epita.fr>

	* doc/bison.texinfo: Adjust terminologies about prologue and epilogue
	sections of Bison.

2001-09-19  Pascal Bart  <pascal.bart@epita.fr>

	* src/bison.simple: s/%%filename/%%skeleton.
	* src/muscle_tab.c (getargs.h): Include it.
	(muscle_init): Insert new muscle skeleton.

2001-09-18  Pascal Bart  <pascal.bart@epita.fr>

	* src/output.c (output_parser): Delete unused variable actions_dumped.

2001-09-07  Pascal Bart  <pascal.bart@epita.fr>

	* src/output.c (output): Delete call to reader_output_yylsp.
	* src/reader.c (reader): Likewise.
	* src/reader.h:	Delete declaration of reader_output_yylsp.

2001-09-02  Marc Autret  <autret_m@epita.fr>

	* src/reader.c: Include muscle_tab.h.
	(parse_union_decl): Update.
	(parse_macro_decl): Rename parse_muscle_decl.
	Update to use renamed functions and variable.
	(read_declarations, copy_action, read_additionnal_code, : Updated
	with correct variables and functions names.
	(packsymbols, reader): Likewise.

	* src/reader.h (muscle_obstack): Extern declaration update.

	* src/output.c: Include muscle_tab.h
	In all functions using macro_insert, change by using muscle_insert ().
	(macro_obstack): Rename muscle_obstack.
	Echo modifications in the whole file.
	(MACRO_INSERT_INT): Rename MUSCLE_INSERT_INT.
	(MACRO_INSERT_STRING): Rename MUSCLE_INSERT_STRING.
	(MACRO_INSERT_PREFIX): Rename MUSCLE_INSERT_PREFIX.

	* src/muscle_tab.h: Update double inclusion macros.
	(macro_entry_s): Rename muscle_entry_s.
	Update prototypes.

	* src/muscle_tab.c: Include muscle_tab.h.
	Rename macro_tabble to muscle_table.
	(mhash1, mhash2, mcmp): Use muscle_entry.
	(macro_init): Rename muscle_init. Update.
	(macro_insert): Rename muscle_insert. Update.
	(macro_find): Rename muscle_find. Update.

	* src/main.c: Include muscle_tab.h.
	(main): Call muscle_init ().
	* src/Makefile.am (bison_SOURCES): Echo modifications.

2001-09-02  Marc Autret  <autret_m@epita.fr>

	Now the files macro_tab.[ch] are named muscle_tab.[ch].

	* src/muscle_tab.c, src/muscle_tab.h: Add files.

2001-09-02  Marc Autret  <autret_m@epita.fr>

	* src/macrotab.c, src/macrotab.h: Remove.

2001-09-01  Pascal Bart  <pascal.bart@epita.fr>

	* src/reader.c (copy_guard): Use muscle to specify the `#line'
	filename.

2001-09-01  Marc Autret  <autret_m@epita.fr>

	* tests/calc.at (exp): Now, YYERROR_VERBOSE need to be set
	to an explicit value to activate the feature. We do it here.

2001-08-31  Pascal Bart  <pascal.bart@epita.fr>

	* src/output.c (prepare): Delete the `filename' muscule insertion.
	* src/reader.c (copy_action): Use `filename' muscule with `#line'.
	(parse_union_decl): Likewise.
	* src/macrotab.c (macro_init): Initialize filename by infile.

2001-08-31  Marc Autret  <autret_m@epita.fr>

	* src/bison.simple (YYLSP_NEEDED): New definition.
	* src/output.c (prepare): Add macro insertion of `locations_flag'

2001-08-31  Pascal Bart  <pascal.bart@epita.fr>

	* src/output.c (prepare): Delete insertion of previous muscles,
	and insert the `prefix' muscles.
	* src/macrotab.c (macro_init): Likewise.
	(macro_init): Initialization prefix directive by `yy'.
	* src/bison.simple: Substitute all %%yylex, %%yychar, %%yylval,
	%%yydebug, %%yyerror, %%yynerrs and %%yyparse by yylex, yychar,
	yylval, yydebug, yyerror, yynerrs and yyparse.
	New directive `#define' to substitute yydebug, ... with option
	name_prefix.

2001-08-31  Pascal Bart  <pascal.bart@epita.fr>

	* src/main.c (main): Standardize.
	* src/output.c (output_table_data, output_parser): Likewise.
	* src/macrotab.h, src/macrotab.c, src/bison.simple: Likewise.

2001-08-31  Pascal Bart  <pascal.bart@epita.fr>, Marc Autret  <autret_m@epita.fr>

	* src/reader.c (read_additionnal_code): Rename %%user_code to
	%%epilogue.
	* src/output.c (output): Rename %%declarations to %%prologue.
	* src/bison.simple: Echo modifications.

2001-08-31  Marc Autret  <autret_m@epita.fr>

	* src/reader.c (readgram): CleanUp.
	(output_token_defines): Likewise.
	(packsymbols): Likewise.
	(reader): Likewise.
	* src/output.c (output): CPP-out useless code.

2001-08-31  Pascal Bart  <pascal.bart@epita.fr>

	* src/reader.c (reader): Delete obsolete call to function
	output_trailers and output_headers.
	* src/output.h: Remove obsolete functions prototypes of output_headers
	and output_trailers.

2001-08-30  Pascal Bart  <pascal.bart@epita.fr>

	* src/main.c: Include macrotab.h.
	* src/macrotab.h (macro_entry_s): Constify fields.
	Adjust functions prototypes.
	* src/macrotab.c (macro_insert): Constify key and value.
	(macro_find): Constify key.
	(macro_insert): Include 'xalloc.h'
	(macro_insert): Use XMALLOC.
	(macro_find): Constify return value.
	* src/output.c (output_table_data): Rename table to table_data.
	(output_parser): Constify macro_key, macro_value.

2001-08-30  Marc Autret  <autret_m@epita.fr>

	* src/reader.c (parse_skel_decl): New.
	(read_declarations): Add case `tok_skel', call parse_skel_decl ().
	* src/lex.h (token_t): New token `tok_skel'.
	* src/lex.c (percent_table): Add skeleton option entry.
	Standardize.

2001-08-29  Marc Autret  <autret_m@epita.fr>

	* src/bison.simple: Add %%user_code directive at the end.
	* src/reader.c (read_additionnal_code): New.
	(reader): Use it.
	* src/output.c (output_program): Remove.
	(output): Update.

2001-08-28  Marc Autret  <autret_m@epita.fr>

	* src/output.c (output_actions): Clean up.
	(output_gram): CPP-out useless code.
	* src/reader.c (reader): Clean up, CPP-out useless code.

2001-08-28  Pascal Bart  <pascal.bart@epita.fr>

	* src/output.c (output): Copy attrs_obstack in the '%%definitions'
	directive.
	* src/bison.simple: Add `%%definitions'.

2001-08-28  Marc Autret  <autret_m@epita.fr>

	* config/depcomp: New file.

2001-08-27  Paul Eggert  <eggert@twinsun.com>

	* src/bison.simple (yyparse): Don't take the address of an
	item before the start of an array, as that doesn't conform to
	the C Standard.

2001-08-27  Robert Anisko  <robert.anisko@epita.fr>

	* src/output.c (output): Remove the initialization of the macro
	obstack.  It was done too late here.

	* src/reader.c (parse_macro_decl): Fix.  Use of the macro obstack was
	completely wrong.
	(reader): Initialize the macro obstack here, since we need it to grow
	'%define' directives.

	* src/reader.h: Declare the macro obstack as extern.

2001-08-27  Robert Anisko  <robert.anisko@epita.fr>

	* src/output.c (output_parser): Fix.  Store single '%' characters in
	the output obstack instead of throwing them away.

2001-08-27  Akim Demaille  <akim@epita.fr>

	* Makefile.am (AUTOMAKE_OPTIONS): 1.5.

2001-08-25  Robert Anisko  <robert.anisko@epita.fr>

	* lib/Makefile.am: Adjust.

2001-08-25  Robert Anisko  <robert.anisko@epita.fr>

	* src/bison.simple: Update and add '%%' directives.

2001-08-25  Robert Anisko  <robert.anisko@epita.fr>

	* src/reader.c (reader): Remove calls to 'output_headers' and
	'output_trailers'. Remove some C output.
	(readgram): Disable a piece of code that was writing a default
	definition for 'YYSTYPE'.
	(reader_output_yylsp): Remove.
	(packsymbols): Output token defintions to a macro.
	(copy_definition): Disable C output.

	* src/reader.c (parse_macro_decl): New function used to parse macro
	declarations.
	(copy_string2): Put the body of copy_string into this new function.
	Add a parameter to let the caller choose whether he wants to copy the
	string delimiters or not.
	(copy_string): Be a simple call to copy_string2 with the last argument
	bound to true.
	(read_declarations): Add case for macro definition.
	(copy_identifier): New.
	(parse_macro_decl): Read macro identifiers using copy_identifier
	rather than lex.

2001-08-25  Robert Anisko  <robert.anisko@epita.fr>

	* src/output.c (prepare): Add prefixed names.
	(output_parser): Output semantic actions.
	(output_parser): Fix bug on '%%line' directives.

	* src/output.c (output_headers): Remove. The C code printed by this
	function should now be in the skeletons.
	(output_trailers): Remove.
	(output): Disable call to 'reader_output_yylsp'.
	(output_rule_data): Do not output tables to the table obstack.

	* src/output.c: Remove some C dedicated output.
	Improve the use of macro and output obstacks.
	(output_defines): Remove.

	* src/output.c (output_token_translations): Associate 'translate'
	table with a macro. No output to the table obstack.
	(output_gram): Same for 'rhs' and 'prhs'.
	(output_stos): Same for 'stos'.
	(output_rule_data): Same for 'r1' and 'r2'.
	(token_actions): Same for 'defact'.
	(goto_actions): Same for 'defgoto'.
	(output_base): Same for 'pact' and 'pgoto'.
	(output_table): Same for 'table'.
	(output_check): Same for 'check'.

	* src/output.c (output_table_data): New function.
	(output_short_table): Remove.
	(output_short_or_char_table): Remove.

	* src/output.c (output_parser): Replace most of the skeleton copy code
	with something new. Skeletons are now processed character by character
	rather than line by line, and Bison looks for '%%' macros. This is the
	first step in making Bison's output process (a lot) more flexible.
	(output_parser): Use the macro table.

2001-08-25  Robert Anisko  <robert.anisko@epita.fr>

	* src/main.c (main): Initialize the macro table.

2001-08-25  Robert Anisko  <robert.anisko@epita.fr>

	* src/lex.c (percent_table): Add tok_define.
	* src/lex.h: Add tok_define.

2001-08-25  Robert Anisko  <robert.anisko@epita.fr>

	* src/macrotab.c: New file.
	* src/macrotab.h: New file.
	* src/Makefile.am: Update.

2001-08-25  Robert Anisko  <robert.anisko@epita.fr>

	* lib/hash.c: New file.
	* lib/hash.h: New file.
	* lib/Makefile.am: Update.

2001-08-15  Akim Demaille  <akim@epita.fr>

	Version 1.28c.

2001-08-15  Marc Autret  <autret_m@epita.fr>

	* src/reader.c (readgram): Indent output macro YYSTYPE.
	(packsymbols): Likewise.
	(output_token_defines): Likewise.
	* src/files.c: Standardize.
	(compute_header_macro): New.
	(defines_obstack_save): New. Use compute_header_macro.
	(output_files): Update. Use defines_obstack_save.

2001-08-15  Akim Demaille  <akim@epita.fr>

	* doc/bison.texinfo (Table of Symbols): Document
	YYSTACK_USE_ALLOCA.

2001-08-15  Akim Demaille  <akim@epita.fr>

	* missing: Update from CVS Automake.
	* config/config.guess, config/config.sub, config/texinfo.tex:
	Update from gnu.org.

2001-08-15  Akim Demaille  <akim@epita.fr>

	* Makefile.maint: Sync with CVS Autoconf.

2001-08-14  Pascal Bart  <pascal.bart@epita.fr>

	* doc/bison.texinfo: Include GNU Free Documentation License from
	`fdl.texi'.
	* doc/fdl.texi: Add to package.

2001-08-14  Marc Autret  <autret_m@epita.fr>

	Turn on %{source,header}_extension features.

	* src/lex.c (percent_table): Un-CPP out header_extension and
	source_extension.
	* src/files.c (compute_exts_from_gf): Compare pointers with NULL.
	(compute_exts_from_src): Remove conditions. It restores priorities
	between options.

2001-08-14  Marc Autret  <autret_m@epita.fr>

	* src/files.c (compute_base_names): Add extensions computing when
	`--file-prefix' used.
	Standardize function calls.

2001-08-13  Marc Autret  <autret_m@epita.fr>

	* src/bison.simple (YYSTACK_USE_ALLOCA): Changed to allow users
	defining it (defined but null disables alloca).

2001-08-13  Marc Autret  <autret_m@epita.fr>

	* src/bison.simple (_yy_memcpy): CPP reformat.

2001-08-13  Pascal Bart  <pascal.bart@epita.fr>

	* tests/atconfig.in (CPPFLAGS): Fix.

2001-08-10  Pascal Bart  <pascal.bart@epita.fr>

	* doc/bison.texinfo: Include GNU General Public License from
	`gpl.texi'.
	* doc/gpl.texi: Add to package.

2001-08-10  Marc Autret  <autret_m@epita.fr>

	* src/print_graph.h: Fix.
	* src/reader.c (read_declarations): Use parse_header_extension_decl ().

2001-08-10  Akim Demaille  <akim@epita.fr>

	* src/system.h: Provide default declarations for stpcpy, strndup,
	and strnlen.

2001-08-10  Robert Anisko  <anisko_r@epita.fr>

	* doc/bison.texinfo (Locations): Update @$ stuff.

2001-08-09  Robert Anisko  <anisko_r@epita.fr>

	* src/bison.simple (YYLLOC_DEFAULT): Update.
	(yyparse): Adjust.

2001-08-08  Marc Autret  <autret_m@epita.fr>

	* doc/bison.texinfo: Change @samp{$<@dots{}>} to
	@samp{$<@dots{}>@var{n}} in Section Actions in Mid-Rule.
	Reported by Fabrice Bauzac.

2001-08-08  Marc Autret  <autret_m@epita.fr>

	* src/vcg_default.h: Use NULL instead of 0 to initialize pointers.
	* src/vcg.c (output_node): Fix.
	* src/vcg.h: Cleanup.
	* src/print_graph.c: Add comments.
	(node_output_size): New global variable. Simplify the formatting of
	the VCG graph output.
	(print_actions): Unused code is now used. It notifies the final state
	and no action states in the VCG graph. It also give the reduce actions.
	The `shift and goto' edges are red and the `go to state' edges are
	blue.
	Get the current node name and node_obstack by argument.
	(node_obstack): New variable.
	(print_state): Manage node_obstack.
	(print_core): Use node_obstack given by argument.
	A node is not only computed here but in print_actions also.
	(print_graph): CPP out useless code instead of commenting it.

2001-08-07  Pascal Bart  <pascal.bart@epita.fr>

	* tests/atconfig.in (CPPFLAGS): Fix.

2001-08-07  Akim Demaille  <akim@epita.fr>

	* src/print_graph.c (quote): New.
	(print_core): Use it.

2001-08-06  Akim Demaille  <akim@epita.fr>, Marc Autret  <autret_m@epita.fr>

	* src/vcg.c (complain.h): Include it.
	Unepitaize `return' invocations.
	[NDEBUG] (main): Remove.
	* src/vcg.h (node_t, edge_t, graph_t): Constify the char * members.
	* src/files.c (open_files): Initialize graph_obstack.
	* src/print_graph.c (print_actions): CPP out useless code.
	(print_core): Don't output the last `\n' in labels.
	Use `quote'.
	* src/files.c (output_files): Output the VCG file.
	* src/main.c (main): Invoke print_graph ();

2001-08-06  Marc Autret  <autret_m@epita.fr>

	Automaton VCG graph output.
	Using option ``-g'' or long option ``--graph'', you can generate
	a gram_filename.vcg file containing a VCG description of the LALR (1)
	automaton of your grammar.

	* src/main.c: Call to print_graph() function.
	* src/getargs.h: Update.
	* src/getargs.c (options): Update to catch `-g' and `--graph' options.
	(graph_flag): New flag.
	(longopts): Update.
	(getargs): Add case `g'.
	* src/files.c (graph_obstack): New obstack struct.
	(open_files): Initialize new obstack.
	(output_files): Saves graph_obstack if required.
	* src/files.h (graph_obstack): New extern declaration.
	* src/Makefile.am: Add new source files.

2001-08-06  Marc Autret  <autret_m@epita.fr>

	* src/print_graph.c, src/print_graph.h (graph): New.
	* src/vcg.h: New file.
	* src/vcg.c: New file, VCG graph handling.

2001-08-06  Marc Autret  <autret_m@epita.fr>

	Add of %source_extension and %header_extension which specify
	the source or/and the header output file extension.

	* src/files.c (compute_base_names): Remove initialisation of
	src_extension and header_extension.
	(compute_exts_from_gf): Update.
	(compute_exts_from_src): Update.
	(output_files): Update.
	* src/reader.c (parse_header_extension_decl): New.
	(parse_source_extension_decl): New.
	(read_declarations): New case statements for the new tokens.
	* src/lex.c (percent_table): Add entries for %source_extension
	and %header_extension.
	* src/lex.h (token_e): New tokens tok_hdrext and tok_srcext.

2001-08-06  Marc Autret  <autret_m@epita.fr>

	* configure.in: Bump to 1.28c.
	* doc/bison.texinfo: Texinfo thingies.

2001-08-04  Pascal Bart  <pascal.bart@epita.fr>

	* tests/atconfig.in (CPPFLAGS): Add.
	* tests/calc.at (AT_CHECK): Use CPPFLAGS.

2001-08-03  Akim Demaille  <akim@epita.fr>

	Version 1.28b.

2001-08-03  Akim Demaille  <akim@epita.fr>

	* tests/Makefile.am (check-local): Ship testsuite.
	* tests/calc.at (_AT_DATA_CALC_Y): Prototype all the functions.
	Include `string.h'.

2001-08-03  Akim Demaille  <akim@epita.fr>

	* configure.in: Try using -Wformat when compiling.

2001-08-03  Akim Demaille  <akim@epita.fr>

	* configure.in: Bump to 1.28b.

2001-08-03  Akim Demaille  <akim@epita.fr>

	* src/complain.c: Adjust strerror_r portability issues.

2001-08-03  Akim Demaille  <akim@epita.fr>

	Version 1.28a.

2001-08-03  Akim Demaille  <akim@epita.fr>

	* src/getargs.c, src/getarg.h (skeleton)): Constify.
	* src/lex.c (literalchar): Avoid name clashes on `buf'.
	* src/getargs.c: Include complain.h.
	* src/files.c, src/files.h (skeleton_find): Avoid name clashes.
	* lib/quotearg.c, lib/quotearg.h: Update from fileutils 4.1.

2001-08-03  Akim Demaille  <akim@epita.fr>

	* src/reader.c (readgram): Display hidden chars in error messages.

2001-08-03  Akim Demaille  <akim@epita.fr>

	Update to gettext 0.10.39.

2001-08-03  Akim Demaille  <akim@epita.fr>

	* lib/strspn.c: New.

2001-08-01  Marc Autret  <autret_m@epita.fr>

	* doc/bison.texinfo: Update.
	* doc/bison.1 (mandoc): Update.
	* src/system.h (EXT_GUARD_C, EXT_STYPE_H): Remove .c and .h.
	* src/files.c: Support output files extensions computing.
	(src_extension): New static variable.
	(header_extension): New static variable.
	(tr): New function.
	(get_extension_index): New function, gets the index of an extension
	filename in a string.
	(compute_exts_from_gf): New function, computes extensions from the
	grammar file extension.
	(compute_exts_from_src): New functions, computes extensions from the
	C source file extension, file given by ``-o'' option.
	(compute_base_names): Update.
	(output_files): Update.

2001-08-01  Robert Anisko  <anisko_r@epita.fr>

	* doc/bison.texi: Document @$.
	(Locations): New section.

2001-07-18  Akim Demaille  <akim@epita.fr>

	* Makefile.maint, GNUmakefile: New, from Autoconf 2.52.
	* config/prev-version.txt, config/move-if-change: New.
	* Makefile.am: Adjust.

2001-07-08  Pascal Bart  <pascal.bart@epita.fr>

	* src/bison.simple (yyparse): Suppress warning `comparaison
	between signed and unsigned'.

2001-07-05  Pascal Bart  <pascal.bart@epita.fr>

	* src/getargs.h (raw_flag): Remove.
	* src/getargs.c: Die on `-r'/`--raw'.
	* src/lex.c (parse_percent_token): Die on `%raw'.
	* src/reader.c (output_token_defines): Suppress call to `raw_flag'.
	* tests/calc.at: Suppress test with option `--raw'.

2001-07-14  Akim Demaille  <akim@epita.fr>

	* config/: New.
	* configure.in: Require Autoconf 2.50.
	Update to gettext 0.10.38.

2001-03-16  Akim Demaille  <akim@epita.fr>

	* doc/bison.texinfo: ANSIfy the examples.

2001-03-16  Akim Demaille  <akim@epita.fr>

	* getargs.c (skeleton): New variable.
	(longopts): --skeleton is a new option.
	(shortopts, getargs): -S is a new option.
	* getargs.h: Declare skeleton.
	* output.c (output_parser): Use it.

2001-03-16  Akim Demaille  <akim@epita.fr>

	* m4/strerror_r.m4: New.
	* m4/error.m4: Run AC_FUNC_STRERROR_R.
	* lib/error.h, lib/error.c: Update.

2001-03-16  Akim Demaille  <akim@epita.fr>

	* src/getargs.c (longopts): Clean up.

2001-02-21  Akim Demaille  <akim@epita.fr>

	* src/reader.c (gensym): `gensym_count' is your own.
	Use a static buf to create the symbol name, as token_buffer is no
	longer a buffer.

2001-02-08  Akim Demaille  <akim@epita.fr>

	* src/conflicts.c (conflict_report): Be sure not to append to res
	between two calls, which could happen if both first sprintf were
	skipped, but not the first cp += strlen.

2001-02-08  Akim Demaille  <akim@epita.fr>

	* lib/memchr.c, lib/stpcpy.c, lib/strndup.c, lib/strnlen.c:
	New, from fileutils 4.0.37.
	* configure.in: Require Autoconf 2.49c.  I took some time before
	making this decision.  This is the only way out for portability
	issues in Bison, it would mean way too much duplicate effort to
	import in Bison features implemented in 2.49c since 2.13.
	AC_REPLACE_FUNCS and AC_CHECK_DECLS the functions above.

2001-02-02  Akim Demaille  <akim@epita.fr>

	* lib/malloc.c, lib/realloc.c: New, from the fileutils 4.0.37.
	* lib/xalloc.h, lib/xmalloc.c: Update.

2001-01-19  Akim Demaille  <akim@epita.fr>

	Get rid of the ad hoc handling of token_buffer in the scanner: use
	the obstacks.

	* src/lex.c (token_obstack): New.
	(init_lex): Initialize it.  No longer call...
	(grow_token_buffer): this.  Remove it.
	Adjust all the places which used it to use the obstack.

2001-01-19  Akim Demaille  <akim@epita.fr>

	* src/lex.h: Rename all the tokens:
	s/\bENDFILE\b/tok_eof/g;
	s/\bIDENTIFIER\b/tok_identifier/g;
	etc.
	Let them be enums, not #define, to ease debugging.
	Adjust all the code.

2001-01-18  Akim Demaille  <akim@epita.fr>

	* src/lex.h (MAXTOKEN, maxtoken, grow_token_buffer): Remove, private.
	* src/lex.c (maxtoken, grow_token_buffer): Static.

2001-01-18  Akim Demaille  <akim@epita.fr>

	Since we now use obstacks, more % directives can be enabled.

	* src/lex.c (percent_table): Also accept `%yacc',
	`%fixed_output_files', `%defines', `%no_parser', `%verbose', and
	`%debug'.
	Handle the actions for `%semantic_parser' and `%pure_parser' here,
	instead of returning a token.
	* src/lex.h (SEMANTIC_PARSER, PURE_PARSER): Remove, unused.
	* src/reader.c (read_declarations): Adjust.
	* src/files.c (open_files): Don't call `compute_base_names', don't
	compute `attrsfile' since they depend upon data which might be
	*in* the input file now.
	(output_files): Do it here.
	* src/output.c (output_headers): Document the fact that this patch
	introduces a guaranteed SEGV for semantic parsers.
	* doc/bison.texinfo: Document them.
	* tests/suite.at: Exercise these %options.

2000-12-20  Akim Demaille  <akim@epita.fr>

	Also handle the output file (--verbose) with obstacks.

	* files.c (foutput): Remove.
	(output_obstack): New.
	Adjust all dependencies.
	* src/conflicts.c: Return a string.
	* src/system.h (obstack_grow_string): Rename as...
	(obstack_sgrow): this.  Be ready to work with non literals.
	(obstack_fgrow4): New.

2000-12-20  Akim Demaille  <akim@epita.fr>

	* src/files.c (open_files): Fix the computation of short_base_name
	in the case of `-o foo.tab.c'.

2000-12-20  Akim Demaille  <akim@epita.fr>

	* src/reader.c (copy_string, copy_comment, copy_comment2, copy_at)
	(copy_dollar): Now that everything uses obstacks, get rid of the
	FILE * parameters.

2000-12-20  Akim Demaille  <akim@epita.fr>

	* src/files.c (open_files): Actually the `.output' file is based
	on the short_base_name, not base_name.
	* tests/suite.at (Checking output file names): Adjust.

2000-12-20  Akim Demaille  <akim@epita.fr>

	* src/bison.s1: Remove, we now use directly...
	* src/bison.simple: this.
	* src/Makefile.am: Use pkgdata instead of data.

2000-12-20  Akim Demaille  <akim@epita.fr>

	* src/files.c (guard_obstack): New.
	(open_files): Initialize it.
	(output_files): Dump it...
	* src/files.h: Export it.
	* src/reader.c (copy_guard): Use it.

2000-12-19  Akim Demaille  <akim@epita.fr>

	* src/files.c (outfile, defsfile, actfile): Removed as global
	vars.
	(open_files): Don't compute them.
	(output_files): Adjust.
	(base_name, short_base_name): Be global.
	Adjust dependencies.

2000-12-19  Akim Demaille  <akim@epita.fr>

	* src/files.c (strsuffix): New.
	(stringappend): Be just like strcat but allocate.
	(base_names): Eve out from open_files.
	Try to simplify the rather hairy computation of base_name and
	short_base_name.
	(open_files): Use it.
	* tests/suite.at (Checking output file names): New test.

2000-12-19  Akim Demaille  <akim@epita.fr>

	* src/system.h (obstack_grow_literal_string): Rename as...
	(obstack_grow_string): this.
	* src/output.c (output_parser): Recognize `%% actions' instead of
	`$'.
	* src/bison.s1: s/$/%% actions/.
	* src/bison.hairy: Likewise.

2000-12-19  Akim Demaille  <akim@epita.fr>

	* src/output.c (output_parser): Compute the `#line' lines when
	there are.
	* src/Makefile.am (bison.simple): Be a simple copy of bison.s1.
	Suggested by Hans Aberg.

2000-12-19  Akim Demaille  <akim@epita.fr>

	Let the handling of the skeleton files be local to the procedures
	that use it.

	* src/files.c (xfopen, xfclose, skeleton_find, guardfile): No
	longer static.
	(fparser, open_extra_files): Remove.
	(open_files, output_files): Don't take care of fparser.
	* src/files.h: Adjust.
	* src/output.c (output_parser): Open and close the file to the
	skeleton.
	* src/reader.c (read_declarations): When %semantic_parser, open
	fguard.

2000-12-19  Akim Demaille  <akim@epita.fr>

	* src/file.h (BISON_SIMPLE, BISON_HAIRY): Move from here...
	* src/system.h (BISON_SIMPLE, BISON_HAIRY): ... to here.

2000-12-19  Akim Demaille  <akim@epita.fr>

	* src/files.c (open_files): Yipee!  We no longer need all the code
	looking for `/tmp' since we have no tmp file.

2000-12-19  Akim Demaille  <akim@epita.fr>

	* src/system.h (EXT_TAB, EXT_OUTPUT, EXT_STYPE_H, EXT_GUARD_C):
	New macros.
	* src/files.c (open_files): Less dependency on MSDOS etc.

2000-12-14  Akim Demaille  <akim@epita.fr>

	* src/bison.s1 (YYLLOC_DEFAULT): New macro.
	Provide a default definition.
	Use it when executing the default @ action.
	* src/reader.c (reader_output_yylsp): No longer include
	`timestamp' and `text' in the default YYLTYPE.

2000-12-12  Akim Demaille  <akim@epita.fr>

	* src/reader.c (copy_definition, parse_union_decl, copy_action)
	(copy_guard): Quote the file names.
	Reported by Laurent Mascherpa.

2000-12-12  Akim Demaille  <akim@epita.fr>

	* src/output.c (output_headers, output_program, output): Be sure
	to escape special characters when outputting filenames.
	(ACTSTR_PROLOGUE, ACTSTR_EPILOGUE): Remove.
	(output_headers): Don't depend on them, Use ACTSTR.

2000-11-17  Akim Demaille  <akim@epita.fr>

	* lib/obstack.h: Formatting changes.
	(obstack_grow, obstack_grow0): Don't cast WHERE at all: it
	prevents type checking.
	(obstack_ptr_grow, obstack_ptr_grow_fast): When assigning, don't
	cast the value to (void *): assigning a `foo *' to a `void *'
	variable is valid.
	(obstack_int_grow, obstack_int_grow_fast): Don't cast AINT to int.
	* src/reader.c (parse_union_decl): Typo: use obstack_1grow to
	append characters.

2000-11-17  Akim Demaille  <akim@epita.fr>

	* tests/Makefile.am (suite.m4, regression.m4, calc.m4): Rename
	as...
	(suite.m4, regression.m4, calc.m4): these.
	* tests/atgeneral.m4: Update from CVS Autoconf.

2000-11-17  Akim Demaille  <akim@epita.fr>

	* tests/regression.m4 (%union and --defines): New test,
	demonstrating a current bug in the obstack implementation.

2000-11-17  Akim Demaille  <akim@epita.fr>

	* src/bison.s1 (_YY_DECL_VARIABLES, YY_DECL_VARIABLES): New
	macros.
	Use them to declare the variables which are global or local to
	`yyparse'.

2000-11-17  Akim Demaille  <akim@epita.fr>

	* acconfig.h: Remove, no longer used.

2000-11-07  Akim Demaille  <akim@epita.fr>

	* src: s/Copyright (C)/Copyright/g.

2000-11-07  Akim Demaille  <akim@epita.fr>

	* src/reader.c (reader): #define YYLSP_NEEDED to 1 instead of just
	defining.
	* src/bison.s1: s/#ifdef YYLSP_NEEDED/#if YYLSP_NEEDED/.

2000-11-07  Akim Demaille  <akim@epita.fr>

	* src/bison.s1 (YYLEX): Use #if instead of #ifdef.
	Merge in a single CPP if/else.

2000-11-07  Akim Demaille  <akim@epita.fr>

	* src/output.c (output): Remove useless variables.
	* lib/obstack.c (obstack_grow, obstack_grow0): Rename the second
	argument `data' for consistency with the prototypes.
	Qualify it `const'.
	(obstack_copy, obstack_copy0): Rename the second argument as
	`address' for consistency.  Qualify it `const'.
	* lib/obstack.h (obstack_copy, obstack_copy0, obstack_grow)
	(obstack_grow0, obstack_ptr_grow, obstack_ptr_grow_fast): Qualify
	`const' their input argument (`data' or `address').
	Adjust the corresponding macros to include `const' in casts.

2000-11-03  Akim Demaille  <akim@epita.fr>

	* src/Makefile.am (INCLUDES): s/PFILE/BISON_SIMPLE/.
	s/PFILE1/BISON_HAIRY/.
	Adjust dependencies.

2000-11-03  Akim Demaille  <akim@epita.fr>

	For some reason, this was not applied.

	* src/files.c [VMS]: No longer include `ssdef.h', no longer define
	`unlink': it's no longer used.

2000-11-03  Akim Demaille  <akim@epita.fr>

	* src/files.c (skeleton_find): New function, eved out of...
	(open_files, open_extra_files): here.

2000-11-03  Akim Demaille  <akim@epita.fr>

	Don't use `atexit'.

	* src/files.c (obstack_save): New function.
	(done): Rename as...
	(output_files): this.
	Use `obstack_save'.
	* src/main.c (main): Don't use `atexit' to register `done', since
	it no longer has to remove tmp files, just call `output_files'
	when there are no errors.

2000-11-02  Akim Demaille  <akim@epita.fr>

	* src/files.c [VMS]: No longer include `ssdef.h', no longer define
	`unlink': it's no longer used.
	* src/files.h: Formatting changes.

2000-11-02  Akim Demaille  <akim@epita.fr>

	Remove the last uses of mktemp and unlink/delete.

	* src/files.c (fdefines, ftable): Removed.
	(defines_ostack, table_obstack): New.
	Adjust dependencies of the former into uses of the latter.
	* src/output.c (output_short_or_char_table, output_short_table):
	Convert to using obstacks.
	* src/reader.c (copy_comment2): Accept one FILE * and two
	obstacks.
	(output_token_defines, reader_output_yylsp): Use obstacks.
	* src/system.h (obstack_fgrow3): New.

2000-11-01  Akim Demaille  <akim@epita.fr>

	Change each use of `fattrs' into a use of `attrs_obstack'.

	* src/reader.c (copy_at): Typo: s/yylloc/yyloc/.
	* src/files.c (fattrs): Remove.
	(attrs_obstack): New.
	Adjust all dependencies.
	(done): If SEMANTIC_PARSER, dump attrs_obstack into attrsfile.

2000-11-01  Akim Demaille  <akim@epita.fr>

	Introduce obstacks.
	Change each use of `faction' into a use of `action_obstack'.

	* lib/obstack.h, lib/obstack.c: New files.
	* src/files.c (faction): Remove.
	(action_obstack): New.
	Adjust all dependencies.

2000-10-20  Akim Demaille  <akim@epita.fr>

	* lib/quote.h (PARAMS): New macro.  Use it.

2000-10-16  Akim Demaille  <akim@epita.fr>

	* src/output.c (output_short_or_char_table): New function.
	(output_short_table, output_token_translations): Use it.
	(goto_actions): Use output_short_table.

2000-10-16  Akim Demaille  <akim@epita.fr>

	* src/symtab.c (bucket_new): New function.
	(getsym): Use it.

	* src/output.c (output_short_table): New argument to display the
	comment associated with the table.
	Adjust dependencies.
	(output_gram): Use it.
	(output_rule_data): Nicer output layout for YYTNAME.

2000-10-16  Akim Demaille  <akim@epita.fr>

	* src/lex.c (read_typename): New function.
	(lex): Use it.
	* src/reader.c (copy_dollar): Likewise.

2000-10-16  Akim Demaille  <akim@epita.fr>

	* src/reader.c (copy_comment2): Expect the input stream to be on
	the `/' which is suspected to open a comment, instead of being
	called after `//' or `/*' was read.
	(copy_comment, copy_definition, parse_union_decl, copy_action)
	(copy_guard): Adjust.

2000-10-16  Akim Demaille  <akim@epita.fr>

	* src/reader.c (parse_expect_decl): Use `skip_white_space' and
	`read_signed_integer'.

2000-10-16  Akim Demaille  <akim@epita.fr>

	* src/reader.c (copy_dollar): New function.
	(copy_guard, copy_action): Use it.

2000-10-16  Akim Demaille  <akim@epita.fr>

	* lib/quote.h, lib/quote.c, lib/quotearg.h, lib/quotearg.c:
	* m4/prereq.m4, m4/c-bs-a.m4, m4/mbstate.m4:
	New files, from Fileutils 4.0.27.
	* src/main.c (printable_version): Remove.
	* src/lex.c, src/reader.c: Use `quote'.

2000-10-04  Akim Demaille  <akim@epita.fr>

	* lib/error.c, lib/error.h: New files, needed by xmalloc.c.

2000-10-04  Akim Demaille  <akim@epita.fr>

	* doc/bison.texinfo: Various typos spotted by Neil Booth.

2000-10-04  Akim Demaille  <akim@epita.fr>

	When a literal string is used to define two different tokens,
	`bison -v' segfaults.
	Reported by Piotr Gackiewicz, and fixed by Neil Booth.

	* tests/regression.m4: New file.
	Include the core of the sample provided by Piotr Gackiewicz.
	* src/reader.c (parse_token_decl): Diagnose bad cases, and proceed
	properly.

2000-10-04  Akim Demaille  <akim@epita.fr>

	* src/reader.c (parse_expect_decl): Keep `count' within the size
	of `buffer'.
	From Neil Booth.

2000-10-02  Paul Eggert  <eggert@twinsun.com>

	* bison.s1 (yyparse): Assign the default value
	unconditionally, to avoid a GCC warning and make the parser a
	tad smaller.

2000-10-02  Akim Demaille  <akim@epita.fr>

	* src/getargs.c (getargs): Don't dump `--help' on unrecognized
	options.

2000-10-02  Akim Demaille  <akim@epita.fr>

	* src/derives.c, src/print.c, src/reduce.c: To ease the
	translation, move some `\n' out of the translated strings.

2000-10-02  Akim Demaille  <akim@epita.fr>

	The location tracking mechanism is precious for parse error
	messages.  Nevertheless, it is enabled only when `@n' is used in
	the grammar, which is a different issue (you can use it in error
	message, but not in the grammar per se).  Therefore, there should
	be another means to enable it.

	* src/getargs.c (getargs): Support `--locations'.
	(usage): Report it.
	* src/getargs.h (locationsflag): Export it.
	* src/lex.c (percent_table): Support `%locations'.
	* src/reader.c (yylsp_needed): Remove this variable, now replaced
	with `locationsflag'.
	* doc/bison.texinfo: Document `--locations' and `%locations'.
	Sort the options.
	* tests/calc.m4: Test it.

	For regularity of the names, replace each
	(nolineflag, toknumflag, rawtokenumflag, noparserflag): with...
	(no_lineflag, token_tableflag, rawflag, no_parserflag): this.
	In addition replace each `flag' with `_flag'.

2000-10-02  Akim Demaille  <akim@epita.fr>

	Also test parse error messages, including with YYERROR_VERBOSE.

	* tests/calc.m4 (calc.y): Add support for `exp = exp' (non
	associative).
	Use it to check the computations.
	Use it to check `nonassoc' is honored.
	(AT_DATA_CALC_Y): Equip `calc.y' with YYERROR_VERBOSE when passed
	`--yyerror-verbose'.
	(_AT_CHECK_CALC): Adjust to this option.
	(_AT_CHECK_CALC_ERROR): New macro to check parse error messages.

2000-10-02  Akim Demaille  <akim@epita.fr>

	Test also `--verbose', `--defines' and `--name-prefix'.  Testing
	the latter demonstrates a flaw in the handling of non debugging
	parsers introduced by myself on 2000-03-16: `#define yydebug 0'
	was used in order to simplify:

	#if YYDEBUG
	if (yydebug)
	{
	...
	}
	#endif

	into

	if (yydebug)
	{
	...
	}

	unfortunately this leads to a CPP conflict when
	`--name-prefix=foo' is used since it produces `#define yydebug
	foodebug'.

	* src/bison.s1 [!YYDEBUG]: Do not define yydebug.
	(YYDPRINTF): New macro.
	Spread its use.
	* tests/calc.m4 (AT_CHECK_CALC): Do require a title, build it from
	the bison options.
	Also test `--verbose', `--defines' and `--name-prefix'.

2000-10-02  Akim Demaille  <akim@epita.fr>

	Improve the readability of the produced parsers.

	* src/bison.s1: Formatting changes.
	Improve the comment related to the `$' mark.
	(yydefault): Don't fall through to `yyresume': `goto' there.
	* src/output.c (output_parser): When the `$' is met, skip the end
	of its line.
	New variable, `number_of_dollar_signs', to check there's exactly
	one `$' in the parser skeleton.

2000-10-02  Akim Demaille  <akim@epita.fr>

	* lib/xstrdup.c: New file, from the fileutils.
	* src/reader.c (parse_token_decl, get_type_name, parse_type_decl)
	(parse_assoc_decl, parse_thong_decl, get_type): Use `xstrdup'
	instead of strlen + xmalloc + strcpy.
	* src/symtab.c (copys): Remove, use xstrdup instead.

2000-10-02  Akim Demaille  <akim@epita.fr>

	* src/gram.h (associativity): New enum type which replaces the
	former CPP macros `RIGHT_ASSOC', `LEFT_ASSOC' and `NON_ASSOC' with
	`right_assoc', `left_assoc' and `non_assoc'.
	Adjust all dependencies.
	* src/reader.c: Formatting changes.
	(LTYPESTR): Don't define it, use it as a literal in
	`reader_output_yylsp'.
	* src/symtab.h (symbol_class): New enum type which replaces the
	former CPP macros `SUNKNOWN', `STOKEN and `SNTERM' with
	`sunknown', `stoken and `snterm'.

2000-10-02  Akim Demaille  <akim@epita.fr>

	* src/getargs.c (fixed_outfiles): Rename as...
	(yaccflag): for consistency and accuracy.
	Adjust dependencies.

2000-10-02  Akim Demaille  <akim@epita.fr>

	Use the more standard files `xalloc.h' and `xmalloc.c' instead of
	Bison's `allocate.c' and `alloc.h'.  This patch was surprisingly
	difficult and introduced a lot of core dump.  It turns out that
	Bison used an implementation of `xmalloc' based on `calloc', and
	at various places it does depend upon the initialization to 0.  I
	have not tried to isolate the pertinent places, and all the former
	calls to Bison's `xmalloc' are now using `XCALLOC'.  Someday,
	someone should address this issue.

	* src/allocate.c, src/alloc.h, m4/bison-decl.m4: Remove.
	* lib/xmalloc.c, lib/xalloc.h, m4/malloc.m4, m4/realloc.m4: New
	files.
	Adjust dependencies.
	* src/warshall.h: New file.
	Propagate.

2000-10-02  Akim Demaille  <akim@epita.fr>

	Various anti-`extern in *.c' changes.

	* src/system.h: Include `assert.h'.

2000-10-02  Akim Demaille  <akim@epita.fr>

	* src/state.h (nstates, final_state, first_state, first_shift)
	(first_reduction): Move their exportation from here...
	* src/LR0.h: to here.
	Adjust dependencies.
	* src/getargs.c (statisticsflag): New variable.
	Add support for `--statistics'.
	Adjust dependencies.

	Remove a lot of now useless `extern' statements in most files.

2000-10-02  Akim Demaille  <akim@epita.fr>

	* src/LR0.h: New file.
	Propagate its use.

2000-10-02  Akim Demaille  <akim@epita.fr>

	* src/print.h: New file.
	Propagate its use.
	* src/print.c: Formatting and ordering changes.
	(verbose, terse): Replace with...
	(print_results): this new function.
	Adjust dependencies.

2000-10-02  Akim Demaille  <akim@epita.fr>

	* src/conflicts.c (conflict_report): New function.
	(conflict_log, verbose_conflict_log): Replace with...
	(print_conflicts): this function.
	Adjust dependencies.
	* src/conflicts.h: New file.
	Propagate its inclusion.

2000-10-02  Akim Demaille  <akim@epita.fr>

	* src/nullable.h: New file.
	Propagate its inclusion.
	* src/nullable.c: Formatting changes.

2000-10-02  Akim Demaille  <akim@epita.fr>

	* src/reduce.h: New file.
	Propagate its inclusion.
	* src/reduce.c: Topological sort and other formatting changes.
	(bool, TRUE, FALSE): Move their definition to...
	* src/system.h: here.

2000-10-02  Akim Demaille  <akim@epita.fr>

	* src/files.c: Formatting changes.
	(tryopen, tryclose, openfiles): Rename as...
	(xfopen, xfclose, open_files): this.
	(stringappend): static.
	* src/files.h: Complete the list of exported symbols.
	Propagate its use.

2000-10-02  Akim Demaille  <akim@epita.fr>

	* src/reader.h: New file.
	Propagate its use instead of tedious list of `extern' and
	prototypes.
	* src/reader.c: Formatting changes, topological sort,
	s/register//.

2000-10-02  Akim Demaille  <akim@epita.fr>

	* src/lex.h: Prototype `lex.c' exported functions.
	* src/reader.c: Adjust.
	* src/lex.c: Formatting changes.
	(safegetc): Rename as...
	(xgetc): this.

2000-10-02  Akim Demaille  <akim@epita.fr>

	* src/lalr.h: New file.
	Propagate its inclusion instead of prototypes and `extern'.
	* src/lalr.c: Formatting changes, topological sorting etc.

2000-10-02  Akim Demaille  <akim@epita.fr>

	* src/output.c (token_actions): Introduce a temporary array,
	YYDEFACT, that makes it possible for this function to use
	output_short_table.

2000-10-02  Akim Demaille  <akim@epita.fr>

	`user_toknums' is output as a `short[]' in `output.c', while it is
	defined as a `int[]' in `reader.c'.  For consistency with the
	other output tables, `user_toknums' is now defined as a table of
	shorts.

	* src/reader.c (user_toknums): Be a short table instead of an int
	table.
	Adjust dependencies.

	Factor the short table outputs.

	* src/output.c (output_short_table): New function.
	* src/output.c (output_gram, output_stos, output_rule_data)
	(output_base, output_table, output_check):  Use it.

2000-10-02  Akim Demaille  <akim@epita.fr>

	* src/output.c (output): Topological sort of the functions, in
	order to get rid of the `static' prototypes.
	No longer use `register'.
	* src/output.h: New file.
	Propagate its inclusion in files explicitly prototyping functions
	from output.c.

2000-09-21  Akim Demaille  <akim@epita.fr>

	* src/atgeneral.m4: Update from Autoconf.

2000-09-21  Akim Demaille  <akim@epita.fr>

	* src/closure.h: New file.
	* src/closure.c: Formatting changes, topological sort over the
	functions, use of closure.h.
	(initialize_closure, finalize_closure):  Rename as...
	(new_closure, free_closure): these.  Adjust dependencies.
	* src/LR0.c: Formatting changes, topological sort, use of
	cloture.h.
	(initialize_states): Rename as...
	(new_states): this.
	* src/Makefile.am (noinst_HEADERS): Adjust.

2000-09-20  Akim Demaille  <akim@epita.fr>

	* src/acconfig.h: Don't protect config.h against multiple
	inclusion.
	Don't define PARAMS.
	* src/system.h: Define PARAMS.
	Remove some of the ad-hoc CPP magic for DOS, VMS etc.: this is the
	purpose of config.h.  system.h must not try to fix wrong
	definitions in config.h.

2000-09-20  Akim Demaille  <akim@epita.fr>

	* src/derives.h: New file.
	* src/main.c, src/derives.h: Use it.
	Formatting changes.
	* src/Makefile.am (noinst_HEADERS): Adjust.

2000-09-20  Akim Demaille  <akim@epita.fr>

	* tests/atgeneral.m4: Update from Autoconf.
	* tests/calc.m4 (_AT_DATA_CALC_Y, AT_DATA_CALC_Y, _AT_CHECK_CALC)
	(AT_CHECK_CALC): New macros.
	Use these macros to test bison with options `', `--raw',
	`--debug', `--yacc', `--yacc --debug'.

2000-09-19  Akim Demaille  <akim@epita.fr>

	* src/output.c: Formatting changes.
	* src/machine.h: Remove, leaving its contents in...
	* src/system.h: here.
	Include stdio.h.
	Adjust all dependencies on stdio.h and machine.h.
	* src/getargs.h: New file.
	Let all `extern' declarations about getargs.c be replaced with
	inclusion of `getargs.h'.
	* src/Makefile.am (noinst_HEADERS): Adjust.

	* tests/calc.m4 (yyin): Be initialized in main, not on the global
	scope.
	(yyerror): Returns void, not int.
	* doc/bison.texinfo: Formatting changes.

2000-09-19  Akim Demaille  <akim@epita.fr>

	* tests/calc.m4 (calc.y): Do not assign to stdin, as it's not
	portable.

2000-09-18  Akim Demaille  <akim@epita.fr>

	* configure.in: Append WARNING_CFLAGS to CFLAGS.
	* src/Makefile.am (INCLUDES): Don't.
	Be ready to fetch headers in lib/.

2000-09-18  Akim Demaille  <akim@epita.fr>

	* doc/bison.texinfo: Update the copyright.
	ANSIfy and GNUify the examples.
	Remove the old menu.

2000-09-18  Akim Demaille  <akim@epita.fr>

	First set of tests: use the `calc' example from the documentation.

	* src/bison.s1 (yyparse): Condition the code using `yytname' which
	is defined only when YYDEBUG is.
	* m4/atconfig.m4 (AT_CONFIG): Adjust to Autoconf 2.13.
	* src/files.c (tryopen, tryclose): Formatting changes.
	Move to the top and be static.
	* src/reader.c (read_signed_integer): Likewise.
	* tests/calc.m4: New file.
	* Makefile.am, suite.m4: Adjust.
	* m4/atconfig.m4: Set BISON_SIMPLE and BISON_HAIRY.

2000-09-18  Akim Demaille  <akim@epita.fr>

	Add support for an Autotest test suite for Bison.

	* m4/m4.m4, m4/atconfig.m4: New files.
	* m4/Makefile.am (EXTRA_DIST): Adjust.
	* tests/suite.m4, tests/Makefile.am, tests/atgeneral.m4: New
	files.
	* src/getargs.c: Display a more standard --version message.
	* src/reader.c (reader): Formatting changes.
	No longer depend upon VERSION_STRING.
	* configure.in: No longer use `dnl'.
	Set up the test suite and the new directory `tests/.
	(VERSION_STRING): Remove.

2000-04-14  Akim Demaille  <akim@epita.fr>

	* src/reader.c (copy_comment2): New function, same as former
	`copy_comment', but outputs into two FILE *.
	(copy_comment): Use it.
	(parse_union_decl): Use it.
	(get_type, parse_start_decl): Use the same `invalid' message.
	(parse_start_decl, parse_union_decl): Use the same `multiple'
	message.
	(parse_union_decl, copy_guard, copy_action): Use the same
	`unmatched' message.
	* m4/Makefile.am (EXTRA_DIST): Add `warning.m4'.

2000-03-31  Akim Demaille  <akim@epita.fr>

	* src/files.c (tryopen, tryclose): Move to the top.
	Be static.

2000-03-31  Akim Demaille  <akim@epita.fr>

	* src/main.c (main): Don't call `done', exit does it.

2000-03-31  Akim Demaille  <akim@epita.fr>

	* allocate.c: s/return (foo)/return foo/.
	* lalr.c: Likewise.
	* LR0.c: Likewise.
	* output.c: Likewise.
	* reader.c: Likewise.
	* symtab.c: Likewise.
	* vmsgetargs.c: Likewise.

2000-03-31  Akim Demaille  <akim@epita.fr>

	Clean up the error reporting functions.

	* src/report.c: New file.
	* src/report.h: Likewise.
	* src/Makefile.am: Adjust.
	* m4/error.m4: New file.
	* m4/Makefile.am: Adjust.
	* configure.in (jm_PREREQ_ERROR): Call it.
	* src/main.c (int_to_string, banner, fatal_banner, warn_banner):
	Remove.
	(fatal, fatals): Remove.  All callers use complain.c::fatal.
	(warn, warni, warns, warnss, warnss): Remove.  All callers use
	complain.c::complain.
	(toomany): Remove, use fatal instead.
	* src/files.c (done): No argument, use complain_message_count.
	* src/main.c (main): Register `done' to `atexit'.

	* src/getargs.c (usage): More `fputs', less `fprintf'.

2000-03-28  Akim Demaille  <akim@epita.fr>

	* lib/: New directory.
	* Makefile.am (SUBDIRS): Adjust.
	* configure.in: Adjust.
	(LIBOBJS): Although not used yet, AC_SUBST it, otherwise it's
	useless.
	* src/alloca.c: Moved to lib/.
	* src/getopt.c: Likewise.
	* src/getopt1.c: Likewise.
	* src/getopt.h: Likewise.
	* src/ansi2knr.c: Likewise.
	* src/ansi2knr.1: Likewise.
	* src/Makefile.am: Adjust.
	* lib/Makefile.am: New file.

2000-03-28  Akim Demaille  <akim@epita.fr>

	* src/getargs.c (usage): Refresh the help message.

2000-03-17  Akim Demaille  <akim@epita.fr>

	* src/getopt1.c: Updated from textutils 2.0e
	* src/getopt.c: Likewise.
	* src/getopt.h: Likewise.

2000-03-17  Akim Demaille  <akim@epita.fr>

	* src/Makefile.am (bison.simple): Fix the awk program: quote only
	the file name, not the whole `#line LINE FILE'.

2000-03-17  Akim Demaille  <akim@epita.fr>

	On syntax errors, report the token on which we choked.

	* src/bison.s1 (yyparse): In the label yyerrlab, when
	YYERROR_VERBOSE, add yychar in msg.

2000-03-17  Akim Demaille  <akim@epita.fr>

	* src/reader.c (copy_at): New function.
	(copy_guard): Use it.
	(copy_action): Use it.

2000-03-17  Akim Demaille  <akim@epita.fr>

	Be kind to translators, save some useless translations.

	* src/main.c (banner): New function.
	(fatal_banner): Use it.
	(warn_banner): Use it.

2000-03-17  Akim Demaille  <akim@epita.fr>

	* src/reader.c (copy_definition): Use copy_string and
	copy_comment.  Removed now unused `match', `ended',
	`cplus_comment'.
	(copy_comment, copy_string): Moved, to be visible from
	copy_definition.

2000-03-17  Akim Demaille  <akim@epita.fr>

	* src/reader.c (copy_string): Declare `static inline'.  No
	problems with inline, since it is checked by configure.
	(copy_comment): Likewise.

2000-03-17  Akim Demaille  <akim@epita.fr>

	* src/reader.c (packsymbols): Formatting changes.

2000-03-17  Akim Demaille  <akim@epita.fr>

	* src/reader.c (copy_comment): New function, factored out from:
	(copy_action): Use it.  Removed now unused `match', `ended',
	`cplus_comment'.
	(copy_guard): Likewise.

2000-03-17  Akim Demaille  <akim@epita.fr>

	* src/reader.c (copy_string): New function, factored out from:
	(copy_action): Use it.
	(copy_guard): Likewise.

2000-03-17  Akim Demaille  <akim@epita.fr>

	Change the handling of @s so that they behave exactly like $s.
	There is now a pseudo variable @$ (readble and writable), location
	of the lhs of the rule (by default ranging from the location of
	the first symbol of the rhs, to the location of the last symbol,
	or, if the rhs is empty, YYLLOC).

	* src/bison.s1 [YYLSP_NEEDED] (yyloc): New variable, twin of
	yyval.
	(yyparse): When providing a default semantic action, provide a
	default location action.
	(after the $): No longer change `*YYLSP', just stack YYLOC the
	same way you stack YYVAL.
	* src/reader.c (read_declarations): Use warns.
	(copy_guard, case '@'): Also recognize `@$', expanded as `YYLOC'.
	(copy_action, case '@'): Likewise.
	Use a standard error message, to save useless work from
	translators.

2000-03-17  Akim Demaille  <akim@epita.fr>

	* src/bison.s1: Formatting and cosmetics changes.
	* src/reader.c: Likewise.
	Update the Copyright notice.

2000-03-17  Akim Demaille  <akim@epita.fr>

	* src/bison.s1 (#line): All set to `#line' only, since the
	Makefile now handles them.

2000-03-16  Akim Demaille  <akim@epita.fr>

	* src/output.c (output_rule_data): Output the documentation of
	some of the tables.
	(Copyright notice): Update.
	Formatting changes.

2000-03-16  Akim Demaille  <akim@epita.fr>

	* src/bison.s1 [!YYDEBUG]: Define yydebug to 0.  This allows to
	remove most `#if YYDEBUG != 0', since `if (yydebug)' is enough.
	One `#if YYDEBUG' remains, since it uses variables which are
	defined only if `YYDEBUG != 0'.

2000-03-16  Akim Demaille  <akim@epita.fr>

	* src/bison.s1 (yyparse): Reorganize the definitions of the stacks
	and related variables so that the similarities are highlighted.

2000-03-16  Akim Demaille  <akim@epita.fr>

	* src/bison.s1: Properly indent CPP directives.

2000-03-16  Akim Demaille  <akim@epita.fr>

	* src/bison.s1: Properly indent the `alloca' CPP section.

2000-03-16  Akim Demaille  <akim@epita.fr>

	Do not hard code values of directories in `configure.in'.
	Update the `configure' tool chain.

	* configure.in (XPFILE, XPFILE1, LOCALEDIR): Remove, handled by
	src/makefile.am.
	(VERSION_STRING): Use the third arg of AC_DEFINE_UNQUOTED.
	(AC_OUTPUT): Add m4/Makefile.
	Bump to bison 1.28a, 1.29 has never been released.
	* acconfig.h (XPFILE, XPFILE1, LOCALEDIR): Remove, since they are
	handled via src/Makefile.am.
	(VERSION_STRING, PROTOTYPES, ENABLE_NLS, HAVE_CATGETS,
	HAVE_GETTEXT, HAVE_LC_MESSAGES, HAVE_STPCPY): Remove, handled by
	autoheader.
	* Makefile.am (SUBDIRS): Add m4.
	(ACLOCAL_AM_FLAGS): New variable.
	(AUTOMAKE_OPTIONS): Add check-news.
	* src/Makefile.am (bison.simple): Use awk to replace #line lines with
	the proper line number and file name.
	(DEFS): Propagate the location of bison library files and of the
	locale files.
	(INCLUDES): Added `-I ..' so that one can compile with srcdir !=
	builddir.
	* acinclude.m4: Remove, replaced by the directory m4.
	* m4/Makefile.am (EXTRA_DIST): New variable.
	* m4/gettext.m4: New file, from the fileutils.
	* m4/lcmessage.m4: Likewise
	* m4/progtest.m4: Likewise.
	* m4/bison-decl.m4: New file, extracted from former acinclude.m4.

2000-03-10  Akim Demaille  <akim@epita.fr>

	* src/closure.c:
	Formatting changes of various comments.
	Respect the GNU coding standards at various places.
	Don't use `_()' when no translation is needed.

1999-12-13  Jesse Thilo  <jthilo@gnu.org>

	* src/files.c:
	OS/2 honors TMPDIR environment variable.

1999-12-13  Jesse Thilo  <jthilo@gnu.org>

	* doc/bison.texinfo: Tweaked spelling and grammar.
	Updated ISBN.
	Removed reference to price of printed copy.
	Mention BISON_SIMPLE and BISON_HAIRY.

1999-12-13  Jesse Thilo  <jthilo@gnu.org>

	* configure.in, NEWS:
	Bison 1.29 released.

1999-10-27  Jesse Thilo  <jthilo@gnu.org>

	* doc/.cvsignore, doc/Makefile.am, doc/refcard.tex:
	Added reference card.

1999-07-26  Jesse Thilo  <jthilo@gnu.org>

	* po/ru.po: Added Russian translation.

1999-07-26  Jesse Thilo  <jthilo@gnu.org>

	* configure.in: Added Russian translation.

1999-07-06  Jesse Thilo  <jthilo@gnu.org>

	* configure.in, NEWS, README:
	Released version 1.28.

1999-06-14  Jesse Thilo  <jthilo@gnu.org>

	* src/system.h:
	Squashed redefinition warning on some systems.

	* src/getargs.c, src/Makefile.am, src/reader.c, src/version.c:
	Have configure build version string instead of relying on ANSI string
	concatentation.

1999-06-14  Jesse Thilo  <jthilo@gnu.org>

	* po/POTFILES.in: Got rid of version.c.

1999-06-14  Jesse Thilo  <jthilo@gnu.org>

	* acconfig.h, configure.in:
	Have configure build version string instead of relying on ANSI string
	concatentation.

1999-06-08  Jesse Thilo  <jthilo@gnu.org>

	* doc/bison.1:
	Dropped mention of `+' for long-named options.

1999-05-30  Jesse Thilo  <jthilo@gnu.org>

	* src/files.c: Added <unistd.h> for unlink().

	* src/Makefile.am, src/system.h:
	I18n fixes.

1999-05-30  Jesse Thilo  <jthilo@gnu.org>

	* README: Added a FAQ list.

	* configure.in, acconfig.h:
	I18n fixes.

1999-05-30  Jesse Thilo  <jthilo@gnu.org>

	* doc/FAQ, doc/Makefile.am:
	Added a FAQ list.

1999-05-19  Jesse Thilo  <jthilo@gnu.org>

	* src/alloc.h, src/symtab.h, src/version.c:
	Protected inclusion of "config.h" with HAVE_CONFIG_H.

1999-04-18  Jesse Thilo  <jthilo@gnu.org>

	* src/.cvsignore, src/Makefile.am:
	Reorganized: sources in `src', documentation in `doc'.

	* src/lex.c (literalchar):
	fixed the code for escaping double quotes (thanks
	Jonathan Czisny.)

1999-04-18  Jesse Thilo  <jthilo@gnu.org>

	* po/de.po, po/es.po, po/fr.po, po/nl.po, po/POTFILES.in:
	Adjusted paths to reflect directory reorganization.

1999-04-18  Jesse Thilo  <jthilo@gnu.org>

	* doc/.cvsignore, doc/Makefile.am:
	Reorganized: sources in `src', documentation in `doc'.

1999-04-18  Jesse Thilo  <jthilo@gnu.org>

	* configure.in:
	Updated AC_INIT file to reflect directory reorganization.

	* configure.in, .cvsignore, Makefile.am, POTFILES.in:
	Reorganized: sources in `src', documentation in `doc'.

1999-04-13  Jesse Thilo  <jthilo@gnu.org>

	* src/allocate.c:
	Don't declare calloc() and realloc() if not necessary.

1999-04-13  Jesse Thilo  <jthilo@gnu.org>

	* configure.in, acconfig.h, acinclude.m4:
	Don't declare calloc() and realloc() if not necessary.

1999-03-23  Jesse Thilo  <jthilo@gnu.org>

	* po/.cvsignore: Added i18n support.

1999-03-23  Jesse Thilo  <jthilo@gnu.org>

	* acconfig.h, configure.in, Makefile.am:
	Added i18n support.

1999-03-22  Jesse Thilo  <jthilo@gnu.org>

	* src/bison.s1: Fixed #line numbers.

1999-03-15  Jesse Thilo  <jthilo@gnu.org>

	* po/es.po, po/fr.po, po/nl.po, po/de.po:
	Added PO files from Translation Project.

1999-03-03  Jesse Thilo  <jthilo@gnu.org>

	* Makefile.am:
	Added support for non-ANSI compilers (ansi2knr).

1999-02-16  Jesse Thilo  <jthilo@gnu.org>

	* configure.in: Bumped version number to 1.27.

	* Makefile.am:
	Added `bison.simple' to list of files removed by `make distclean'.

1999-02-12  Jesse Thilo  <jthilo@gnu.org>

	* src/files.c, src/files.h:
	Defined locations of parser files in config.h instead of Makefile.

1999-02-12  Jesse Thilo  <jthilo@gnu.org>

	* acconfig.h, acinclude.m4, configure.in, Makefile.am:
	Defined locations of parser files in config.h instead of Makefile.

1999-02-09  Jesse Thilo  <jthilo@gnu.org>

	* Makefile.am:
	Removed inappropriate use of $< macro.

1999-02-05  Jesse Thilo  <jthilo@gnu.org>

	* po/Makefile.in.in, po/POTFILES.in:
	Add `po' directory skeleton.

1999-01-27  Jesse Thilo  <jthilo@gnu.org>

	* README: Document help-bison list.

	* configure.in: Add check for mkstemp().

1999-01-20  Jesse Thilo  <jthilo@gnu.org>

	* src/conflicts.c, src/LR0.c, src/output.c, src/reader.c:
	Hush a few compiler warnings.

	* src/files.c:
	Add tryclose(), which verifies that fclose was successful.
	Hush a couple of compiler warnings.

1999-01-20  Jesse Thilo  <jthilo@gnu.org>

	* Makefile.am, OChangeLog:
	ChangeLog is now automatically generated.  Include the old version as
	OChangeLog.

1999-01-14  Jesse Thilo  <jthilo@gnu.org>

	* src/gram.h, src/lalr.c, src/lex.c, src/lex.h, src/machine.h, src/main.c, src/nullable.c, src/output.c, src/print.c, src/reader.c, src/reduce.c, src/state.h, src/symtab.c, src/symtab.h, src/types.h, src/vmsgetargs.c, src/warshall.c, src/allocate.c, src/alloc.h, src/bison.s1, src/closure.c, src/conflicts.c, src/derives.c, src/files.c, src/files.h, src/getargs.c, src/gram.c, src/LR0.c:
	Update FSF address.

1999-01-14  Jesse Thilo  <jthilo@gnu.org>

	* doc/bison.texinfo: Fix formatting glitch.

	* doc/bison.texinfo: Update FSF address.

1999-01-14  Jesse Thilo  <jthilo@gnu.org>

	* acconfig.h: Update FSF address.

1999-01-08  Jesse Thilo  <jthilo@gnu.org>

	* src/system.h:
	Don't define PACKAGE here, since config.h defines it.

1998-12-30  Jesse Thilo  <jthilo@gnu.org>

	* src/reader.c: Update copyright date.

	* src/main.c:
	Ditch sprintf to statically-sized buffers in fatal/warn functions in
	favor of output directly to stderr (avoids buffer overruns).

	* src/reader.c: Some checks for premature EOF.

	* src/allocate.c, src/alloc.h, src/closure.c, src/conflicts.c, src/derives.c, src/getargs.c, src/gram.c, src/lalr.c, src/lex.c, src/LR0.c, src/main.c, src/nullable.c, src/output.c, src/print.c, src/reduce.c, src/symtab.c, src/symtab.h, src/warshall.c:
	Use prototypes if the compiler understands them.

	* src/files.c: Honor TMPDIR on Unix hosts.
	Use prototypes if the compiler understands them.

	* src/reader.c:
	Fix a couple of buffer overrun bugs.
	Use prototypes if the compiler understands them.

	* src/system.h: Include unistd.h and ctype.h.
	Use #ifdef instead of #if for NLS symbols.

1998-12-30  Jesse Thilo  <jthilo@gnu.org>

	* doc/bison.texinfo:
	Delete comment "consider using @set for edition number, etc..." since
	we now are doing so.

1998-12-30  Jesse Thilo  <jthilo@gnu.org>

	* configure.in:
	Use prototypes if the compiler understands them.

	* NEWS: Document 1.26 highlights.

	* Makefile.am: Require Automake 1.3 or later.

	* acconfig.h:
	Use prototypes if the compiler understands them.

1998-12-29  Jesse Thilo  <jthilo@gnu.org>

	* src/version.c:
	Use VERSION symbol from automake for version number.

1998-12-29  Jesse Thilo  <jthilo@gnu.org>

	* acconfig.h, configure.in, version.cin:
	Use VERSION symbol from automake for version number.

1998-11-28  Jesse Thilo  <jthilo@gnu.org>

	* Makefile.am:
	Distribute original version of simple parser (bison.s1), not built
	version (bison.simple).

1998-11-28  Jesse Thilo  <jthilo@gnu.org>

	* doc/bison.texinfo: Add info dir entry.

	* doc/bison.texinfo:
	Let automake put version number into documentation.

1998-11-26  Jesse Thilo  <jthilo@gnu.org>

	* src/bison.cld, src/build.com, src/vmshlp.mar:
	Add non-RCS files from /gd/gnu/bison.

1998-11-26  Jesse Thilo  <jthilo@gnu.org>

	* doc/bison.1:
	Document the BISON_HAIRY and BISON_SIMPLE variables.

1998-11-25  Jesse Thilo  <jthilo@gnu.org>

	* src/version.c: Build version.c automatically.

	* src/reader.c:
	Fix token numbering (used to start at 258, not 257).

	* src/system.h: Include config.h.

	* src/getargs.c: Update bug report address.

	* src/alloca.c, src/getopt1.c, src/getopt.c, src/getopt.h:
	Get latest copies of alloca.c, getopt.c, getopt.h, getopt1.c from gnu.org.

1998-11-25  Jesse Thilo  <jthilo@gnu.org>

	* Makefile.am:
	Rename bison.simple to bison.s1 (bison.simple is then built from bison.s1).

	* configure.in, version.cin:
	Build version.c automatically.

	* AUTHORS: Add AUTHORS file.

	* README: Update bug report address.

	* bison.simple:
	Rename bison.simple to bison.s1 (bison.simple is then built from bison.s1).

	* configure.in, Makefile.am, Makefile.in, stamp-h.in:
	Add automake stuff.

1998-11-25  Jesse Thilo  <jthilo@gnu.org>

	* doc/bison.texinfo: Clean up some formatting.

1998-05-05  Richard Stallman  <rms@gnu.org>

	* doc/bison.texinfo:
	Explain better why to make a pure parser.

1998-01-05  Richard Stallman  <rms@gnu.org>

	* src/files.c (openfiles):
	[_WIN32 && !__CYGWIN32__] Use TEMP or Temp to
	find a temporary directory, if possible.  Do not unlink files while
	they are open.

1997-08-25  Richard Stallman  <rms@gnu.org>

	* src/reader.c (stack_offset;):
	Change some warni to warns.

	* src/lex.c (literalchar): Use warns, not warni.

1997-06-28  Richard Stallman  <rms@gnu.org>

	* src/bison.s1: Add a Bison version comment.

	* src/main.c (fatal, warn, berror):
	Use program_name.

1997-06-28  Richard Stallman  <rms@gnu.org>

	* Makefile.in (bison_version): New variable.
	(dist): Use that variable.
	(bison.s1): Substitute the Bison version into bison.simple.

	* bison.simple: Add a Bison version comment.

1997-06-18  Richard Stallman  <rms@gnu.org>

	* src/main.c (fatal, warn, berror):
	Make error messages standard.
	(toomany): Improve error message text.

	* src/LR0.c, src/closure.c, src/conflicts.c, src/derives.c, src/files.c, src/lalr.c, src/lex.c, src/nullable.c, src/output.c, src/print.c, src/reader.c, src/reduce.c, src/symtab.c:
	new.h renamed to alloc.h.

1997-06-18  Richard Stallman  <rms@gnu.org>

	* Makefile.in: new.h renamed to alloc.h.

1997-05-24  Richard Stallman  <rms@gnu.org>

	* src/lex.c (literalchar):
	Fix the code for escaping \, " and '.

	(lex): Avoid trouble when there are many chars
	to discard in a char literal with just several chars in it.

1997-05-17  Richard Stallman  <rms@gnu.org>

	* src/bison.s1:
	Use malloc, if using alloca is troublesome.
	(YYSTACK_USE_ALLOCA): New flag macro.
	Define it for some systems and compilers.
	(YYSTACK_ALLOC): New macro.
	(yyparse): Use YYSTACK_ALLOC to allocate stack.
	If it was malloc'd, free it.

1997-05-17  Richard Stallman  <rms@gnu.org>

	* bison.simple:
	Use malloc, if using alloca is troublesome.
	(YYSTACK_USE_ALLOCA): New flag macro.
	Define it for some systems and compilers.
	(YYSTACK_ALLOC): New macro.
	(yyparse): Use YYSTACK_ALLOC to allocate stack.
	If it was malloc'd, free it.

1997-04-23  Richard Stallman  <rms@gnu.org>

	* src/bison.s1:
	(alloca) [__hpux]: Always define as __builtin_alloca.

1997-04-23  Richard Stallman  <rms@gnu.org>

	* bison.simple:
	(alloca) [__hpux]: Always define as __builtin_alloca.

1997-04-22  Richard Stallman  <rms@gnu.org>

	* src/bison.s1:
	[__hpux]: Include alloca.h (right for HPUX 10)
	instead of declaring alloca (right for HPUX 9).

	* src/bison.s1 (__yy_memcpy):
	Declare arg `count' as unsigned int.
	(yyparse): Cast third arg to __yy_memcpy to unsigned int.

1997-04-22  Richard Stallman  <rms@gnu.org>

	* bison.simple:
	[__hpux]: Include alloca.h (right for HPUX 10)
	instead of declaring alloca (right for HPUX 9).

	* bison.simple (__yy_memcpy):
	Declare arg `count' as unsigned int.
	(yyparse): Cast third arg to __yy_memcpy to unsigned int.

1997-01-03  Richard Stallman  <rms@gnu.org>

	* src/allocate.c: [__STDC__ or _MSC_VER]:
	Declare calloc and realloc to return void *.

1997-01-02  Richard Stallman  <rms@gnu.org>

	* src/system.h:
	[_MSC_VER]: Include stdlib.h and process.h.
	[_MSC_VER] (getpid): Define as macro--translate it to _getpid.

	* src/main.c (main): Return FAILURE as a value.
	(printable_version): Declare arg as int, not char.

1997-01-02  Richard Stallman  <rms@gnu.org>

	* Makefile.in (dist):
	Explicitly check for symlinks, and copy them.

1996-12-19  Richard Stallman  <rms@gnu.org>

	* src/files.c:
	[_MSC_VER] (XPFILE, XPFILE1): Define, if not already defined.

1996-12-18  Paul Eggert  <eggert@gnu.org>

	* src/bison.s1 (yyparse):
	If __GNUC__ and YYPARSE_PARAM are both defined,
	declare yyparse to have a void * argument.

1996-12-18  Paul Eggert  <eggert@gnu.org>

	* bison.simple (yyparse):
	If __GNUC__ and YYPARSE_PARAM are both defined,
	declare yyparse to have a void * argument.

1996-12-17  Richard Stallman  <rms@gnu.org>

	* src/reduce.c (nbits): Add some casts.

1996-08-12  Richard Stallman  <rms@gnu.org>

	* src/bison.s1: Test _MSDOS as well as _MSDOS_.

1996-08-12  Richard Stallman  <rms@gnu.org>

	* bison.simple: Test _MSDOS as well as _MSDOS_.

1996-07-31  Richard Stallman  <rms@gnu.org>

	* src/bison.s1:
	[__sun && __i386]: Include alloca.h.

1996-07-31  Richard Stallman  <rms@gnu.org>

	* bison.simple:
	[__sun && __i386]: Include alloca.h.

1996-07-30  Richard Stallman  <rms@gnu.org>

	* src/bison.s1: Comment change.

	* src/bison.s1: Test _MSDOS_, not MSDOS.

1996-07-30  Richard Stallman  <rms@gnu.org>

	* bison.simple: Comment change.

	* bison.simple: Test _MSDOS_, not MSDOS.

1996-06-01  Richard Stallman  <rms@gnu.org>

	* src/reduce.c, src/reader.c, src/print.c, src/output.c, src/nullable.c, src/lex.c, src/lalr.c, src/getargs.c, src/derives.c, src/conflicts.c, src/closure.c, src/allocate.c:
	Insert `_' macro around many string constants.

	* src/main.c:
	Insert `_' macro around many string constants.

	(main): Call setlocale, bindtextdomain and textdomain.

	* src/system.h: [HAVE_LOCALE_H]: Include locale.h.
	[! HAVE_LOCALE_H] (setlocale): Define as no-op.
	[ENABLE_NLS]: Include libintl.h.
	[ENABLE_NLS] (gettext): Define.
	[! ENABLE_NLS] (bintextdomain, textdomain, _): Consolation definitions.
	(N_, PACKAGE, LOCALEDIR): New macros.

1996-06-01  Richard Stallman  <rms@gnu.org>

	* POTFILES.in: New file.

	* Makefile.in (allocate.o):
	Define target explicitly.

	* Makefile.in (CFLAGS): Set to @CFLAGS@.
	(LDFLAGS): Set to @LDFLAGS@.
	(configure): Run autoconf only if preceding `cd' succeeds.
	(bison.s1): Redirect output to temporary file then move the
	temporary to the target, rather than redirecting directly to bison.s1.
	(clean): Remove config.status and config.log.
	(distclean): Don't remove config.status here.

1996-05-12  Richard Stallman  <rms@gnu.org>

	* src/bison.s1:
	(__yy_memcpy) [__cplusplus]: Reorder declarations of variables f and t.

1996-05-12  Richard Stallman  <rms@gnu.org>

	* bison.simple:
	(__yy_memcpy) [__cplusplus]: Reorder declarations of variables f and t.

1996-05-11  Richard Stallman  <rms@gnu.org>

	* src/bison.s1 (__yy_memcpy):
	Really reorder the args, as was supposedly done on Feb 14 1995.
	(yyparse): Calls changed accordingly.

1996-05-11  Richard Stallman  <rms@gnu.org>

	* Makefile.in (dist): Don't use $(srcdir).

	* bison.simple (__yy_memcpy):
	Really reorder the args, as was supposedly done on Feb 14 1995.
	(yyparse): Calls changed accordingly.

1996-01-27  Richard Stallman  <rms@gnu.org>

	* src/output.c (output_rule_data):
	Test YYERROR_VERBOSE in the conditional
	around the definition of ttyname.

1995-12-29  Richard Stallman  <rms@gnu.org>

	* src/bison.s1:
	Fix line numbers in #line commands.

1995-12-29  Richard Stallman  <rms@gnu.org>

	* bison.simple:
	Fix line numbers in #line commands.

1995-12-27  Richard Stallman  <rms@gnu.org>

	* src/bison.s1 (YYPARSE_PARAM_DECL):
	In C++, make it always null.
	(YYPARSE_PARAM_ARG): New macro.
	(yyparse): Use YYPARSE_PARAM_ARG.

1995-12-27  Richard Stallman  <rms@gnu.org>

	* bison.simple (YYPARSE_PARAM_DECL):
	In C++, make it always null.
	(YYPARSE_PARAM_ARG): New macro.
	(yyparse): Use YYPARSE_PARAM_ARG.

1995-11-29  Richard Stallman  <rms@gnu.org>

	* doc/bison.texinfo:
	Describe literal string tokens, %raw, %no_lines, %token_table.

1995-11-29  Daniel Hagerty  <hag@gnu.org>

	* doc/bison.texinfo: Fixed update date

1995-10-16  Richard Stallman  <rms@gnu.org>

	* src/version.c: Version 1.25.

1995-10-16  Richard Stallman  <rms@gnu.org>

	* NEWS: *** empty log message ***

1995-10-16  Richard Stallman  <rms@gnu.org>

	* doc/bison.1, doc/bison.rnh:
	Add new options.

1995-10-15  Richard Stallman  <rms@gnu.org>

	* src/vmsgetargs.c, src/getargs.c:
	Added -n, -k, and -raw switches.
	(noparserflag, toknumflag, rawtoknumflag): New variables.

	* src/symtab.h (SALIAS):
	New #define for adding aliases to %token.
	(struct bucket): Added `alias' field.

	* src/reduce.c (reduce_grammar):
	Revise error message.
	(print_notices): Remove final `.' from error message.

	* src/reader.c (reader_output_yylsp):
	New function.
	(readgram): Use `#if 0' around code that accepted %command
	inside grammar rules:  The documentation doesn't allow it,
	and it will fail since the %command processors scan for the next %.
	(parse_token_decl):  Extended the %token
	declaration to allow a multi-character symbol as an alias.
	(parse_thong_decl): New function.
	(read_declarations): Added %thong declarations.
	(read_declarations): Handle NOOP to deal with allowing
	% declarations as another means to specify the flags.
	(readgram): Allow %prec prior to semantics embedded in a rule.
	(skip_to_char, read_declarations, copy_definition)
	(parse_token_decl, parse_start_decl, parse_type_decl)
	(parse_assoc_decl, parse_union_decl, parse_expect_decl)
	(get_type_name, copy_guard, copy_action, readgram)
	(get_type, packsymbols):  Revised most error messages.
	Changed `fatal' to `warnxxx' to avoid aborting for error.
	Revised and use multiple warnxxx functions to avoid using VARARGS1.
	(read_declarations): Improve the error message for
	an invalid character.  Do not abort.
	(read_declarations, copy_guard, copy_action): Use
	printable_version to avoid unprintable characters in printed output.
	(parse_expect_decl): Error if argument to %expect exceeds 10 digits.
	(parse_token_decl, parse_assoc_decl, parse_type_decl, get_type):
	Allow the type of a non-terminal can be given
	more than once, as long as all specifications give the same type.

	* src/output.c:
	(output_headers, output_trailers, output, output_gram)
	(output_rule_data): Implement noparserflag variable.
	Implement toknumflag variable.
	(output): Call reader_output_yylsp to output LTYPESTR.

	* src/main.c (main):
	 If reader sees an error, don't process the grammar.
	(fatals): Updated to not use VARARGS1.
	(printable_version, int_to_string, warn, warni, warns, warnss)
	(warnsss): New error reporting functions.  Avoid abort for error.

	* src/lex.h:
	Added THONG and NOOP for alias processing.
	Added SETOPT for the new code that allows setting options with %flags.

	* src/lex.c:
	Include getopt.h.  Add some extern decls.
	(safegetc): New function to deal with EOF gracefully.
	(literalchar); new function to deal with reading \ escapes.
	(lex): Use literalchar.
	(lex): Implemented "..." tokens.
	(literalchar, lex, parse_percent_token): Made tokenbuffer
	always contain the token.  This includes growing the token
	buffer while reading an integer.
	(parse_percent_token): Replaced if-else statement with percent_table.
	(parse_percent_token): Added % declarations as another
	way to specify the flags -n, -l, and -r.  Also added hooks for
	-d, -k, -y, -v, -t, -p, -b, -o, but implementation requires
	major changes to files.c.
	(lex) Retain in the incoming stream a character following
	an incorrect '/'.
	(skip_white_space, lex):  Revised most error messages
	and changed fatal to warn to avoid aborting.
	(percent_table):  Added %thong declarations.

	* src/gram.h: Comment changes.

	* src/files.c (openfiles, open_extra_files, done):
	 Add faction flag
	and actfile file.  Handle noparserflag.  Both for -n switch.

	* src/conflicts.c (resolve_sr_conflict):
	Remove use of alloca.

1995-06-01  Jim Meyering  <meyering@gnu.org>

	* doc/bison.texinfo: *** empty log message ***

1995-05-06  Richard Stallman  <rms@gnu.org>

	* src/bison.s1: Comment change.

1995-05-06  Richard Stallman  <rms@gnu.org>

	* bison.simple: Comment change.

1995-05-03  Richard Stallman  <rms@gnu.org>

	* src/version.c: Version now 1.24.

	* src/bison.s1: Change distribution terms.

	* src/version.c: Version now 1.23.

1995-05-03  Richard Stallman  <rms@gnu.org>

	* doc/bison.texinfo:
	Rewrite "Conditions for Using Bison".
	Update version to 1.24.

1995-05-03  Richard Stallman  <rms@gnu.org>

	* bison.simple: Change distribution terms.

1995-02-23  Richard Stallman  <rms@gnu.org>

	* src/files.c: Test __VMS_POSIX as well as VMS.

1995-02-14  Jim Meyering  <meyering@gnu.org>

	* src/bison.s1 (__yy_memcpy):
	Renamed from __yy_bcopy to avoid
	confusion.  Reverse FROM and TO arguments to be consistent with
	those of memcpy.

1995-02-14  Jim Meyering  <meyering@gnu.org>

	* bison.simple (__yy_memcpy):
	Renamed from __yy_bcopy to avoid
	confusion.  Reverse FROM and TO arguments to be consistent with
	those of memcpy.

1994-11-10  David J. MacKenzie  <djm@gnu.org>

	* NEWS: reformat

	* NEWS: New file.

	* Makefile.in (DISTFILES): Include NEWS.

	* Makefile.in (DISTFILES):
	Include install-sh, not install.sh.

	* configure.in: Update to Autoconf v2 macro names.

1994-10-05  David J. MacKenzie  <djm@gnu.org>

	* Makefile.in: fix typo

	* Makefile.in (prefix, exec_prefix):
	Let configure set them.

1994-09-28  David J. MacKenzie  <djm@gnu.org>

	* Makefile.in: Set datadir to $(prefix)/share.

1994-09-15  Richard Stallman  <rms@gnu.org>

	* src/bison.s1:
	Update copyright notice and GPL version.

1994-09-15  Richard Stallman  <rms@gnu.org>

	* bison.simple:
	Update copyright notice and GPL version.

1994-07-12  Richard Stallman  <rms@gnu.org>

	* src/reduce.c, src/reader.c:
	entered into RCS

1994-05-05  David J. MacKenzie  <djm@gnu.org>

	* Makefile.in: entered into RCS

1994-03-26  Richard Stallman  <rms@gnu.org>

	* src/bison.s1: entered into RCS

1994-03-26  Richard Stallman  <rms@gnu.org>

	* bison.simple: entered into RCS

1994-03-25  Richard Stallman  <rms@gnu.org>

	* src/main.c: entered into RCS

1994-03-24  Richard Stallman  <rms@gnu.org>

	* src/conflicts.c: entered into RCS

1994-01-02  Richard Stallman  <rms@gnu.org>

	* Makefile.in: *** empty log message ***

1993-11-21  Richard Stallman  <rms@gnu.org>

	* src/bison.s1: *** empty log message ***

1993-11-21  Richard Stallman  <rms@gnu.org>

	* doc/bison.texinfo: entered into RCS

	* doc/bison.texinfo: *** empty log message ***

1993-11-21  Richard Stallman  <rms@gnu.org>

	* bison.simple: *** empty log message ***

1993-10-25  David J. MacKenzie  <djm@gnu.org>

	* doc/bison.texinfo: *** empty log message ***

1993-10-19  Richard Stallman  <rms@gnu.org>

	* src/bison.s1: *** empty log message ***

1993-10-19  Richard Stallman  <rms@gnu.org>

	* bison.simple: *** empty log message ***

1993-10-14  Richard Stallman  <rms@gnu.org>

	* src/bison.s1: *** empty log message ***

1993-10-14  Richard Stallman  <rms@gnu.org>

	* bison.simple: *** empty log message ***

1993-09-14  David J. MacKenzie  <djm@gnu.org>

	* doc/bison.texinfo: *** empty log message ***

1993-09-13  Noah Friedman  <friedman@gnu.org>

	* Makefile.in: *** empty log message ***

1993-09-10  Richard Stallman  <rms@gnu.org>

	* src/conflicts.c: *** empty log message ***

	* src/system.h: entered into RCS

1993-09-10  Richard Stallman  <rms@gnu.org>

	* doc/bison.1: entered into RCS

1993-09-06  Noah Friedman  <friedman@gnu.org>

	* src/version.c: entered into RCS

1993-09-06  Noah Friedman  <friedman@gnu.org>

	* Makefile.in: *** empty log message ***

1993-07-30  David J. MacKenzie  <djm@gnu.org>

	* Makefile.in: *** empty log message ***

1993-07-24  Richard Stallman  <rms@gnu.org>

	* src/bison.s1: *** empty log message ***

1993-07-24  Richard Stallman  <rms@gnu.org>

	* bison.simple: *** empty log message ***

1993-07-08  David J. MacKenzie  <djm@gnu.org>

	* Makefile.in: *** empty log message ***

1993-07-04  Richard Stallman  <rms@gnu.org>

	* src/bison.s1: *** empty log message ***

1993-07-04  Richard Stallman  <rms@gnu.org>

	* bison.simple: *** empty log message ***

1993-06-26  David J. MacKenzie  <djm@gnu.org>

	* src/getargs.c: entered into RCS

1993-06-26  David J. MacKenzie  <djm@gnu.org>

	* doc/bison.texinfo: *** empty log message ***

	* doc/bison.1: New file.

1993-06-25  Richard Stallman  <rms@gnu.org>

	* src/getargs.c: New file.

1993-06-16  Richard Stallman  <rms@gnu.org>

	* src/bison.s1: *** empty log message ***

1993-06-16  Richard Stallman  <rms@gnu.org>

	* bison.simple: *** empty log message ***

1993-06-03  Richard Stallman  <rms@gnu.org>

	* src/bison.s1: New file.

1993-06-03  Richard Stallman  <rms@gnu.org>

	* doc/bison.texinfo: *** empty log message ***

1993-06-03  Richard Stallman  <rms@gnu.org>

	* bison.simple: New file.

1993-05-19  Richard Stallman  <rms@gnu.org>

	* doc/bison.texinfo: New file.

1993-05-07  Noah Friedman  <friedman@gnu.org>

	* Makefile.in: *** empty log message ***

1993-04-28  Noah Friedman  <friedman@gnu.org>

	* src/reader.c: *** empty log message ***

1993-04-23  Noah Friedman  <friedman@gnu.org>

	* src/alloc.h: entered into RCS

1993-04-20  David J. MacKenzie  <djm@gnu.org>

	* src/version.c: *** empty log message ***

	* src/files.c, src/allocate.c:
	entered into RCS

	* src/reader.c: *** empty log message ***

	* src/lex.c: entered into RCS

	* src/conflicts.c: New file.

	* src/symtab.c: entered into RCS

	* src/alloc.h: New file.

	* src/LR0.c: entered into RCS

1993-04-18  Noah Friedman  <friedman@gnu.org>

	* src/reader.c: New file.

	* src/version.c: *** empty log message ***

1993-04-18  Noah Friedman  <friedman@gnu.org>

	* Makefile.in: *** empty log message ***

1993-04-17  Noah Friedman  <friedman@gnu.org>

	* Makefile.in: *** empty log message ***

1993-04-15  Richard Stallman  <rms@gnu.org>

	* src/main.c, src/files.c:
	New file.

1993-04-15  Noah Friedman  <friedman@gnu.org>

	* configure.in: entered into RCS

	* configure.in: *** empty log message ***

	* configure.in: New file.

1993-04-14  Richard Stallman  <rms@gnu.org>

	* Makefile.in: New file.

1993-04-13  Richard Stallman  <rms@gnu.org>

	* src/version.c: New file.

1993-03-25  Richard Stallman  <rms@gnu.org>

	* src/output.c: entered into RCS

1992-09-25  Richard Stallman  <rms@gnu.org>

	* configure.bat: entered into RCS

1992-06-22  Richard Stallman  <rms@gnu.org>

	* src/vmsgetargs.c: entered into RCS

1992-06-22  Richard Stallman  <rms@gnu.org>

	* doc/bison.rnh: entered into RCS

1992-04-20  David J. MacKenzie  <djm@gnu.org>

	* README: entered into RCS

1992-01-22  Richard Stallman  <rms@gnu.org>

	* src/machine.h: entered into RCS

1991-12-21  Richard Stallman  <rms@gnu.org>

	* src/lalr.c, src/closure.c:
	entered into RCS

1991-12-20  Richard Stallman  <rms@gnu.org>

	* src/state.h: entered into RCS

1991-12-18  Richard Stallman  <rms@gnu.org>

	* src/print.c, src/nullable.c, src/derives.c:
	entered into RCS

1991-11-03  David J. MacKenzie  <djm@gnu.org>

	* src/warshall.c, src/types.h, src/symtab.h, src/lex.h, src/gram.c, src/gram.h, src/files.h:
	entered into RCS

1988-09-09  Richard Stallman  <rms@gnu.org>

	* src/bison.hairy: entered into RCS

1987-12-16  Richard Stallman  <rms@gnu.org>

	* REFERENCES: entered into RCS
-----

Copyright (C) 1997, 1998, 1999, 2000, 2001, 2002 Free Software Foundation, Inc.

This file is part of GNU Bison.

GNU Bison is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2, or (at your option)
any later version.

GNU Bison is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with GNU Bison; see the file COPYING.  If not, write to
the Free Software Foundation, Inc., 59 Temple Place - Suite 330,
Boston, MA 02111-1307, USA.
